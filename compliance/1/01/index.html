<!doctype html><html lang=en class="js csstransforms3d"><head><meta name=google-site-verification content="yq2Ib3doJVHVlEW2wtHap5WY54JhS2CCvI40y30F0FI"><meta charset=utf-8><meta name=color-scheme content="dark light"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.125.6"><meta name=description content="TechBlog about OpenShift/Ansible/Satellite and much more"><meta name=author content="Toni Schmidbauer & Thomas Jungbauer"><meta name=keywords content><link rel=canonical href=https://blog.stderr.at/compliance/1/01/><link rel=icon href=/images/favicon.ico type=image/png><link rel=apple-touch-icon sizes=152x152 href=/images/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-180x180.png><link rel=apple-touch-icon sizes=128x128 href=/images/apple-touch-icon-128x128.png><link rel=apple-touch-icon sizes=144x144 href=/images/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=114x114 href=/images/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=72x72 href=/images/apple-touch-icon-72x72.png><link rel=apple-touch-icon href=/images/apple-touch-icon-57x57.png><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/images/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/images/apple-icon-60x60.png><link rel=apple-touch-icon sizes=76x76 href=/images/apple-icon-76x76.png><link rel=apple-touch-icon sizes=120x120 href=/images/apple-icon-120x120.png><link rel=icon type=image/png sizes=192x192 href=/images/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/images/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><title>:: TechBlog about OpenShift/Ansible/Satellite and much more</title>
<link rel=manifest href=/manifest.json><meta name=theme-color content="#317EFB"><link href=/css/nucleus.min.css?1715151693 rel=stylesheet><link href=/css/fontawesome-all.min.css?1715151693 rel=stylesheet><link href=/css/font-awesome-animation.min.css?1715151693 rel=stylesheet><link href=/css/hybrid.css?1715151693 rel=stylesheet><link href=/css/featherlight.min.css?1715151693 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1715151693 rel=stylesheet><link href=/css/auto-complete.css?1715151693 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1715151693 rel=stylesheet><link href=/css/theme.min.css?1715151693 rel=stylesheet><link href=/css/hugo-theme.css?1715151693 rel=stylesheet><link href=/css/theme-yaub.css?1715151693 rel=stylesheet><script src=/js/jquery-3.7.1.min.js?1715151693></script><script src=/js/jquery.waypoints.min.js?1715151693></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/compliance/1/01/><button onclick=scrollTopAnimated() id=myBtn class="top-btn button fa fa-arrow-up" title="Go to top"></button>
<span class=read-progress></span><nav id=sidebar><div id=header-wrapper><div id=header><svg class="logo" width="200" height="100" viewBox="0 0 200 136.34417133812047"><defs id="SvgjsDefs3490"/><g id="SvgjsG3491" featurekey="symbolFeature-0" transform="matrix(0.8888888888888888,0,0,0.8888888888888888,55.55511135525174,-24.034717135959202)" fill="#d2d2d2"><g xmlns="http://www.w3.org/2000/svg"><g><g><g><path fill="#d2d2d2" d="M75.195 72.96c-.619.0-1.241-.21-1.75-.64-1.146-.967-1.291-2.681-.324-3.827L88.73 50 73.122 31.507c-.967-1.146-.822-2.859.324-3.827 1.146-.968 2.859-.823 3.827.323L94.36 48.248c.854 1.012.854 2.492.0 3.503L77.272 71.995C76.735 72.632 75.968 72.96 75.195 72.96z"/></g></g></g><g><g><g><path fill="#d2d2d2" d="M24.805 72.96c-.772.0-1.539-.328-2.076-.964L5.641 51.752c-.854-1.012-.854-2.492.0-3.503l17.088-20.245c.967-1.146 2.681-1.291 3.827-.324 1.146.967 1.291 2.681.324 3.827L11.269 50.001l15.609 18.492c.967 1.146.823 2.859-.323 3.827C26.045 72.749 25.423 72.96 24.805 72.96z"/></g></g></g><g><path fill="#d2d2d2" d="M37.325 72.96c-.492.0-.99-.134-1.438-.414-1.271-.796-1.657-2.471-.861-3.742L60.37 28.315c.796-1.271 2.472-1.656 3.743-.861 1.271.796 1.657 2.471.861 3.742L39.63 71.685C39.115 72.508 38.23 72.96 37.325 72.96z"/></g></g></g><g id="SvgjsG3492" featurekey="nameFeature-0" transform="matrix(1.6473784183020483,0,0,1.6473784183020483,0.5930603781937029,42.15399158589206)" fill="#d2d2d2"><path d="m6.72 11.44 6.68 11.28 6.64-11.28h7l-10.6 17.6V40h-6.28V28.88l-10.52-17.44h7.08zm38.535.0L55.935 40h-6.52l-2.16-6.36h-10.68L34.335 40h-6.36l10.84-28.56h6.44zM41.935 18.48l-3.72 10.48h7.4l-3.6-10.48h-.08zm27.175-7.04-39062e-9 17.88c0 2.1067.47332 3.6467 1.42 4.62s2.4334 1.46 4.46 1.46c2.1867.0 3.72-.48668 4.6-1.46s1.32-2.5133 1.32-4.62V11.44h6.28v17.88c0 3.5733-1.02 6.36-3.06 8.36s-5.0868 3-9.14 3c-4.1332.0-7.1932-1-9.18-3s-2.98-4.7868-2.98-8.36V11.44h6.28zm41.495.0c6.0532.0 9.08 2.3466 9.08 7.04.0 2.6933-1.2933 4.6932-3.88 6 1.76.50668 3.0733 1.3934 3.94 2.66s1.3 2.7934 1.3 4.58c0 2.56-.92668 4.58-2.78 6.06s-4.2868 2.22-7.3 2.22h-13.84V11.44h13.48zM109.80499999999999 23c2.5333.0 3.8-1.1333 3.8-3.4.0-2.1867-1.4133-3.28-4.24-3.28h-5.96V23h6.4zm.359999999999999 12.12c3.0667.0 4.6-1.2533 4.6-3.76.0-2.72-1.4933-4.08-4.48-4.08h-6.88v7.84h6.76z"/></g></svg><div class=inline-flex><span class="animate-typewriter overflow-hidden whitespace-nowrap">Yet another useless blog<span class="ml-2 -translate-y-2 animate-blink">_</span></span></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1715151694></script><script type=text/javascript src=/js/auto-complete.js?1715151694></script><script type=text/javascript>var baseurl="https://blog.stderr.at/"</script><script type=text/javascript src=/js/search.js?1715151694></script></div><div class=highlightable><ul class=topics><li data-nav-id=/gitopscollection/ title="GitOps Episodes" class=dd-item><a href=/gitopscollection/>GitOps Episodes</a><ul><li data-nav-id=/gitopscollection/2024-04-25-installing-compliance-operator/ title="Setup & Configure Compliance Operator using GitOps" class=dd-item><a href=/gitopscollection/2024-04-25-installing-compliance-operator/>Setup & Configure Compliance Operator using GitOps</a></li><li data-nav-id=/gitopscollection/2024-04-02-configure_app_of_apps/ title="Configure App-of-Apps" class=dd-item><a href=/gitopscollection/2024-04-02-configure_app_of_apps/>Configure App-of-Apps</a></li><li data-nav-id=/gitopscollection/2024-02-02-setup-argocd/ title="Setup OpenShift GitOps/Argo CD" class=dd-item><a href=/gitopscollection/2024-02-02-setup-argocd/>Setup OpenShift GitOps/Argo CD</a></li><li data-nav-id=/gitopscollection/2023-12-28-gitops-repostructure/ title="GitOps - Choosing the right Git repository structure" class=dd-item><a href=/gitopscollection/2023-12-28-gitops-repostructure/>GitOps - Choosing the right Git repository structure</a></li><li data-nav-id=/gitopscollection/2023-12-11-gitops-intro/ title="Introducing the GitOps Approach" class=dd-item><a href=/gitopscollection/2023-12-11-gitops-intro/>Introducing the GitOps Approach</a></li></ul></li><li data-nav-id=/openshift/ title=OpenShift class=dd-item><a href=/openshift/>OpenShift</a><ul><li data-nav-id=/openshift/2024/02/openshift-data-foundation-noobaa-bucket-data-retention-lifecycle/ title="OpenShift Data Foundation - Noobaa Bucket Data Retention (Lifecycle)" class=dd-item><a href=/openshift/2024/02/openshift-data-foundation-noobaa-bucket-data-retention-lifecycle/>OpenShift Data Foundation - Noobaa Bucket Data Retention (Lifecycle)</a></li><li data-nav-id=/openshift/2023/11/running-falco-on-openshift-4.12/ title="Running Falco on OpenShift 4.12" class=dd-item><a href=/openshift/2023/11/running-falco-on-openshift-4.12/>Running Falco on OpenShift 4.12</a></li><li data-nav-id=/openshift/2023/11/quay-deployment-and-configuration-using-gitops/ title="Quay Deployment and Configuration using GitOps" class=dd-item><a href=/openshift/2023/11/quay-deployment-and-configuration-using-gitops/>Quay Deployment and Configuration using GitOps</a></li><li data-nav-id=/openshift/2023/10/setting-up-falco-on-openshift-4.12/ title="Setting up Falco on OpenShift 4.12" class=dd-item><a href=/openshift/2023/10/setting-up-falco-on-openshift-4.12/>Setting up Falco on OpenShift 4.12</a></li><li data-nav-id=/openshift/2023/10/how-to-force-a-machineconfig-rollout/ title="How to force a MachineConfig rollout" class=dd-item><a href=/openshift/2023/10/how-to-force-a-machineconfig-rollout/>How to force a MachineConfig rollout</a></li><li data-nav-id=/openshift/2023/03/operator-installation-with-argo-cd/ title="Operator installation with Argo CD" class=dd-item><a href=/openshift/2023/03/operator-installation-with-argo-cd/>Operator installation with Argo CD</a></li><li data-nav-id=/openshift/2023/02/ssl-certificate-management-for-openshift-on-aws/ title="SSL Certificate Management for OpenShift on AWS" class=dd-item><a href=/openshift/2023/02/ssl-certificate-management-for-openshift-on-aws/>SSL Certificate Management for OpenShift on AWS</a></li><li data-nav-id=/openshift/2022/11/using-serversideapply-with-argocd/ title="Using ServerSideApply with ArgoCD" class=dd-item><a href=/openshift/2022/11/using-serversideapply-with-argocd/>Using ServerSideApply with ArgoCD</a></li><li data-nav-id=/openshift/2022/08/secrets-management-vault-on-openshift/ title="Secrets Management - Vault on OpenShift" class=dd-item><a href=/openshift/2022/08/secrets-management-vault-on-openshift/>Secrets Management - Vault on OpenShift</a></li><li data-nav-id=/openshift/2022/04/overview-of-red-hats-multi-cloud-gateway-noobaa/ title="Overview of Red Hat's Multi Cloud Gateway (Noobaa)" class=dd-item><a href=/openshift/2022/04/overview-of-red-hats-multi-cloud-gateway-noobaa/>Overview of Red Hat's Multi Cloud Gateway (Noobaa)</a></li><li data-nav-id=/openshift/2021/09/secure-your-secrets-with-sealed-secrets/ title="Secure your secrets with Sealed Secrets" class=dd-item><a href=/openshift/2021/09/secure-your-secrets-with-sealed-secrets/>Secure your secrets with Sealed Secrets</a></li><li data-nav-id=/openshift/2021/02/understanding-rwo-block-device-handling-in-openshift/ title="Understanding RWO block device handling in OpenShift" class=dd-item><a href=/openshift/2021/02/understanding-rwo-block-device-handling-in-openshift/>Understanding RWO block device handling in OpenShift</a></li><li data-nav-id=/openshift/2021/01/writing-operator-using-ansible/ title="Writing Operator using Ansible" class=dd-item><a href=/openshift/2021/01/writing-operator-using-ansible/>Writing Operator using Ansible</a></li><li data-nav-id=/openshift/2020/12/thanos-querier-vs-thanos-querier/ title="Thanos Querier vs Thanos Querier" class=dd-item><a href=/openshift/2020/12/thanos-querier-vs-thanos-querier/>Thanos Querier vs Thanos Querier</a></li><li data-nav-id=/openshift/2020/08/gitops-argo-cd/ title="GitOps - Argo CD" class=dd-item><a href=/openshift/2020/08/gitops-argo-cd/>GitOps - Argo CD</a></li><li data-nav-id=/openshift/2020/04/openshift-pipelines-tekton-introduction/ title="OpenShift Pipelines - Tekton Introduction" class=dd-item><a href=/openshift/2020/04/openshift-pipelines-tekton-introduction/>OpenShift Pipelines - Tekton Introduction</a></li><li data-nav-id=/openshift/2020/04/helpful-oc-/-kubectl-commands/ title="Helpful oc / kubectl commands" class=dd-item><a href=/openshift/2020/04/helpful-oc-/-kubectl-commands/>Helpful oc / kubectl commands</a></li></ul></li><li data-nav-id=/day-2/ title="OpenShift Day-2" class=dd-item><a href=/day-2/>OpenShift Day-2</a><ul><li data-nav-id=/day-2/etcd/ title=etcd class=dd-item><a href=/day-2/etcd/>etcd</a><ul><li data-nav-id=/day-2/etcd/2022-01-29-automatedetcdbackup/ title="Automated ETCD Backup" class=dd-item><a href=/day-2/etcd/2022-01-29-automatedetcdbackup/>Automated ETCD Backup</a></li></ul></li><li data-nav-id=/day-2/labels_environmets/ title="Labels & Environments" class=dd-item><a href=/day-2/labels_environmets/>Labels & Environments</a><ul><li data-nav-id=/day-2/labels_environmets/2022-01-12-creatingenvironment/ title="Working with Environments" class=dd-item><a href=/day-2/labels_environmets/2022-01-12-creatingenvironment/>Working with Environments</a></li></ul></li><li data-nav-id=/day-2/pod-placement/ title="Pod Placement" class=dd-item><a href=/day-2/pod-placement/>Pod Placement</a><ul><li data-nav-id=/day-2/pod-placement/2021-08-26-podplacement-intro/ title=Introduction class=dd-item><a href=/day-2/pod-placement/2021-08-26-podplacement-intro/>Introduction</a></li><li data-nav-id=/day-2/pod-placement/2021-08-29-node-affinity/ title="Node Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-29-node-affinity/>Node Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-27-podplacement/ title=NodeSelector class=dd-item><a href=/day-2/pod-placement/2021-08-27-podplacement/>NodeSelector</a></li><li data-nav-id=/day-2/pod-placement/2021-08-28-affinity/ title="Pod Affinity/Anti-Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-28-affinity/>Pod Affinity/Anti-Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-30-taints/ title="Taints and Tolerations" class=dd-item><a href=/day-2/pod-placement/2021-08-30-taints/>Taints and Tolerations</a></li><li data-nav-id=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/ title="Topology Spread Constraints" class=dd-item><a href=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/>Topology Spread Constraints</a></li><li data-nav-id=/day-2/pod-placement/2021-09-01-descheduler/ title="Using Descheduler" class=dd-item><a href=/day-2/pod-placement/2021-09-01-descheduler/>Using Descheduler</a></li></ul></li></ul></li><li data-nav-id=/securesupplychain/ title="Secure Supply Chain" class=dd-item><a href=/securesupplychain/>Secure Supply Chain</a><ul><li data-nav-id=/securesupplychain/2023-06-15-securesupplychain-intro/ title="Introduction to a Secure Supply Chain" class=dd-item><a href=/securesupplychain/2023-06-15-securesupplychain-intro/>Introduction to a Secure Supply Chain</a></li><li data-nav-id=/securesupplychain/2023-06-16-securesupplychain-step1/ title="Step 1 - Listen to Events" class=dd-item><a href=/securesupplychain/2023-06-16-securesupplychain-step1/>Step 1 - Listen to Events</a></li><li data-nav-id=/securesupplychain/2023-06-17-securesupplychain-step2/ title="Step 2 - Pipelines" class=dd-item><a href=/securesupplychain/2023-06-17-securesupplychain-step2/>Step 2 - Pipelines</a></li><li data-nav-id=/securesupplychain/2023-06-18-securesupplychain-step3/ title="Step 3 - SonarQube" class=dd-item><a href=/securesupplychain/2023-06-18-securesupplychain-step3/>Step 3 - SonarQube</a></li><li data-nav-id=/securesupplychain/2023-06-19-securesupplychain-step4/ title="Step 4 - Verify Git Commit" class=dd-item><a href=/securesupplychain/2023-06-19-securesupplychain-step4/>Step 4 - Verify Git Commit</a></li><li data-nav-id=/securesupplychain/2023-06-20-securesupplychain-step5/ title="Step 5 - Build and Sign Image" class=dd-item><a href=/securesupplychain/2023-06-20-securesupplychain-step5/>Step 5 - Build and Sign Image</a></li><li data-nav-id=/securesupplychain/2023-06-21-securesupplychain-step6/ title="Step 6 - Scanning with ACS" class=dd-item><a href=/securesupplychain/2023-06-21-securesupplychain-step6/>Step 6 - Scanning with ACS</a></li><li data-nav-id=/securesupplychain/2023-06-22-securesupplychain-step7/ title="Step 7 - Generating a SBOM" class=dd-item><a href=/securesupplychain/2023-06-22-securesupplychain-step7/>Step 7 - Generating a SBOM</a></li><li data-nav-id=/securesupplychain/2023-06-23-securesupplychain-step8/ title="Step 8 - Updating Kubernetes Manifests" class=dd-item><a href=/securesupplychain/2023-06-23-securesupplychain-step8/>Step 8 - Updating Kubernetes Manifests</a></li><li data-nav-id=/securesupplychain/2023-06-24-securesupplychain-step9/ title="Step 9 - Linting Kubernetes Manifests" class=dd-item><a href=/securesupplychain/2023-06-24-securesupplychain-step9/>Step 9 - Linting Kubernetes Manifests</a></li><li data-nav-id=/securesupplychain/2023-06-25-securesupplychain-step10/ title="Step 10 - The Example Application" class=dd-item><a href=/securesupplychain/2023-06-25-securesupplychain-step10/>Step 10 - The Example Application</a></li><li data-nav-id=/securesupplychain/2023-06-26-securesupplychain-step11/ title="Step 11 - ACS Deployment Check" class=dd-item><a href=/securesupplychain/2023-06-26-securesupplychain-step11/>Step 11 - ACS Deployment Check</a></li><li data-nav-id=/securesupplychain/2023-06-27-securesupplychain-step12/ title="Step 12 - Verify TLog Signature" class=dd-item><a href=/securesupplychain/2023-06-27-securesupplychain-step12/>Step 12 - Verify TLog Signature</a></li><li data-nav-id=/securesupplychain/2023-06-28-securesupplychain-step13/ title="Step 13 - Bring it to Production" class=dd-item><a href=/securesupplychain/2023-06-28-securesupplychain-step13/>Step 13 - Bring it to Production</a></li></ul></li><li data-nav-id=/compliance/ title=Compliance class="dd-item
parent"><a href=/compliance/>Compliance</a><ul><li data-nav-id=/compliance/2021/07/oc-compliance-command-line-plugin/ title="oc compliance command line plugin" class=dd-item><a href=/compliance/2021/07/oc-compliance-command-line-plugin/>oc compliance command line plugin</a></li><li data-nav-id=/compliance/2021/07/compliance-operator/ title="Compliance Operator" class=dd-item><a href=/compliance/2021/07/compliance-operator/>Compliance Operator</a></li><li data-nav-id=/compliance/1/01/ title class="dd-item active"><a href=/compliance/1/01/></a></li><li data-nav-id=/compliance/1/01/ title class=dd-item><a href=/compliance/1/01/></a></li><li data-nav-id=/compliance/1/01/ title class=dd-item><a href=/compliance/1/01/></a></li></ul></li><li data-nav-id=/service-mesh/ title="Service Mesh" class=dd-item><a href=/service-mesh/>Service Mesh</a><ul><li data-nav-id=/service-mesh/2020/05/enable-automatic-route-creation/ title="Enable Automatic Route Creation" class=dd-item><a href=/service-mesh/2020/05/enable-automatic-route-creation/>Enable Automatic Route Creation</a></li><li data-nav-id=/service-mesh/2020/05/authorization-rbac/ title="Authorization (RBAC)" class=dd-item><a href=/service-mesh/2020/05/authorization-rbac/>Authorization (RBAC)</a></li><li data-nav-id=/service-mesh/2020/04/deploy-example-bookinfo-application/ title="Deploy Example Bookinfo Application" class=dd-item><a href=/service-mesh/2020/04/deploy-example-bookinfo-application/>Deploy Example Bookinfo Application</a></li><li data-nav-id=/service-mesh/2020/04/service-mesh-1.1-released/ title="Service Mesh 1.1 released" class=dd-item><a href=/service-mesh/2020/04/service-mesh-1.1-released/>Service Mesh 1.1 released</a></li><li data-nav-id=/service-mesh/2020/04/authentication-jwt/ title="Authentication JWT" class=dd-item><a href=/service-mesh/2020/04/authentication-jwt/>Authentication JWT</a></li><li data-nav-id=/service-mesh/2020/04/mutual-tls-authentication/ title="Mutual TLS Authentication" class=dd-item><a href=/service-mesh/2020/04/mutual-tls-authentication/>Mutual TLS Authentication</a></li><li data-nav-id=/service-mesh/2020/04/fault-injection/ title="Fault Injection" class=dd-item><a href=/service-mesh/2020/04/fault-injection/>Fault Injection</a></li><li data-nav-id=/service-mesh/2020/04/limit-egress/external-traffic/ title="Limit Egress/External Traffic" class=dd-item><a href=/service-mesh/2020/04/limit-egress/external-traffic/>Limit Egress/External Traffic</a></li><li data-nav-id=/service-mesh/2020/04/advanced-routing-example/ title="Advanced Routing Example" class=dd-item><a href=/service-mesh/2020/04/advanced-routing-example/>Advanced Routing Example</a></li><li data-nav-id=/service-mesh/2020/04/routing-example/ title="Routing Example" class=dd-item><a href=/service-mesh/2020/04/routing-example/>Routing Example</a></li><li data-nav-id=/service-mesh/2020/03/ingress-with-custom-domain/ title="Ingress with custom domain" class=dd-item><a href=/service-mesh/2020/03/ingress-with-custom-domain/>Ingress with custom domain</a></li><li data-nav-id=/service-mesh/2020/03/ingress-traffic/ title="Ingress Traffic" class=dd-item><a href=/service-mesh/2020/03/ingress-traffic/>Ingress Traffic</a></li><li data-nav-id=/service-mesh/2020/03/deploy-microservices/ title="Deploy Microservices" class=dd-item><a href=/service-mesh/2020/03/deploy-microservices/>Deploy Microservices</a></li><li data-nav-id=/service-mesh/2020/03/installation/ title=Installation class=dd-item><a href=/service-mesh/2020/03/installation/>Installation</a></li></ul></li><li data-nav-id=/general/ title=General class=dd-item><a href=/general/>General</a><ul><li data-nav-id=/general/2020/05/basic-usage-of-git/ title="Basic usage of git" class=dd-item><a href=/general/2020/05/basic-usage-of-git/>Basic usage of git</a></li><li data-nav-id=/general/2020/04/red-hat-satellite-cheat-sheet/ title="Red Hat Satellite Cheat Sheet" class=dd-item><a href=/general/2020/04/red-hat-satellite-cheat-sheet/>Red Hat Satellite Cheat Sheet</a></li></ul></li><li data-nav-id=/ansible/ title=Ansible class=dd-item><a href=/ansible/>Ansible</a><ul><li data-nav-id=/ansible/2021/11/ansible-style-guide/ title="Ansible Style Guide" class=dd-item><a href=/ansible/2021/11/ansible-style-guide/>Ansible Style Guide</a></li><li data-nav-id=/ansible/2021/10/automation-controller-and-ldap-authentication/ title="Automation Controller and LDAP Authentication" class=dd-item><a href=/ansible/2021/10/automation-controller-and-ldap-authentication/>Automation Controller and LDAP Authentication</a></li><li data-nav-id=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" class=dd-item><a href=/ansible/2021/07/ansible-tower-and-downloading-collections/>Ansible Tower and downloading collections</a></li><li data-nav-id=/ansible/2020/04/ansible-azure-resource-manager-example/ title="Ansible - Azure Resource Manager Example" class=dd-item><a href=/ansible/2020/04/ansible-azure-resource-manager-example/>Ansible - Azure Resource Manager Example</a></li><li data-nav-id=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" class=dd-item><a href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/>DO410 Ansible and Ansible Tower training notes</a></li></ul></li><li data-nav-id=/acs/ title="Advanced Cluster Security" class=dd-item><a href=/acs/>Advanced Cluster Security</a><ul><li data-nav-id=/acs/2021-12-11-acsauth/ title="Advanced Cluster Security - Authentication" class=dd-item><a href=/acs/2021-12-11-acsauth/>Advanced Cluster Security - Authentication</a></li></ul></li><li data-nav-id=/azure/ title=Azure class=dd-item><a href=/azure/>Azure</a><ul><li data-nav-id=/azure/2021-10-29-private-aro/ title="Stumbling into Azure Part II: Setting up a private ARO cluster" class=dd-item><a href=/azure/2021-10-29-private-aro/>Stumbling into Azure Part II: Setting up a private ARO cluster</a></li><li data-nav-id=/azure/2021-10-17-s2s-vpn/ title="Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing" class=dd-item><a href=/azure/2021-10-17-s2s-vpn/>Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing</a></li></ul></li><li data-nav-id=/java/ title=Java class=dd-item><a href=/java/>Java</a><ul><li data-nav-id=/java/2022-02-25-jpa-disconnected-entity/ title="Adventures in Java Land: JPA disconnected entities" class=dd-item><a href=/java/2022-02-25-jpa-disconnected-entity/>Adventures in Java Land: JPA disconnected entities</a></li></ul></li><li data-nav-id=/quay/ title=Quay class=dd-item><a href=/quay/>Quay</a><ul><li data-nav-id=/quay/2021-09-07-quay-upgrade-3.4/ title="Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator" class=dd-item><a href=/quay/2021-09-07-quay-upgrade-3.4/>Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator</a></li><li data-nav-id=/quay/2020-05-13-quay-tutorial1/ title="Red Hat Quay Registry - Overview and Installation" class=dd-item><a href=/quay/2020-05-13-quay-tutorial1/>Red Hat Quay Registry - Overview and Installation</a></li></ul></li><li data-nav-id=/legaldisclosure/ title="Legal Disclosure" class=dd-item><a href=/legaldisclosure/>Legal Disclosure</a></li><li data-nav-id=/rss/ title="RSS Feeds" class=dd-item><a href=/rss/>RSS Feeds</a></li></ul><section id=footer></section></div></nav><section id=body class=post-content><div id=overlay></div><aside id=toc-field class="hidden lg:block tableOfContentContainer"><header id=TableOfContentsHeader>What's on this Page</header><div id=navigation><a class=nav-prev href=/compliance/1/01/ title><i class="fa fa-chevron-left"></i></a>
<a class=nav-next href=/service-mesh/ title="Service Mesh" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></aside><div class="padding highlightable"><header><div id=top-nav class=margin-bottom-15><section id=homelinks class=text-align-center><ul class="list-no-style margin-0 padding-0 overflow-hidden text-align-left vertical-align-middle"><li class="list-horizontal padding-left-15 padding-right-15"><a class=padding-topnav href=/><i class='fas fa-home'></i> Home</a></li><li class="list-horizontal left padding-left-15 padding-right-15"><a class=padding-topnav href=https://blog.stderr.at/authors><svg stroke="currentcolor" fill="#d2d2d2" stroke-width="0" viewBox="0 0 17 17" class="relative z-20 h-6 w-6" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g/><path d="M16.499 1.843 15.096.44c-.566-.566-1.555-.566-2.122.0L5.438 7.976l-1.722 5.287 5.249-1.765 7.534-7.534c.283-.283.439-.66.439-1.061s-.156-.777-.439-1.06zM5.584 10.758l.638-1.957 1.92 1.919-1.942.653-.616-.615zM6.832 7.996l3.986-3.986 2.11 2.11-3.986 3.986-2.11-2.11zm4.693-4.693.729-.729 2.11 2.11-.729.729-2.11-2.11zM15.792 3.257l-.72.721-2.11-2.11.72-.721c.19-.189.519-.189.707.0l1.403 1.403c.094.095.146.22.146.354s-.052.258-.146.353zM15 7.5h1V17H0V2h7.5v1H1v13h14V7.5z"/></svg> About Us</a></li><li class="list-horizontal left padding-left-15 padding-right-15"><a class=padding-topnav href=https://blog.stderr.at/categories><i class='far fa-bookmark padding-right-25rem'></i> Catagories</a></li><li class="list-horizontal left padding-left-15 padding-right-15"><a class=padding-topnav href=https://blog.stderr.at/tags><i class='fas fa-tags padding-right-25rem'></i> Tags</a></li><li class="list-horizontal left padding-left-15 padding-right-15"><a class=padding-topnav href=https://blog.stderr.at/archive><i class='fas fa-box padding-right-25rem'></i> Archive</a></li><li class="list-horizontal right padding-left-15 padding-right-15"><a class=padding-topnav href=https://charts.stderr.at/><svg class="list-horizontal padding-right-25rem" fill="#d2d2d2" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 256 297" class="mr-3 h-7 w-7 fill-current text-omega-500"><path d="m60.349 70.537-.811-.767a77.726 77.726.0 01-.278-.266c-7.589-7.29-13.462-15.721-17.01-25.685-.951-2.673-1.68-5.397-1.621-8.262l.012-.375c.012-.285.011-.571.031-.856.268-3.877 2.863-5.836 6.652-4.918 1.195.31 2.351.753 3.447 1.321 4.007 2.01 7.297 4.948 10.317 8.185l.312.336a67.685 67.685.0 0113.066 20.108c.068.177.146.35.234.518a.308.308.0 00.061.074l.212.181.064.057a106.079 106.079.0 0148.733-14.954l-.043-.218-.112-.585a11.87 11.87.0 00-.073-.35l-.041-.17a67.666 67.666.0 01-1.596-22.23 50.571 50.571.0 012.674-13.09 18.838 18.838.0 013.294-6.118 9.436 9.436.0 011.902-1.697 4.226 4.226.0 014.832-.034 10.393 10.393.0 013.513 4.049 31.912 31.912.0 013.165 8.828 67.672 67.672.0 011.277 19.852 57.502 57.502.0 01-2.1 11.976c.714.132 1.428.258 2.14.382l3.2.552c2.481.43 4.946.88 7.38 1.458a112.29 112.29.0 0112.296 3.611c4.059 1.49 8.03 3.211 11.891 5.155 2.227 1.11 4.39 2.346 6.564 3.612l1.866 1.09c.936.548 1.877 1.096 2.829 1.637l.08-.163.178-.354c.06-.125.118-.254.167-.387a65.359 65.359.0 0119.79-28.128 22.711 22.711.0 017.11-4.14c.717-.25 1.46-.42 2.213-.508 3.768-.431 5.35 1.94 5.628 4.771a18.011 18.011.0 01-.465 6.228 52.875 52.875.0 01-6.147 14.357l-.308.493c-3.982 6.435-8.69 12.247-14.633 16.98l-.46.362a2.62 2.62.0 00-.12.1l-.192.177-.24.228-.098.09a106.935 106.935.0 0115.996 18.576 6.594 6.594.0 01-1.016.179c-6.373.01-12.746-.011-19.12.028a2.408 2.408.0 01-1.908-1.017 88.947 88.947.0 00-53.039-27.999 86.23 86.23.0 00-17.453-.75l-.76.047a88.064 88.064.0 00-49.207 18.785l-.44.349a84.25 84.25.0 00-10.21 9.529 2.844 2.844.0 01-2.324 1.057 1482.46 1482.46.0 00-10.958-.026l-8.6.005c.029-.111.077-.245.144-.398l.09-.193a7.07 7.07.0 01.107-.211l.123-.23.14-.245.157-.262.171-.277.186-.292.306-.464.337-.493.241-.343.384-.535.134-.183.419-.564.292-.386.302-.394.472-.604.491-.616.338-.418.346-.42.352-.425.36-.426.365-.428.558-.644.378-.43.382-.428.386-.426.39-.425c1.896-2.049 3.859-4.036 5.86-6.045l2.013-2.019c.675-.677 1.353-1.36 2.033-2.052zm155.187 136.407a106.248 106.248.0 01-14.42 16.339l1.12.933a65.151 65.151.0 0120.26 28.96 20.823 20.823.0 011.325 8.673 8.954 8.954.0 01-.363 1.95l-.087.271a4.335 4.335.0 01-4.907 3.021 13.373 13.373.0 01-4.067-1.206 30.816 30.816.0 01-5.523-3.498 64.717 64.717.0 01-19.627-27.589l-.262-.713-.357-.922a117.082 117.082.0 01-15.045 8.426 109.274 109.274.0 01-16.052 5.85 112.816 112.816.0 01-17.025 3.24l.078.41.07.373c.023.12.047.234.073.348l.042.168a65.667 65.667.0 011.787 21.92 48.604 48.604.0 01-2.66 13.52 47.067 47.067.0 01-2.505 5.26 8.054 8.054.0 01-1.407 1.788c-2.394 2.471-5.253 2.492-7.586-.045a16.409 16.409.0 01-2.35-3.379c-1.85-3.474-2.803-7.252-3.483-11.104a70.293 70.293.0 01-.818-15.918 56.83 56.83.0 011.568-10.873l.167-.667c.085-.32.162-.644.224-.969a.292.292.0 00-.015-.132l-.067-.23a3.701 3.701.0 01-.021-.082A105.937 105.937.0 0174.9 236.033l-.56 1.24-.102.231a66.452 66.452.0 01-18.164 24.56l-.423.355a22.954 22.954.0 01-7.247 4.186 7.272 7.272.0 01-3.919.42 4.282 4.282.0 01-3.19-2.55l-.06-.15c-.783-1.894-.718-3.859-.478-5.815l.067-.51a33.355 33.355.0 012.59-8.572 67.669 67.669.0 0115.947-22.714l.556-.52c.093-.086.184-.173.275-.262.086-.124.16-.256.22-.394A107.611 107.611.0 0143.287 206.7l.19-.017.65-.062c.193-.018.369-.03.545-.03 5.06-.005 10.12.009 15.179-.008l3.794-.018a2.83 2.83.0 012.228.978 88.388 88.388.0 0023.1 17.07l.6.304a84.178 84.178.0 0029.898 8.887c28.343 2.755 52.723-5.838 73.142-25.777a4.599 4.599.0 013.605-1.47c2.947.036 5.896.044 8.844.042l5.896-.01 2.949-.002h1.523l.106.356zm-26.342-90.316c.373.0.742.006 1.109.013l1.093.022c.724.013 1.439.015 2.148-.026l.531-.039c1.802-.163 3.091.481 4.405 1.692 6.323 5.826 12.7 11.592 19.071 17.364l3.966 3.595.45.4.675.595.799-.68c.171-.147.339-.293.503-.443a19230.8 19230.8.0 0023.608-21.525 3.277 3.277.0 012.362-.995l.167.005c1.21.049 2.422.045 3.66.036l1.498-.011c.252-.002.506-.003.761-.003v63.38a.948.948.0 01-.097.021l-.14.02-.18.02-.22.02-.255.017-.447.026-.897.037-1.06.032-1.188.025-1.817.025-1.639.01-1.653.002-1.082-.005-1.3-.013-.978-.015-.686-.015-.637-.017-.762-.028-.496-.024-.424-.027-.239-.02-.2-.02a4.685 4.685.0 01-.087-.012l-.141-.022v-32.098l-.323-.153-16.383 14.942-16.516-14.879-.316.116-.007 2.679v29.509h-16.497c-.016-.053-.031-.251-.046-.58l-.017-.455-.017-.575-.024-1.076-.023-1.314-.03-2.093-.033-3.101-.047-5.884-.032-5.84-.027-7.156-.017-8.245-.002-5.379.009-6.732.013-3.813.023-4.033.025-2.81.025-1.825.022-1.095.015-.588.017-.47.018-.345c.003-.046.006-.088.01-.124zm-152.24.073h16.398c.013.042.026.18.039.406l.018.404.018.53.016.652.025 1.19.036 2.508.027 2.424.028 3.479.037 6.391.017 4.372.018 8.267.003 5.583-.006 6.347-.01 4.294-.02 4.749-.022 3.515-.035 3.555-.02 1.461-.014.844-.016.732-.017.616-.017.494-.018.365c-.01.15-.02.25-.03.295H36.996a277.08 277.08.0 01-.048-6.9l.009-3.445-.001-1.722-.004-1.707-.002-3.422.003-6.924H16.63v23.904a1.2 1.2.0 01-.116.027l-.162.026-.205.024-.383.035-.303.021-.706.04-.61.025-.904.03-.737.02-1.043.02-1.66.022-1.716.01H6.66l-1.384-.009-1.551-.022-.939-.02-.84-.027-.553-.024-.329-.017-.293-.019-.367-.03a7.294 7.294.0 01-.103-.011l-.172-.023a1.687 1.687.0 01-.128-.024v-63.324h16.564v22.37a.972.972.0 00.096.02l.138.021.177.02.336.028.415.026.665.033.576.022.635.02 1.423.036 1.864.032 1.135.014 1.761.014 1.789.006 2.343-.005 1.395-.01 1.308-.017 1.193-.022 1.05-.028.88-.035.433-.023.357-.026.192-.02a.93.93.0 00.08-.009l.133-.02.012-4.084.003-1.375.002-2.853-.002-14.142zm36.054 63.45v-63.262c.03-.01.09-.02.18-.028l.22-.018.14-.01.525-.025.682-.025.826-.024 1.308-.029 1.52-.027 1.704-.025 4.374-.046 2.123-.016 5.002-.026 3.952-.01 4.384.002 3.563.012 2.737.019 1.99.022 1.67.028.567.013.732.021.58.024.296.017.22.018.08.01v13.482c-.528.038-1.073.11-1.619.111l-9.63.007-11.413-.002v10.487h20.058v13.95h-19.88a3.407 3.407.0 00-.078.448l-.03.255-.026.294-.037.505-.023.375-.03.615-.026.666-.027.951-.016.747-.01.764-.008 1.028.003 1.264.008.73.009.467.01.45.021.632.026.573.02.345.022.311.025.274.014.122c.508.035 1.052.102 1.597.103l9.63.007 11.415-.002v13.426h-39.38zm58.17.024a5.015 5.015.0 01-.035-.479l-.016-.437-.015-.562-.014-.68-.02-1.231-.018-1.466-.03-3.56-.02-3.516-.019-5.581-.01-7.949.006-10.192.022-8.11.03-6.587.03-4.327.03-3.08.026-2.056.014-.877.022-1.109.016-.594.016-.472.017-.343c.009-.138.017-.226.026-.26h16.338v46.775l.503.03.46.028.431.023c.14.005.279.009.417.009l9.701.005 11.45-.001v16.6h-39.358z"/></svg> Helm Charts</a></li><li class="list-horizontal right padding-left-15 padding-right-15"><a class=padding-topnav href=https://www.redhat.com><i class='fab fa-redhat padding-right-25rem'></i> Red Hat</a></li></ul></section><div class=sub-top-nav><div id=breadcrumbs class="display-inline float-unset" itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars">Toc</i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"><span class=hidden-toc>Toc</span></i></span>
<span class=links><span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/><span itemprop=name>YAUB Yet Another Useless Blog</span><meta itemprop=position content='1'></a></span> > <span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/compliance/><span itemprop=name>Compliance</span><meta itemprop=position content='2'></a></span> ></span></div><div class=progress><div class=wrapper></div></div><div class=social><a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f" class="facebook no-highlight" aria-label="share on Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg class="icon icon-facebook" width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a href="https://twitter.com/intent/tweet?hashtags=codingnconcepts&amp;url=https%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f&amp;text=" class="twitter no-highlight" aria-label="share on Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg class="icon icon-x" xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 30 30"><path d="M26.37 26l-8.795-12.822.015.012L25.52 4h-2.65l-6.46 7.48L11.28 4H4.33l8.211 11.971L12.54 15.97 3.88 26h2.65l7.182-8.322L19.42 26h6.95zM10.23 6l12.34 18h-2.1L8.12 6h2.11z"/></svg></div></div></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f&amp;source=https%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f&amp;title=&amp;summary=" class="linkedin no-highlight" aria-label="share on Linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg class="icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352"><path d="M0 40v272c0 21.9 18.1 40 40 40h272c21.9.0 40-18.1 40-40V40c0-21.9-18.1-40-40-40H40C18.1.0.0 18.1.0 40zm312-8c4.6.0 8 3.4 8 8v272c0 4.6-3.4 8-8 8H40c-4.6.0-8-3.4-8-8V40c0-4.6 3.4-8 8-8H312zM59.5 87c0 15.2 12.3 27.5 27.5 27.5s27.5-12.3 27.5-27.5S102.2 59.5 87 59.5 59.5 71.8 59.5 87zM187 157h-1v-21h-45v152h47v-75c0-19.8 3.9-39 28.5-39 24.2.0 24.5 22.4 24.5 40v74h47v-83.5c0-40.9-8.7-72-56.5-72-23 0-38.2 12.6-44.5 24.5zM64 288h47.5V136H64V288z"/></svg></div></div></a><a href="whatsapp://send?text=%2c%20by%20TechBlog%20about%20OpenShift%2fAnsible%2fSatellite%20and%20much%20more%0a%3cnil%3e%0a%0ahttps%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f%0a" class="whatsapp no-highlight" aria-label="share on Whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg class="icon icon-whatsapp" width="24" height="24" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg></div></div></a><a href="mailto:?subject=TechBlog%20about%20OpenShift%2fAnsible%2fSatellite%20and%20much%20more - .&amp;body=%2c%20by%20TechBlog%20about%20OpenShift%2fAnsible%2fSatellite%20and%20much%20more%0a%3cnil%3e%0a%0ahttps%3a%2f%2fblog.stderr.at%2fcompliance%2f1%2f01%2f%0a" class="email no-highlight" aria-label="share on Email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg class="icon icon-mail" width="24" height="24" viewBox="0 0 416 288"><path d="m0 16v256 16h16 384 16v-16V16 0h-16H16 0zm347 16-139 92.5L69 32zM199 157.5l9 5.5 9-5.5L384 46v210H32V46z"/></svg></div></div></a><a href=/rss/ class="rss no-highlight" aria-label=RSS><div class="resp-sharing-button resp-sharing-button--rss resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 455.731 455.731"><g><rect x="0" y="0" style="fill:#f78422" width="455.731" height="455.731"/><g><path style="fill:#fff" d="M296.208 159.16C234.445 97.397 152.266 63.382 64.81 63.382v64.348c70.268.0 136.288 27.321 185.898 76.931 49.609 49.61 76.931 115.63 76.931 185.898h64.348C391.986 303.103 357.971 220.923 296.208 159.16z"/><path style="fill:#fff" d="M64.143 172.273v64.348c84.881.0 153.938 69.056 153.938 153.939h64.348c0-120.364-97.922-218.287-218.286-218.287z"/><circle style="fill:#fff" cx="109.833" cy="346.26" r="46.088"/></g></g></svg></div></div></a></div></div></div></header><div id=head-tags></div><div id=body-inner><h1></h1><p class=tracked><time class="f6 mv4 dib tracked" datetime=0001-01-01T00:00:00Z><strong>January 1, 0001</strong>
</time><span class=divider>-
</span><span class=author>( Lastmod: 2021-08-09 )
</span><span class=divider>-
</span><span class=readtime><strong>104 min read</strong></span></p><!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_cis | OpenSCAP Evaluation Report</title><style>/*!* Bootstrap v3.3.7 (http://getbootstrap.com)
* Copyright 2011-2016 Twitter, Inc.
* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)*//*!* Generated using the Bootstrap Customizer (https://getbootstrap.com/customize/?id=8160adef040364fa8f688f6065765caf)
* Config saved to config.json and https://gist.github.com/8160adef040364fa8f688f6065765caf*//*!* Bootstrap v3.3.7 (http://getbootstrap.com)
* Copyright 2011-2016 Twitter, Inc.
* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)*//*!normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css*/html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}/*!Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css*/@media print{*,*:before,*:after{background:0 0!important;color:#000!important;-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}a,a:visited{text-decoration:underline}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100%!important}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}.navbar{display:none}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000!important}.label{border:1px solid #000}.table{border-collapse:collapse!important}.table td,.table th{background-color:#fff!important}.table-bordered th,.table-bordered td{border:1px solid #ddd!important}}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:transparent}body{font-family:helvetica neue,Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#428bca;text-decoration:none}a:hover,a:focus{color:#2a6496;text-decoration:underline}a:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.img-responsive{display:block;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out;display:inline-block;max-width:100%;height:auto}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}[role=button]{cursor:pointer}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small,.h1 small,.h2 small,.h3 small,.h4 small,.h5 small,.h6 small,h1 .small,h2 .small,h3 .small,h4 .small,h5 .small,h6 .small,.h1 .small,.h2 .small,.h3 .small,.h4 .small,.h5 .small,.h6 .small{font-weight:400;line-height:1;color:#777}h1,.h1,h2,.h2,h3,.h3{margin-top:20px;margin-bottom:10px}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h1 .small,.h1 .small,h2 .small,.h2 .small,h3 .small,.h3 .small{font-size:65%}h4,.h4,h5,.h5,h6,.h6{margin-top:10px;margin-bottom:10px}h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small,h4 .small,.h4 .small,h5 .small,.h5 .small,h6 .small,.h6 .small{font-size:75%}h1,.h1{font-size:36px}h2,.h2{font-size:30px}h3,.h3{font-size:24px}h4,.h4{font-size:18px}h5,.h5{font-size:14px}h6,.h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media(min-width:768px){.lead{font-size:21px}}small,.small{font-size:85%}mark,.mark{background-color:#fcf8e3;padding:.2em}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#428bca}a.text-primary:hover,a.text-primary:focus{color:#3071a9}.text-success{color:#3c763d}a.text-success:hover,a.text-success:focus{color:#2b542c}.text-info{color:#31708f}a.text-info:hover,a.text-info:focus{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover,a.text-warning:focus{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover,a.text-danger:focus{color:#843534}.bg-primary{color:#fff;background-color:#428bca}a.bg-primary:hover,a.bg-primary:focus{background-color:#3071a9}.bg-success{background-color:#dff0d8}a.bg-success:hover,a.bg-success:focus{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover,a.bg-info:focus{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover,a.bg-warning:focus{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover,a.bg-danger:focus{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ul,ol{margin-top:0;margin-bottom:10px}ul ul,ol ul,ul ol,ol ol{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none;margin-left:-5px}.list-inline>li{display:inline-block;padding-left:5px;padding-right:5px}dl{margin-top:0;margin-bottom:20px}dt,dd{line-height:1.42857143}dt{font-weight:700}dd{margin-left:0}@media(min-width:768px){.dl-horizontal dt{float:left;width:160px;clear:left;text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[title],abbr[data-original-title]{cursor:help;border-bottom:1px dotted #777}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote p:last-child,blockquote ul:last-child,blockquote ol:last-child{margin-bottom:0}blockquote footer,blockquote small,blockquote .small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote footer:before,blockquote small:before,blockquote .small:before{content:'\2014 \00A0'}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;border-right:5px solid #eee;border-left:0;text-align:right}.blockquote-reverse footer:before,blockquote.pull-right footer:before,.blockquote-reverse small:before,blockquote.pull-right small:before,.blockquote-reverse .small:before,blockquote.pull-right .small:before{content:''}.blockquote-reverse footer:after,blockquote.pull-right footer:after,.blockquote-reverse small:after,blockquote.pull-right small:after,.blockquote-reverse .small:after,blockquote.pull-right .small:after{content:'\00A0 \2014'}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,courier new,monospace}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}kbd{padding:2px 4px;font-size:90%;color:#fff;background-color:#333;border-radius:3px;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.25);box-shadow:inset 0 -1px rgba(0,0,0,.25)}kbd kbd{padding:0;font-size:100%;font-weight:700;-webkit-box-shadow:none;box-shadow:none}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media(min-width:768px){.container{width:750px}}@media(min-width:992px){.container{width:970px}}@media(min-width:1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}.col-xs-1,.col-sm-1,.col-md-1,.col-lg-1,.col-xs-2,.col-sm-2,.col-md-2,.col-lg-2,.col-xs-3,.col-sm-3,.col-md-3,.col-lg-3,.col-xs-4,.col-sm-4,.col-md-4,.col-lg-4,.col-xs-5,.col-sm-5,.col-md-5,.col-lg-5,.col-xs-6,.col-sm-6,.col-md-6,.col-lg-6,.col-xs-7,.col-sm-7,.col-md-7,.col-lg-7,.col-xs-8,.col-sm-8,.col-md-8,.col-lg-8,.col-xs-9,.col-sm-9,.col-md-9,.col-lg-9,.col-xs-10,.col-sm-10,.col-md-10,.col-lg-10,.col-xs-11,.col-sm-11,.col-md-11,.col-lg-11,.col-xs-12,.col-sm-12,.col-md-12,.col-lg-12{position:relative;min-height:1px;padding-left:15px;padding-right:15px}.col-xs-1,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-10,.col-xs-11,.col-xs-12{float:left}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.col-xs-pull-12{right:100%}.col-xs-pull-11{right:91.66666667%}.col-xs-pull-10{right:83.33333333%}.col-xs-pull-9{right:75%}.col-xs-pull-8{right:66.66666667%}.col-xs-pull-7{right:58.33333333%}.col-xs-pull-6{right:50%}.col-xs-pull-5{right:41.66666667%}.col-xs-pull-4{right:33.33333333%}.col-xs-pull-3{right:25%}.col-xs-pull-2{right:16.66666667%}.col-xs-pull-1{right:8.33333333%}.col-xs-pull-0{right:auto}.col-xs-push-12{left:100%}.col-xs-push-11{left:91.66666667%}.col-xs-push-10{left:83.33333333%}.col-xs-push-9{left:75%}.col-xs-push-8{left:66.66666667%}.col-xs-push-7{left:58.33333333%}.col-xs-push-6{left:50%}.col-xs-push-5{left:41.66666667%}.col-xs-push-4{left:33.33333333%}.col-xs-push-3{left:25%}.col-xs-push-2{left:16.66666667%}.col-xs-push-1{left:8.33333333%}.col-xs-push-0{left:auto}.col-xs-offset-12{margin-left:100%}.col-xs-offset-11{margin-left:91.66666667%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-0{margin-left:0}@media(min-width:768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media(min-width:992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}@media(min-width:1200px){.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12{float:left}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.col-lg-pull-12{right:100%}.col-lg-pull-11{right:91.66666667%}.col-lg-pull-10{right:83.33333333%}.col-lg-pull-9{right:75%}.col-lg-pull-8{right:66.66666667%}.col-lg-pull-7{right:58.33333333%}.col-lg-pull-6{right:50%}.col-lg-pull-5{right:41.66666667%}.col-lg-pull-4{right:33.33333333%}.col-lg-pull-3{right:25%}.col-lg-pull-2{right:16.66666667%}.col-lg-pull-1{right:8.33333333%}.col-lg-pull-0{right:auto}.col-lg-push-12{left:100%}.col-lg-push-11{left:91.66666667%}.col-lg-push-10{left:83.33333333%}.col-lg-push-9{left:75%}.col-lg-push-8{left:66.66666667%}.col-lg-push-7{left:58.33333333%}.col-lg-push-6{left:50%}.col-lg-push-5{left:41.66666667%}.col-lg-push-4{left:33.33333333%}.col-lg-push-3{left:25%}.col-lg-push-2{left:16.66666667%}.col-lg-push-1{left:8.33333333%}.col-lg-push-0{left:auto}.col-lg-offset-12{margin-left:100%}.col-lg-offset-11{margin-left:91.66666667%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-0{margin-left:0}}table{background-color:transparent}caption{padding-top:8px;padding-bottom:8px;color:#777;text-align:left}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>thead>tr>th,.table>tbody>tr>th,.table>tfoot>tr>th,.table>thead>tr>td,.table>tbody>tr>td,.table>tfoot>tr>td{padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>th,.table>caption+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>td,.table>thead:first-child>tr:first-child>td{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>thead>tr>th,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>tbody>tr>td,.table-condensed>tfoot>tr>td{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>tbody>tr>td,.table-bordered>tfoot>tr>td{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>thead>tr>td{border-bottom-width:2px}.table-striped>tbody>tr:nth-of-type(odd){background-color:#f9f9f9}.table-hover>tbody>tr:hover{background-color:#f5f5f5}table col[class*=col-]{position:static;float:none;display:table-column}table td[class*=col-],table th[class*=col-]{position:static;float:none;display:table-cell}.table>thead>tr>td.active,.table>tbody>tr>td.active,.table>tfoot>tr>td.active,.table>thead>tr>th.active,.table>tbody>tr>th.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>tbody>tr.active>td,.table>tfoot>tr.active>td,.table>thead>tr.active>th,.table>tbody>tr.active>th,.table>tfoot>tr.active>th{background-color:#f5f5f5}.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover,.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr.active:hover>th{background-color:#e8e8e8}.table>thead>tr>td.success,.table>tbody>tr>td.success,.table>tfoot>tr>td.success,.table>thead>tr>th.success,.table>tbody>tr>th.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>tbody>tr.success>td,.table>tfoot>tr.success>td,.table>thead>tr.success>th,.table>tbody>tr.success>th,.table>tfoot>tr.success>th{background-color:#dff0d8}.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover,.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr.success:hover>th{background-color:#d0e9c6}.table>thead>tr>td.info,.table>tbody>tr>td.info,.table>tfoot>tr>td.info,.table>thead>tr>th.info,.table>tbody>tr>th.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>tbody>tr.info>td,.table>tfoot>tr.info>td,.table>thead>tr.info>th,.table>tbody>tr.info>th,.table>tfoot>tr.info>th{background-color:#d9edf7}.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover,.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr.info:hover>th{background-color:#c4e3f3}.table>thead>tr>td.warning,.table>tbody>tr>td.warning,.table>tfoot>tr>td.warning,.table>thead>tr>th.warning,.table>tbody>tr>th.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>tbody>tr.warning>td,.table>tfoot>tr.warning>td,.table>thead>tr.warning>th,.table>tbody>tr.warning>th,.table>tfoot>tr.warning>th{background-color:#fcf8e3}.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover,.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr.warning:hover>th{background-color:#faf2cc}.table>thead>tr>td.danger,.table>tbody>tr>td.danger,.table>tfoot>tr>td.danger,.table>thead>tr>th.danger,.table>tbody>tr>th.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>tbody>tr.danger>td,.table>tfoot>tr.danger>td,.table>thead>tr.danger>th,.table>tbody>tr.danger>th,.table>tfoot>tr.danger>th{background-color:#f2dede}.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover,.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr.danger:hover>th{background-color:#ebcccc}.table-responsive{overflow-x:auto;min-height:.01%}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>thead>tr>th,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tfoot>tr>td{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>thead>tr>th:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.table-responsive>.table-bordered>thead>tr>th:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>th,.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>td{border-bottom:0}}fieldset{padding:0;margin:0;border:0;min-width:0}legend{display:block;width:100%;padding:0;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700}input[type=search]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}input[type=radio],input[type=checkbox]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type=file]{display:block}input[type=range]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type=file]:focus,input[type=radio]:focus,input[type=checkbox]:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{display:block;padding-top:7px;font-size:14px;line-height:1.42857143;color:#555}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#777;opacity:1}.form-control:-ms-input-placeholder{color:#777}.form-control::-webkit-input-placeholder{color:#777}.form-control::-ms-expand{border:0;background-color:transparent}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{background-color:#eee;opacity:1}.form-control[disabled],fieldset[disabled] .form-control{cursor:not-allowed}textarea.form-control{height:auto}input[type=search]{-webkit-appearance:none}@media screen and (-webkit-min-device-pixel-ratio:0){input[type=date].form-control,input[type=time].form-control,input[type=datetime-local].form-control,input[type=month].form-control{line-height:34px}input[type=date].input-sm,input[type=time].input-sm,input[type=datetime-local].input-sm,input[type=month].input-sm,.input-group-sm input[type=date],.input-group-sm input[type=time],.input-group-sm input[type=datetime-local],.input-group-sm input[type=month]{line-height:30px}input[type=date].input-lg,input[type=time].input-lg,input[type=datetime-local].input-lg,input[type=month].input-lg,.input-group-lg input[type=date],.input-group-lg input[type=time],.input-group-lg input[type=datetime-local],.input-group-lg input[type=month]{line-height:46px}}.form-group{margin-bottom:15px}.radio,.checkbox{position:relative;display:block;margin-top:10px;margin-bottom:10px}.radio label,.checkbox label{min-height:20px;padding-left:20px;margin-bottom:0;font-weight:400;cursor:pointer}.radio input[type=radio],.radio-inline input[type=radio],.checkbox input[type=checkbox],.checkbox-inline input[type=checkbox]{position:absolute;margin-left:-20px;margin-top:4px \9}.radio+.radio,.checkbox+.checkbox{margin-top:-5px}.radio-inline,.checkbox-inline{position:relative;display:inline-block;padding-left:20px;margin-bottom:0;vertical-align:middle;font-weight:400;cursor:pointer}.radio-inline+.radio-inline,.checkbox-inline+.checkbox-inline{margin-top:0;margin-left:10px}input[type=radio][disabled],input[type=checkbox][disabled],input[type=radio].disabled,input[type=checkbox].disabled,fieldset[disabled] input[type=radio],fieldset[disabled] input[type=checkbox]{cursor:not-allowed}.radio-inline.disabled,.checkbox-inline.disabled,fieldset[disabled] .radio-inline,fieldset[disabled] .checkbox-inline{cursor:not-allowed}.radio.disabled label,.checkbox.disabled label,fieldset[disabled] .radio label,fieldset[disabled] .checkbox label{cursor:not-allowed}.form-control-static{padding-top:7px;padding-bottom:7px;margin-bottom:0;min-height:34px}.form-control-static.input-lg,.form-control-static.input-sm{padding-left:0;padding-right:0}.input-sm{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm{height:30px;line-height:30px}textarea.input-sm,select[multiple].input-sm{height:auto}.form-group-sm .form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.form-group-sm select.form-control{height:30px;line-height:30px}.form-group-sm textarea.form-control,.form-group-sm select[multiple].form-control{height:auto}.form-group-sm .form-control-static{height:30px;min-height:32px;padding:6px 10px;font-size:12px;line-height:1.5}.input-lg{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}select.input-lg{height:46px;line-height:46px}textarea.input-lg,select[multiple].input-lg{height:auto}.form-group-lg .form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}.form-group-lg select.form-control{height:46px;line-height:46px}.form-group-lg textarea.form-control,.form-group-lg select[multiple].form-control{height:auto}.form-group-lg .form-control-static{height:46px;min-height:38px;padding:11px 16px;font-size:18px;line-height:1.33}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:0;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center;pointer-events:none}.input-lg+.form-control-feedback,.input-group-lg+.form-control-feedback,.form-group-lg .form-control+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback,.input-group-sm+.form-control-feedback,.form-group-sm .form-control+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .help-block,.has-success .control-label,.has-success .radio,.has-success .checkbox,.has-success .radio-inline,.has-success .checkbox-inline,.has-success.radio label,.has-success.checkbox label,.has-success.radio-inline label,.has-success.checkbox-inline label{color:#3c763d}.has-success .form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-success .form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;border-color:#3c763d;background-color:#dff0d8}.has-success .form-control-feedback{color:#3c763d}.has-warning .help-block,.has-warning .control-label,.has-warning .radio,.has-warning .checkbox,.has-warning .radio-inline,.has-warning .checkbox-inline,.has-warning.radio label,.has-warning.checkbox label,.has-warning.radio-inline label,.has-warning.checkbox-inline label{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-warning .form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;border-color:#8a6d3b;background-color:#fcf8e3}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .help-block,.has-error .control-label,.has-error .radio,.has-error .checkbox,.has-error .radio-inline,.has-error .checkbox-inline,.has-error.radio label,.has-error.checkbox label,.has-error.radio-inline label,.has-error.checkbox-inline label{color:#a94442}.has-error .form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-error .form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;border-color:#a94442;background-color:#f2dede}.has-error .form-control-feedback{color:#a94442}.has-feedback label~.form-control-feedback{top:25px}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media(min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .form-control-static{display:inline-block}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn,.form-inline .input-group .form-control{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .radio,.form-inline .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .radio label,.form-inline .checkbox label{padding-left:0}.form-inline .radio input[type=radio],.form-inline .checkbox input[type=checkbox]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}}.form-horizontal .radio,.form-horizontal .checkbox,.form-horizontal .radio-inline,.form-horizontal .checkbox-inline{margin-top:0;margin-bottom:0;padding-top:7px}.form-horizontal .radio,.form-horizontal .checkbox{min-height:27px}.form-horizontal .form-group{margin-left:-15px;margin-right:-15px}@media(min-width:768px){.form-horizontal .control-label{text-align:right;margin-bottom:0;padding-top:7px}}.form-horizontal .has-feedback .form-control-feedback{right:15px}@media(min-width:768px){.form-horizontal .form-group-lg .control-label{padding-top:11px;font-size:18px}}@media(min-width:768px){.form-horizontal .form-group-sm .control-label{padding-top:6px;font-size:12px}}.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:14px;line-height:1.42857143;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open>.dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open>.dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open>.dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open>.dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open>.dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#3071a9;border-color:#193c5a}.btn-primary:hover{color:#fff;background-color:#3071a9;border-color:#285e8e}.btn-primary:active,.btn-primary.active,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#3071a9;border-color:#285e8e}.btn-primary:active:hover,.btn-primary.active:hover,.open>.dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open>.dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open>.dropdown-toggle.btn-primary.focus{color:#fff;background-color:#285e8e;border-color:#193c5a}.btn-primary:active,.btn-primary.active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#428bca;border-color:#357ebd}.btn-primary .badge{color:#428bca;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#449d44;border-color:#255625}.btn-success:hover{color:#fff;background-color:#449d44;border-color:#398439}.btn-success:active,.btn-success.active,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success:active:hover,.btn-success.active:hover,.open>.dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open>.dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open>.dropdown-toggle.btn-success.focus{color:#fff;background-color:#398439;border-color:#255625}.btn-success:active,.btn-success.active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open>.dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open>.dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open>.dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open>.dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open>.dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open>.dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open>.dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open>.dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open>.dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#428bca;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#2a6496;text-decoration:underline;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg,.btn-group-lg>.btn{padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}.btn-sm,.btn-group-sm>.btn{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.btn-xs,.btn-group-xs>.btn{padding:1px 5px;font-size:12px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type=submit].btn-block,input[type=reset].btn-block,input[type=button].btn-block{width:100%}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition-property:height,visibility;-o-transition-property:height,visibility;transition-property:height,visibility;-webkit-transition-duration:.35s;-o-transition-duration:.35s;transition-duration:.35s;-webkit-transition-timing-function:ease;-o-transition-timing-function:ease;transition-timing-function:ease}.btn-group,.btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.btn-group>.btn,.btn-group-vertical>.btn{position:relative;float:left}.btn-group>.btn:hover,.btn-group-vertical>.btn:hover,.btn-group>.btn:focus,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group-vertical>.btn:active,.btn-group>.btn.active,.btn-group-vertical>.btn.active{z-index:2}.btn-group .btn+.btn,.btn-group .btn+.btn-group,.btn-group .btn-group+.btn,.btn-group .btn-group+.btn-group{margin-left:-1px}.btn-toolbar{margin-left:-5px}.btn-toolbar .btn,.btn-toolbar .btn-group,.btn-toolbar .input-group{float:left}.btn-toolbar>.btn,.btn-toolbar>.btn-group,.btn-toolbar>.input-group{margin-left:5px}.btn-group>.btn:not(:first-child):not(:last-child):not(.dropdown-toggle){border-radius:0}.btn-group>.btn:first-child{margin-left:0}.btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-top-right-radius:0}.btn-group>.btn:last-child:not(:first-child),.btn-group>.dropdown-toggle:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0}.btn-group>.btn-group{float:left}.btn-group>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-top-right-radius:0}.btn-group>.btn-group:last-child:not(:first-child)>.btn:first-child{border-bottom-left-radius:0;border-top-left-radius:0}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle{outline:0}.btn-group>.btn+.dropdown-toggle{padding-left:8px;padding-right:8px}.btn-group>.btn-lg+.dropdown-toggle{padding-left:12px;padding-right:12px}.btn-group.open .dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn-group.open .dropdown-toggle.btn-link{-webkit-box-shadow:none;box-shadow:none}.btn .caret{margin-left:0}.btn-lg .caret{border-width:5px 5px 0;border-bottom-width:0}.dropup .btn-lg .caret{border-width:0 5px 5px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;width:100%;max-width:100%}.btn-group-vertical>.btn-group>.btn{float:none}.btn-group-vertical>.btn+.btn,.btn-group-vertical>.btn+.btn-group,.btn-group-vertical>.btn-group+.btn,.btn-group-vertical>.btn-group+.btn-group{margin-top:-1px;margin-left:0}.btn-group-vertical>.btn:not(:first-child):not(:last-child){border-radius:0}.btn-group-vertical>.btn:first-child:not(:last-child){border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:last-child:not(:first-child){border-top-right-radius:0;border-top-left-radius:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}.btn-group-vertical>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group-vertical>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group-vertical>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-right-radius:0;border-top-left-radius:0}.btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.btn-group-justified>.btn,.btn-group-justified>.btn-group{float:none;display:table-cell;width:1%}.btn-group-justified>.btn-group .btn{width:100%}.btn-group-justified>.btn-group .dropdown-menu{left:auto}[data-toggle=buttons]>.btn input[type=radio],[data-toggle=buttons]>.btn-group>.btn input[type=radio],[data-toggle=buttons]>.btn input[type=checkbox],[data-toggle=buttons]>.btn-group>.btn input[type=checkbox]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*=col-]{float:none;padding-left:0;padding-right:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group .form-control:focus{z-index:3}.input-group-lg>.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}select.input-group-lg>.form-control,select.input-group-lg>.input-group-addon,select.input-group-lg>.input-group-btn>.btn{height:46px;line-height:46px}textarea.input-group-lg>.form-control,textarea.input-group-lg>.input-group-addon,textarea.input-group-lg>.input-group-btn>.btn,select[multiple].input-group-lg>.form-control,select[multiple].input-group-lg>.input-group-addon,select[multiple].input-group-lg>.input-group-btn>.btn{height:auto}.input-group-sm>.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-group-sm>.form-control,select.input-group-sm>.input-group-addon,select.input-group-sm>.input-group-btn>.btn{height:30px;line-height:30px}textarea.input-group-sm>.form-control,textarea.input-group-sm>.input-group-addon,textarea.input-group-sm>.input-group-btn>.btn,select[multiple].input-group-sm>.form-control,select[multiple].input-group-sm>.input-group-addon,select[multiple].input-group-sm>.input-group-btn>.btn{height:auto}.input-group-addon,.input-group-btn,.input-group .form-control{display:table-cell}.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child),.input-group .form-control:not(:first-child):not(:last-child){border-radius:0}.input-group-addon,.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type=radio],.input-group-addon input[type=checkbox]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle),.input-group-btn:last-child>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-top-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:first-child>.btn-group:not(:first-child)>.btn{border-bottom-left-radius:0;border-top-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:hover,.input-group-btn>.btn:focus,.input-group-btn>.btn:active{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{z-index:2;margin-left:-1px}.nav{margin-bottom:0;padding-left:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.nav>li>a:hover,.nav>li>a:focus{text-decoration:none;background-color:#eee}.nav>li.disabled>a{color:#777}.nav>li.disabled>a:hover,.nav>li.disabled>a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open>a,.nav .open>a:hover,.nav .open>a:focus{background-color:#eee;border-color:#428bca}.nav .nav-divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.nav>li>a>img{max-width:none}.nav-tabs{border-bottom:1px solid #ddd}.nav-tabs>li{float:left;margin-bottom:-1px}.nav-tabs>li>a{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.nav-tabs>li>a:hover{border-color:#eee #eee #ddd}.nav-tabs>li.active>a,.nav-tabs>li.active>a:hover,.nav-tabs>li.active>a:focus{color:#555;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent;cursor:default}.nav-tabs.nav-justified{width:100%;border-bottom:0}.nav-tabs.nav-justified>li{float:none}.nav-tabs.nav-justified>li>a{text-align:center;margin-bottom:5px}.nav-tabs.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media(min-width:768px){.nav-tabs.nav-justified>li{display:table-cell;width:1%}.nav-tabs.nav-justified>li>a{margin-bottom:0}}.nav-tabs.nav-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border:1px solid #ddd}@media(min-width:768px){.nav-tabs.nav-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:hover,.nav-tabs.nav-justified>.active>a:focus{border-bottom-color:#fff}}.nav-pills>li{float:left}.nav-pills>li>a{border-radius:4px}.nav-pills>li+li{margin-left:2px}.nav-pills>li.active>a,.nav-pills>li.active>a:hover,.nav-pills>li.active>a:focus{color:#fff;background-color:#428bca}.nav-stacked>li{float:none}.nav-stacked>li+li{margin-top:2px;margin-left:0}.nav-justified{width:100%}.nav-justified>li{float:none}.nav-justified>li>a{text-align:center;margin-bottom:5px}.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media(min-width:768px){.nav-justified>li{display:table-cell;width:1%}.nav-justified>li>a{margin-bottom:0}}.nav-tabs-justified{border-bottom:0}.nav-tabs-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border:1px solid #ddd}@media(min-width:768px){.nav-tabs-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:hover,.nav-tabs-justified>.active>a:focus{border-bottom-color:#fff}}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-right-radius:0;border-top-left-radius:0}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media(min-width:768px){.navbar{border-radius:4px}}@media(min-width:768px){.navbar-header{float:left}}.navbar-collapse{overflow-x:visible;padding-right:15px;padding-left:15px;border-top:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px rgba(255,255,255,.1);-webkit-overflow-scrolling:touch}.navbar-collapse.in{overflow-y:auto}@media(min-width:768px){.navbar-collapse{width:auto;border-top:0;-webkit-box-shadow:none;box-shadow:none}.navbar-collapse.collapse{display:block!important;height:auto!important;padding-bottom:0;overflow:visible!important}.navbar-collapse.in{overflow-y:visible}.navbar-fixed-top .navbar-collapse,.navbar-static-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{padding-left:0;padding-right:0}}.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:340px}@media(max-device-width:480px) and (orientation:landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:-15px;margin-left:-15px}@media(min-width:768px){.container>.navbar-header,.container-fluid>.navbar-header,.container>.navbar-collapse,.container-fluid>.navbar-collapse{margin-right:0;margin-left:0}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media(min-width:768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media(min-width:768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}.navbar-brand{float:left;padding:15px;font-size:18px;line-height:20px;height:50px}.navbar-brand:hover,.navbar-brand:focus{text-decoration:none}.navbar-brand>img{display:block}@media(min-width:768px){.navbar>.container .navbar-brand,.navbar>.container-fluid .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;margin-right:15px;padding:9px 10px;margin-top:8px;margin-bottom:8px;background-color:transparent;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle:focus{outline:0}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media(min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media(max-width:767px){.navbar-nav .open .dropdown-menu{position:static;float:none;width:auto;margin-top:0;background-color:transparent;border:0;-webkit-box-shadow:none;box-shadow:none}.navbar-nav .open .dropdown-menu>li>a,.navbar-nav .open .dropdown-menu .dropdown-header{padding:5px 15px 5px 25px}.navbar-nav .open .dropdown-menu>li>a{line-height:20px}.navbar-nav .open .dropdown-menu>li>a:hover,.navbar-nav .open .dropdown-menu>li>a:focus{background-image:none}}@media(min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}}.navbar-form{margin-left:-15px;margin-right:-15px;padding:10px 15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px rgba(255,255,255,.1),0 1px rgba(255,255,255,.1);margin-top:8px;margin-bottom:8px}@media(min-width:768px){.navbar-form .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .form-control-static{display:inline-block}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .input-group-addon,.navbar-form .input-group .input-group-btn,.navbar-form .input-group .form-control{width:auto}.navbar-form .input-group>.form-control{width:100%}.navbar-form .control-label{margin-bottom:0;vertical-align:middle}.navbar-form .radio,.navbar-form .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.navbar-form .radio label,.navbar-form .checkbox label{padding-left:0}.navbar-form .radio input[type=radio],.navbar-form .checkbox input[type=checkbox]{position:relative;margin-left:0}.navbar-form .has-feedback .form-control-feedback{top:0}}@media(max-width:767px){.navbar-form .form-group{margin-bottom:5px}.navbar-form .form-group:last-child{margin-bottom:0}}@media(min-width:768px){.navbar-form{width:auto;border:0;margin-left:0;margin-right:0;padding-top:0;padding-bottom:0;-webkit-box-shadow:none;box-shadow:none}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-right-radius:0;border-top-left-radius:0}.navbar-fixed-bottom .navbar-nav>li>.dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-btn{margin-top:8px;margin-bottom:8px}.navbar-btn.btn-sm{margin-top:10px;margin-bottom:10px}.navbar-btn.btn-xs{margin-top:14px;margin-bottom:14px}.navbar-text{margin-top:15px;margin-bottom:15px}@media(min-width:768px){.navbar-text{float:left;margin-left:15px;margin-right:15px}}@media(min-width:768px){.navbar-left{float:left!important}.navbar-right{float:right!important;margin-right:-15px}.navbar-right~.navbar-right{margin-right:0}}.navbar-default{background-color:#f8f8f8;border-color:#e7e7e7}.navbar-default .navbar-brand{color:#777}.navbar-default .navbar-brand:hover,.navbar-default .navbar-brand:focus{color:#5e5e5e;background-color:transparent}.navbar-default .navbar-text{color:#777}.navbar-default .navbar-nav>li>a{color:#777}.navbar-default .navbar-nav>li>a:hover,.navbar-default .navbar-nav>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.active>a:hover,.navbar-default .navbar-nav>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav>.disabled>a,.navbar-default .navbar-nav>.disabled>a:hover,.navbar-default .navbar-nav>.disabled>a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#ddd}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#ddd}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#e7e7e7}.navbar-default .navbar-nav>.open>a,.navbar-default .navbar-nav>.open>a:hover,.navbar-default .navbar-nav>.open>a:focus{background-color:#e7e7e7;color:#555}@media(max-width:767px){.navbar-default .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-default .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>li>a:focus{color:#333;background-color:transparent}.navbar-default .navbar-nav .open .dropdown-menu>.active>a,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:focus{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#777}.navbar-default .navbar-link:hover{color:#333}.navbar-default .btn-link{color:#777}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#333}.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:hover,.navbar-default .btn-link[disabled]:focus,fieldset[disabled] .navbar-default .btn-link:focus{color:#ccc}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#777}.navbar-inverse .navbar-brand:hover,.navbar-inverse .navbar-brand:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-text{color:#777}.navbar-inverse .navbar-nav>li>a{color:#777}.navbar-inverse .navbar-nav>li>a:hover,.navbar-inverse .navbar-nav>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav>.active>a,.navbar-inverse .navbar-nav>.active>a:hover,.navbar-inverse .navbar-nav>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav>.disabled>a,.navbar-inverse .navbar-nav>.disabled>a:hover,.navbar-inverse .navbar-nav>.disabled>a:focus{color:#444;background-color:transparent}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle:hover,.navbar-inverse .navbar-toggle:focus{background-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.navbar-inverse .navbar-nav>.open>a,.navbar-inverse .navbar-nav>.open>a:hover,.navbar-inverse .navbar-nav>.open>a:focus{background-color:#080808;color:#fff}@media(max-width:767px){.navbar-inverse .navbar-nav .open .dropdown-menu>.dropdown-header{border-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu .divider{background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:focus{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:focus{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:hover,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:focus{color:#444;background-color:transparent}}.navbar-inverse .navbar-link{color:#777}.navbar-inverse .navbar-link:hover{color:#fff}.navbar-inverse .btn-link{color:#777}.navbar-inverse .btn-link:hover,.navbar-inverse .btn-link:focus{color:#fff}.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:hover,.navbar-inverse .btn-link[disabled]:focus,fieldset[disabled] .navbar-inverse .btn-link:focus{color:#444}.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#428bca}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#3071a9}.label-success{background-color:#5cb85c}.label-success[href]:hover,.label-success[href]:focus{background-color:#449d44}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#777;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs>.btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}.list-group-item.active>.badge,.nav-pills>.active>a>.badge{color:#428bca;background-color:#fff}.list-group-item>.badge{float:right}.list-group-item>.badge+.badge{margin-right:5px}.nav-pills>li>a>.badge{margin-left:3px}.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert h4{margin-top:0;color:inherit}.alert .alert-link{font-weight:700}.alert>p,.alert>ul{margin-bottom:0}.alert>p+p{margin-top:5px}.alert-dismissable,.alert-dismissible{padding-right:35px}.alert-dismissable .close,.alert-dismissible .close{position:relative;top:-2px;right:-21px;color:inherit}.alert-success{background-color:#dff0d8;border-color:#d6e9c6;color:#3c763d}.alert-success hr{border-top-color:#c9e2b3}.alert-success .alert-link{color:#2b542c}.alert-info{background-color:#d9edf7;border-color:#bce8f1;color:#31708f}.alert-info hr{border-top-color:#a6e1ec}.alert-info .alert-link{color:#245269}.alert-warning{background-color:#fcf8e3;border-color:#faebcc;color:#8a6d3b}.alert-warning hr{border-top-color:#f7e1b5}.alert-warning .alert-link{color:#66512c}.alert-danger{background-color:#f2dede;border-color:#ebccd1;color:#a94442}.alert-danger hr{border-top-color:#e4b9c0}.alert-danger .alert-link{color:#843534}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-o-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.progress{overflow:hidden;height:20px;margin-bottom:20px;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1)}.progress-bar{float:left;width:0%;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#428bca;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);box-shadow:inset 0 -1px rgba(0,0,0,.15);-webkit-transition:width .6s ease;-o-transition:width .6s ease;transition:width .6s ease}.progress-striped .progress-bar,.progress-bar-striped{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);-webkit-background-size:40px 40px;background-size:40px 40px}.progress.active .progress-bar,.progress-bar.active{-webkit-animation:progress-bar-stripes 2s linear infinite;-o-animation:progress-bar-stripes 2s linear infinite;animation:progress-bar-stripes 2s linear infinite}.progress-bar-success{background-color:#5cb85c}.progress-striped .progress-bar-success{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-info{background-color:#5bc0de}.progress-striped .progress-bar-info{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-warning{background-color:#f0ad4e}.progress-striped .progress-bar-warning{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-danger{background-color:#d9534f}.progress-striped .progress-bar-danger{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,5%);box-shadow:0 1px 1px rgba(0,0,0,5%)}.panel-body{padding:15px}.panel-heading{padding:10px 15px;border-bottom:1px solid transparent;border-top-right-radius:3px;border-top-left-radius:3px}.panel-heading>.dropdown .dropdown-toggle{color:inherit}.panel-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.panel-title>a,.panel-title>small,.panel-title>.small,.panel-title>small>a,.panel-title>.small>a{color:inherit}.panel-footer{padding:10px 15px;background-color:#f5f5f5;border-top:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.list-group,.panel>.panel-collapse>.list-group{margin-bottom:0}.panel>.list-group .list-group-item,.panel>.panel-collapse>.list-group .list-group-item{border-width:1px 0;border-radius:0}.panel>.list-group:first-child .list-group-item:first-child,.panel>.panel-collapse>.list-group:first-child .list-group-item:first-child{border-top:0;border-top-right-radius:3px;border-top-left-radius:3px}.panel>.list-group:last-child .list-group-item:last-child,.panel>.panel-collapse>.list-group:last-child .list-group-item:last-child{border-bottom:0;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.panel-heading+.panel-collapse>.list-group .list-group-item:first-child{border-top-right-radius:0;border-top-left-radius:0}.panel-heading+.list-group .list-group-item:first-child{border-top-width:0}.list-group+.panel-footer{border-top-width:0}.panel>.table,.panel>.table-responsive>.table,.panel>.panel-collapse>.table{margin-bottom:0}.panel>.table caption,.panel>.table-responsive>.table caption,.panel>.panel-collapse>.table caption{padding-left:15px;padding-right:15px}.panel>.table:first-child,.panel>.table-responsive:first-child>.table:first-child{border-top-right-radius:3px;border-top-left-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:first-child{border-top-left-radius:3px}.panel>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:last-child{border-top-right-radius:3px}.panel>.table:last-child,.panel>.table-responsive:last-child>.table:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child{border-bottom-left-radius:3px;border-bottom-right-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:first-child{border-bottom-left-radius:3px}.panel>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:last-child{border-bottom-right-radius:3px}.panel>.panel-body+.table,.panel>.panel-body+.table-responsive,.panel>.table+.panel-body,.panel>.table-responsive+.panel-body{border-top:1px solid #ddd}.panel>.table>tbody:first-child>tr:first-child th,.panel>.table>tbody:first-child>tr:first-child td{border-top:0}.panel>.table-bordered,.panel>.table-responsive>.table-bordered{border:0}.panel>.table-bordered>thead>tr>th:first-child,.panel>.table-responsive>.table-bordered>thead>tr>th:first-child,.panel>.table-bordered>tbody>tr>th:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:first-child,.panel>.table-bordered>tfoot>tr>th:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:first-child,.panel>.table-bordered>thead>tr>td:first-child,.panel>.table-responsive>.table-bordered>thead>tr>td:first-child,.panel>.table-bordered>tbody>tr>td:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:first-child,.panel>.table-bordered>tfoot>tr>td:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.panel>.table-bordered>thead>tr>th:last-child,.panel>.table-responsive>.table-bordered>thead>tr>th:last-child,.panel>.table-bordered>tbody>tr>th:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:last-child,.panel>.table-bordered>tfoot>tr>th:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:last-child,.panel>.table-bordered>thead>tr>td:last-child,.panel>.table-responsive>.table-bordered>thead>tr>td:last-child,.panel>.table-bordered>tbody>tr>td:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:last-child,.panel>.table-bordered>tfoot>tr>td:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.panel>.table-bordered>thead>tr:first-child>td,.panel>.table-responsive>.table-bordered>thead>tr:first-child>td,.panel>.table-bordered>tbody>tr:first-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>td,.panel>.table-bordered>thead>tr:first-child>th,.panel>.table-responsive>.table-bordered>thead>tr:first-child>th,.panel>.table-bordered>tbody>tr:first-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>th{border-bottom:0}.panel>.table-bordered>tbody>tr:last-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>td,.panel>.table-bordered>tfoot>tr:last-child>td,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>td,.panel>.table-bordered>tbody>tr:last-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>th,.panel>.table-bordered>tfoot>tr:last-child>th,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}.panel>.table-responsive{border:0;margin-bottom:0}.panel-group{margin-bottom:20px}.panel-group .panel{margin-bottom:0;border-radius:4px}.panel-group .panel+.panel{margin-top:5px}.panel-group .panel-heading{border-bottom:0}.panel-group .panel-heading+.panel-collapse>.panel-body,.panel-group .panel-heading+.panel-collapse>.list-group{border-top:1px solid #ddd}.panel-group .panel-footer{border-top:0}.panel-group .panel-footer+.panel-collapse .panel-body{border-bottom:1px solid #ddd}.panel-default{border-color:#ddd}.panel-default>.panel-heading{color:#333;background-color:#f5f5f5;border-color:#ddd}.panel-default>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ddd}.panel-default>.panel-heading .badge{color:#f5f5f5;background-color:#333}.panel-default>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ddd}.panel-primary{border-color:#428bca}.panel-primary>.panel-heading{color:#fff;background-color:#428bca;border-color:#428bca}.panel-primary>.panel-heading+.panel-collapse>.panel-body{border-top-color:#428bca}.panel-primary>.panel-heading .badge{color:#428bca;background-color:#fff}.panel-primary>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#428bca}.panel-success{border-color:#d6e9c6}.panel-success>.panel-heading{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.panel-success>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d6e9c6}.panel-success>.panel-heading .badge{color:#dff0d8;background-color:#3c763d}.panel-success>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d6e9c6}.panel-info{border-color:#bce8f1}.panel-info>.panel-heading{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.panel-info>.panel-heading+.panel-collapse>.panel-body{border-top-color:#bce8f1}.panel-info>.panel-heading .badge{color:#d9edf7;background-color:#31708f}.panel-info>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#bce8f1}.panel-warning{border-color:#faebcc}.panel-warning>.panel-heading{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.panel-warning>.panel-heading+.panel-collapse>.panel-body{border-top-color:#faebcc}.panel-warning>.panel-heading .badge{color:#fcf8e3;background-color:#8a6d3b}.panel-warning>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#faebcc}.panel-danger{border-color:#ebccd1}.panel-danger>.panel-heading{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.panel-danger>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ebccd1}.panel-danger>.panel-heading .badge{color:#f2dede;background-color:#a94442}.panel-danger>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ebccd1}.modal-open{overflow:hidden}.modal{display:none;overflow:hidden;position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{-webkit-transform:translate(0,-25%);-ms-transform:translate(0,-25%);-o-transform:translate(0,-25%);transform:translate(0,-25%);-webkit-transition:-webkit-transform .3s ease-out;-o-transition:-o-transform .3s ease-out;transition:transform .3s ease-out}.modal.in .modal-dialog{-webkit-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;border:1px solid #999;border:1px solid rgba(0,0,0,.2);border-radius:6px;-webkit-box-shadow:0 3px 9px rgba(0,0,0,.5);box-shadow:0 3px 9px rgba(0,0,0,.5);-webkit-background-clip:padding-box;background-clip:padding-box;outline:0}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{opacity:0;filter:alpha(opacity=0)}.modal-backdrop.in{opacity:.5;filter:alpha(opacity=50)}.modal-header{padding:15px;border-bottom:1px solid #e5e5e5}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.42857143}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer .btn+.btn{margin-left:5px;margin-bottom:0}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media(min-width:768px){.modal-dialog{width:600px;margin:30px auto}.modal-content{-webkit-box-shadow:0 5px 15px rgba(0,0,0,.5);box-shadow:0 5px 15px rgba(0,0,0,.5)}.modal-sm{width:300px}}@media(min-width:992px){.modal-lg{width:900px}}.clearfix:before,.clearfix:after,.dl-horizontal dd:before,.dl-horizontal dd:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.btn-toolbar:before,.btn-toolbar:after,.btn-group-vertical>.btn-group:before,.btn-group-vertical>.btn-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after,.panel-body:before,.panel-body:after,.modal-header:before,.modal-header:after,.modal-footer:before,.modal-footer:after{content:" ";display:table}.clearfix:after,.dl-horizontal dd:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.btn-toolbar:after,.btn-group-vertical>.btn-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after,.panel-body:after,.modal-header:after,.modal-footer:after{clear:both}.center-block{display:block;margin-left:auto;margin-right:auto}.pull-right{float:right!important}.pull-left{float:left!important}.hide{display:none!important}.show{display:block!important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none!important}.affix{position:fixed}@-ms-viewport{width:device-width}.visible-xs,.visible-sm,.visible-md,.visible-lg{display:none!important}.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block{display:none!important}@media(max-width:767px){.visible-xs{display:block!important}table.visible-xs{display:table!important}tr.visible-xs{display:table-row!important}th.visible-xs,td.visible-xs{display:table-cell!important}}@media(max-width:767px){.visible-xs-block{display:block!important}}@media(max-width:767px){.visible-xs-inline{display:inline!important}}@media(max-width:767px){.visible-xs-inline-block{display:inline-block!important}}@media(min-width:768px) and (max-width:991px){.visible-sm{display:block!important}table.visible-sm{display:table!important}tr.visible-sm{display:table-row!important}th.visible-sm,td.visible-sm{display:table-cell!important}}@media(min-width:768px) and (max-width:991px){.visible-sm-block{display:block!important}}@media(min-width:768px) and (max-width:991px){.visible-sm-inline{display:inline!important}}@media(min-width:768px) and (max-width:991px){.visible-sm-inline-block{display:inline-block!important}}@media(min-width:992px) and (max-width:1199px){.visible-md{display:block!important}table.visible-md{display:table!important}tr.visible-md{display:table-row!important}th.visible-md,td.visible-md{display:table-cell!important}}@media(min-width:992px) and (max-width:1199px){.visible-md-block{display:block!important}}@media(min-width:992px) and (max-width:1199px){.visible-md-inline{display:inline!important}}@media(min-width:992px) and (max-width:1199px){.visible-md-inline-block{display:inline-block!important}}@media(min-width:1200px){.visible-lg{display:block!important}table.visible-lg{display:table!important}tr.visible-lg{display:table-row!important}th.visible-lg,td.visible-lg{display:table-cell!important}}@media(min-width:1200px){.visible-lg-block{display:block!important}}@media(min-width:1200px){.visible-lg-inline{display:inline!important}}@media(min-width:1200px){.visible-lg-inline-block{display:inline-block!important}}@media(max-width:767px){.hidden-xs{display:none!important}}@media(min-width:768px) and (max-width:991px){.hidden-sm{display:none!important}}@media(min-width:992px) and (max-width:1199px){.hidden-md{display:none!important}}@media(min-width:1200px){.hidden-lg{display:none!important}}.visible-print{display:none!important}@media print{.visible-print{display:block!important}table.visible-print{display:table!important}tr.visible-print{display:table-row!important}th.visible-print,td.visible-print{display:table-cell!important}}.visible-print-block{display:none!important}@media print{.visible-print-block{display:block!important}}.visible-print-inline{display:none!important}@media print{.visible-print-inline{display:inline!important}}.visible-print-inline-block{display:none!important}@media print{.visible-print-inline-block{display:inline-block!important}}@media print{.hidden-print{display:none!important}}table.treetable span.indenter{display:inline-block;margin:0;padding:0;text-align:right;user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;-webkit-user-select:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;width:19px}table.treetable span.indenter a{background-position:0;background-repeat:no-repeat;display:inline-block;text-decoration:none;width:19px}table.treetable tr.collapsed span.indenter a{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAHlJREFUeNrcU1sNgDAQ6wgmcAM2MICGGlg1gJnNzWQcvwQGy1j4oUl/7tH0mpwzM7SgQyO+EZAUWh2MkkzSWhJwuRAlHYsJwEwyvs1gABDuzqoJcTw5qxaIJN0bgQRgIjnlmn1heSO5PE6Y2YXe+5Cr5+h++gs12AcAS6FS+7YOsj4AAAAASUVORK5CYII=)}table.treetable tr.expanded span.indenter a{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAHFJREFUeNpi/P//PwMlgImBQsA44C6gvhfa29v3MzAwOODRc6CystIRbxi0t7fjDJjKykpGYrwwi1hxnLHQ3t7+jIGBQRJJ6HllZaUUKYEYRYBPOB0gBShKwKGA////48VtbW3/8clTnBIH3gCKkzJgAGvBX0dDm0sCAAAAAElFTkSuQmCC)}table.treetable tr.branch{background-color:#f9f9f9}table.treetable tr.selected{background-color:#3875d7;color:#fff}table.treetable tr span.indenter a{outline:0}tr.rule-overview-needs-attention td a{color:#d9534f}td.rule-result div,span.rule-result{text-align:center;font-weight:700;color:#fff;background:gray}td.rule-result-fail div,span.rule-result-fail{background:#d9534f}td.rule-result-error div,span.rule-result-error{background:#d9534f}td.rule-result-unknown div,span.rule-result-unknown{background:#f0ad4e}td.rule-result-pass div,span.rule-result-pass{background:#5cb85c}td.rule-result-fixed div,span.rule-result-fixed{background:#5cb85c}.js-only{display:none}.rule-result-filtered,.rule-result-filtered>*{display:none!important}.search-no-match,.search-no-match>*{display:none!important}.rule-detail-fail,.rule-detail-error,.rule-detail-unknown{border:2px solid #d9534f}#footer{text-align:center;margin-top:50px}pre{overflow:auto!important;word-wrap:normal!important;white-space:pre-wrap}div.check-system-details,div.remediation,div.description{width:0;min-width:100%;overflow-x:auto}div.profile-description{white-space:pre-wrap}div.modal-body{margin:50px;padding:0}div.horizontal-scroll{overflow-x:auto}div.top-spacer-10{margin-top:10px}@media print{.noprint{display:none}.label{border:0;padding:0}.container{width:100%}abbr[title]{border:0;text-decoration:none}div.progress{overflow:visible;height:auto}div.progress-bar{width:auto;float:none;width:auto!important;text-align:left}div.panel-body{padding:4px}}</style><script>/*! jQuery v1.12.4 | (c) jQuery Foundation | jquery.org/license */if(!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var j,se,Be,Ke,qe,gt,c,D,jt,r,ke,re,A,te,f,_,Ue,C,I,lt,dt,vt,bt,Ct,Et,B,ge,P,ue,ct,ht,d=[],o=e.document,p=d.slice,we=d.concat,ne=d.push,Ot=d.indexOf,N={},At=N.toString,O=N.hasOwnProperty,s={},_t="1.12.4",n=function(e,t){return new n.fn.init(e,t)},Mt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Ft=/^-ms-/,It=/-([\da-z])/gi,Bt=function(e,t){return t.toUpperCase()};n.fn=n.prototype={jquery:_t,constructor:n,selector:"",length:0,toArray:function(){return p.call(this)},get:function(e){return e!=null?0>e?this[e+this.length]:this[e]:p.call(this)},pushStack:function(e){var t=n.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return n.each(this,e)},map:function(e){return this.pushStack(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(p.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var n=this.length,t=+e+(0>e?n:0);return this.pushStack(t>=0&&n>t?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:ne,sort:d.sort,splice:d.splice},n.extend=n.fn.extend=function(){var t,s,i,a,r,c,e=arguments[0]||{},o=1,d=arguments.length,l=!1;for("boolean"==typeof e&&(l=e,e=arguments[o]||{},o++),"object"==typeof e||n.isFunction(e)||(e={}),o===d&&(e=this,o--);d>o;o++)if(null!=(r=arguments[o]))for(i in r)s=e[i],t=r[i],e!==t&&(l&&t&&(n.isPlainObject(t)||(a=n.isArray(t)))?(a?(a=!1,c=s&&n.isArray(s)?s:[]):c=s&&n.isPlainObject(s)?s:{},e[i]=n.extend(l,c,t)):void 0!==t&&(e[i]=t));return e},n.extend({expando:"jQuery"+(_t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===n.type(e)},isArray:Array.isArray||function(e){return"array"===n.type(e)},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!n.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==n.type(e)||e.nodeType||n.isWindow(e))return!1;try{if(e.constructor&&!O.call(e,"constructor")&&!O.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}if(!s.ownFirst)for(t in e)return O.call(e,t);for(t in e);return void 0===t||O.call(e,t)},type:function(e){return e==null?e+"":"object"==typeof e||"function"==typeof e?N[At.call(e)]||"object":typeof e},globalEval:function(t){t&&n.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(Ft,"ms-").replace(It,Bt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var s,n=0;if(G(e)){for(s=e.length;s>n;n++)if(t.call(e[n],n,e[n])===!1)break}else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},trim:function(e){return e==null?"":(e+"").replace(Mt,"")},makeArray:function(e,t){var s=t||[];return e!=null&&(G(Object(e))?n.merge(s,"string"==typeof e?[e]:e):ne.call(s,e)),s},inArray:function(e,t,n){var s;if(t){if(Ot)return Ot.call(t,e,n);for(s=t.length,n=n?0>n?Math.max(0,s+n):n:0;s>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var s=+t.length,n=0,o=e.length;s>n;)e[o++]=t[n++];if(s!==s)for(;void 0!==t[n];)e[o++]=t[n++];return e.length=o,e},grep:function(e,t,n){for(var o,i=[],s=0,a=e.length,r=!n;a>s;s++)o=!t(e[s],s),o!==r&&i.push(e[s]);return i},map:function(e,t,n){var o,a,s=0,i=[];if(G(e))for(a=e.length;a>s;s++)o=t(e[s],s,n),o!=null&&i.push(o);else for(s in e)o=t(e[s],s,n),o!=null&&i.push(o);return we.apply([],i)},guid:1,proxy:function(e,t){var s,o,i;return"string"==typeof t&&(i=e[t],t=e,e=i),n.isFunction(e)?(o=p.call(arguments,2),s=function(){return e.apply(t||this,o.concat(p.call(arguments)))},s.guid=e.guid=e.guid||n.guid++,s):void 0},now:function(){return+new Date},support:s}),"function"==typeof Symbol&&(n.fn[Symbol.iterator]=d[Symbol.iterator]),n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){N["[object "+t+"]"]=t.toLowerCase()});function G(e){var t=!!e&&"length"in e&&e.length,s=n.type(e);return"function"!==s&&!n.isWindow(e)&&("array"===s||0===t||"number"==typeof t&&t>0&&t-1 in e)}j=function(e){var t,i,C,A,M,$,J,ne,n,r,d,u,g,v,w,x,k,N,L,a="sizzle"+1*new Date,l=e.document,m=0,pe=0,X=K(),oe=K(),z=K(),Y=function(e,t){return e===t&&(x=!0),0},te=1<<31,_e={}.hasOwnProperty,O=[],ae=O.pop,ge=O.push,b=O.push,Z=O.slice,y=function(e,t){for(var n=0,s=e.length;s>n;n++)if(e[n]===t)return n;return-1},q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",s=`[\\x20\\t\\r\\n\\f]`,j="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Q="\\["+s+"*("+j+")(?:"+s+"*([*^$|!~]?=)"+s+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+j+"))|)"+s+"*\\]",R=":("+j+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Q+")*)|.*)\\)|)",ve=new RegExp(s+"+","g"),T=new RegExp("^"+s+"+|((?:^|[^\\\\])(?:\\\\.)*)"+s+"+$","g"),re=new RegExp("^"+s+"*,"+s+"*"),me=new RegExp("^"+s+"*([>+~]|"+s+")"+s+"*"),ce=new RegExp("="+s+`*([^\\]'"]*?)`+s+"*\\]","g"),le=new RegExp(R),G=new RegExp("^"+j+"$"),F={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j+"|[*])"),ATTR:new RegExp("^"+Q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+s+"*(even|odd|(([+-]|)(\\d*)n|)"+s+"*(?:([+-]|)"+s+"*(\\d+)|))"+s+"*\\)|)","i"),bool:new RegExp("^(?:"+q+")$","i"),needsContext:new RegExp("^"+s+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+s+"*((?:-\\d)?\\d*)"+s+"*\\)|)(?=[^-]|$)","i")},je=/^(?:input|select|textarea|button)$/i,he=/^h\d$/i,E=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,P=/[+~]/,fe=/'|\\/g,p=new RegExp("\\\\([\\da-f]{1,6}"+s+"?|("+s+")|.)","ig"),f=function(e,t,n){var s="0x"+t-65536;return s!==s||n?t:0>s?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)},se=function(){v()};try{b.apply(O=Z.call(l.childNodes),l.childNodes),O[l.childNodes.length].nodeType}catch{b={apply:O.length?function(e,t){ge.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,s=0;e[n++]=t[s++];);e.length=n-1}}}function o(e,t,s,o){var c,d,h,f,g,j,y,_,p=t&&t.ownerDocument,m=t?t.nodeType:9;if(s=s||[],"string"!=typeof e||!e||1!==m&&9!==m&&11!==m)return s;if(!o&&((t?t.ownerDocument||t:l)!==n&&v(t),t=t||n,u)){if(11!==m&&(j=ye.exec(e)))if(d=j[1]){if(9===m){{if(!(h=t.getElementById(d)))return s;if(h.id===d)return s.push(h),s}}else if(p&&(h=p.getElementById(d))&&k(t,h)&&h.id===d)return s.push(h),s}else{if(j[2])return b.apply(s,t.getElementsByTagName(e)),s;if((d=j[3])&&i.getElementsByClassName&&t.getElementsByClassName)return b.apply(s,t.getElementsByClassName(d)),s}if(i.qsa&&!z[e+" "]&&(!r||!r.test(e))){if(1!==m)p=t,y=e;else if("object"!==t.nodeName.toLowerCase()){for((c=t.getAttribute("id"))?c=c.replace(fe,"\\$&"):t.setAttribute("id",c=a),f=A(e),g=f.length,_=G.test(c)?"#"+c:"[id='"+c+"']";g--;)f[g]=_+" "+D(f[g]);y=f.join(","),p=P.test(e)&&W(t.parentNode)||t}if(y)try{return b.apply(s,p.querySelectorAll(y)),s}catch{}finally{c===a&&t.removeAttribute("id")}}}return ne(e.replace(T,"$1"),t,s,o)}function K(){var n=[];function e(s,o){return n.push(s+" ")>t.cacheLength&&delete e[n.shift()],e[s+" "]=o}return e}function c(e){return e[a]=!0,e}function h(e){var t=n.createElement("div");try{return!!e(t)}catch{return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function U(e,n){for(var s=e.split("|"),o=s.length;o--;)t.attrHandle[s[o]]=n}function ie(e,t){var n=t&&e,s=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||te)-(~e.sourceIndex||te);if(s)return s;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ue(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function _(e){return c(function(t){return t=+t,c(function(n,s){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(s[o]=n[o]))})})}function W(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}i=o.support={},J=o.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},v=o.setDocument=function(e){var o,m,c=e?e.ownerDocument||e:l;return c!==n&&9===c.nodeType&&c.documentElement?(n=c,d=n.documentElement,u=!J(n),(o=n.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",se,!1):o.attachEvent&&o.attachEvent("onunload",se)),i.attributes=h(function(e){return e.className="i",!e.getAttribute("className")}),i.getElementsByTagName=h(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),i.getElementsByClassName=E.test(n.getElementsByClassName),i.getById=h(function(e){return d.appendChild(e).id=a,!n.getElementsByName||!n.getElementsByName(a).length}),i.getById?(t.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&u){var n=t.getElementById(e);return n?[n]:[]}},t.filter.ID=function(e){var t=e.replace(p,f);return function(e){return e.getAttribute("id")===t}}):(delete t.find.ID,t.filter.ID=function(e){var t=e.replace(p,f);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),t.find.TAG=i.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,s=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&s.push(n);return s}return o},t.find.CLASS=i.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&u?t.getElementsByClassName(e):void 0},w=[],r=[],(i.qsa=E.test(n.querySelectorAll))&&(h(function(e){d.appendChild(e).innerHTML="<a id='"+a+"'></a><select id='"+a+`-\\' msallowcapture=''><option selected=''></option></select>`,e.querySelectorAll("[msallowcapture^='']").length&&r.push("[*^$]="+s+`*(?:''|"")`),e.querySelectorAll("[selected]").length||r.push("\\["+s+"*(?:value|"+q+")"),e.querySelectorAll("[id~="+a+"-]").length||r.push("~="),e.querySelectorAll(":checked").length||r.push(":checked"),e.querySelectorAll("a#"+a+"+*").length||r.push(".#.+[+~]")}),h(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&r.push("name"+s+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||r.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),r.push(",.*:")})),(i.matchesSelector=E.test(L=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&h(function(e){i.disconnectedMatch=L.call(e,"div"),L.call(e,"[s!='']:x"),w.push("!=",R)}),r=r.length&&new RegExp(r.join("|")),w=w.length&&new RegExp(w.join("|")),m=E.test(d.compareDocumentPosition),k=m||E.test(d.contains)?function(e,t){var s=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(s.contains?s.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Y=m?function(e,t){if(e===t)return x=!0,0;var s=!e.compareDocumentPosition-!t.compareDocumentPosition;return s||(s=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&s||!i.sortDetached&&t.compareDocumentPosition(e)===s?e===n||e.ownerDocument===l&&k(l,e)?-1:t===n||t.ownerDocument===l&&k(l,t)?1:g?y(g,e)-y(g,t):0:4&s?-1:1)}:function(e,t){if(e===t)return x=!0,0;var s,o=0,r=e.parentNode,c=t.parentNode,i=[e],a=[t];if(!r||!c)return e===n?-1:t===n?1:r?-1:c?1:g?y(g,e)-y(g,t):0;if(r===c)return ie(e,t);for(s=e;s=s.parentNode;)i.unshift(s);for(s=t;s=s.parentNode;)a.unshift(s);for(;i[o]===a[o];)o++;return o?ie(i[o],a[o]):i[o]===l?-1:a[o]===l?1:0},n):n},o.matches=function(e,t){return o(e,null,null,t)},o.matchesSelector=function(e,t){if((e.ownerDocument||e)!==n&&v(e),t=t.replace(ce,"='$1']"),i.matchesSelector&&u&&!z[t+" "]&&(!w||!w.test(t))&&(!r||!r.test(t)))try{var s=L.call(e,t);if(s||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch{}return o(t,n,null,[e]).length>0},o.contains=function(e,t){return(e.ownerDocument||e)!==n&&v(e),k(e,t)},o.attr=function(e,s){(e.ownerDocument||e)!==n&&v(e);var a=t.attrHandle[s.toLowerCase()],o=a&&_e.call(t.attrHandle,s.toLowerCase())?a(e,s,!u):void 0;return void 0!==o?o:i.attributes||!u?e.getAttribute(s):(o=e.getAttributeNode(s))&&o.specified?o.value:null},o.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},o.uniqueSort=function(e){var s,o=[],t=0,n=0;if(x=!i.detectDuplicates,g=!i.sortStable&&e.slice(0),e.sort(Y),x){for(;s=e[n++];)s===e[n]&&(t=o.push(n));for(;t--;)e.splice(o[t],1)}return g=null,e},M=o.getText=function(e){var s,n="",o=0,t=e.nodeType;if(t){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=M(e)}else if(3===t||4===t)return e.nodeValue}else for(;s=e[o++];)n+=M(s);return n},t=o.selectors={cacheLength:50,createPseudo:c,match:F,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(p,f),e[3]=(e[3]||e[4]||e[5]||"").replace(p,f),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||o.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&o.error(e[0]),e},PSEUDO:function(e){var n,t=!e[6]&&e[2];return F.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":t&&le.test(t)&&(n=A(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(e[0]=e[0].slice(0,n),e[2]=t.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(p,f).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=X[e+" "];return t||(t=new RegExp("(^|"+s+")"+e+"("+s+"|$)"))&&X(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(s){var i=o.attr(s,e);return i==null?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(ve," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,s,o){var c="nth"!==e.slice(0,3),r="last"!==e.slice(-4),i="of-type"===t;return 1===s&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var d,h,f,p,g,v,b=c!==r?"nextSibling":"previousSibling",j=t.parentNode,_=i&&t.nodeName.toLowerCase(),y=!l&&!i,u=!1;if(j){if(c){for(;b;){for(d=t;d=d[b];)if(i?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;v=b="only"===e&&!v&&"nextSibling"}return!0}if(v=[r?j.firstChild:j.lastChild],r&&y){for(d=j,f=d[a]||(d[a]={}),g=f[d.uniqueID]||(f[d.uniqueID]={}),p=g[e]||[],h=p[0]===m&&p[1],u=h&&p[2],d=h&&j.childNodes[h];d=++h&&d&&d[b]||(u=h=0)||v.pop();)if(1===d.nodeType&&++u&&d===t){g[e]=[m,h,u];break}}else if(y&&(d=t,f=d[a]||(d[a]={}),g=f[d.uniqueID]||(f[d.uniqueID]={}),p=g[e]||[],h=p[0]===m&&p[1],u=h),u===!1)for(;d=++h&&d&&d[b]||(u=h=0)||v.pop();)if((i?d.nodeName.toLowerCase()===_:1===d.nodeType)&&++u&&(y&&(f=d[a]||(d[a]={}),g=f[d.uniqueID]||(f[d.uniqueID]={}),g[e]=[m,u]),d===t))break;return u-=o,u===s||u%s===0&&u/s>=0}}},PSEUDO:function(e,n){var i,s=t.pseudos[e]||t.setFilters[e.toLowerCase()]||o.error("unsupported pseudo: "+e);return s[a]?s(n):s.length>1?(i=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?c(function(e,t){for(var o,i=s(e,n),a=i.length;a--;)o=y(e,i[a]),e[o]=!(t[o]=i[a])}):function(e){return s(e,0,i)}):s}},pseudos:{not:c(function(e){var t=[],s=[],n=$(e.replace(T,"$1"));return n[a]?c(function(e,t,s,o){for(var a,r=n(e,null,o,[]),i=e.length;i--;)(a=r[i])&&(e[i]=!(t[i]=a))}):function(e,o,i){return t[0]=e,n(t,null,i,s),t[0]=null,!s.pop()}}),has:c(function(e){return function(t){return o(e,t).length>0}}),contains:c(function(e){return e=e.replace(p,f),function(t){return(t.textContent||t.innerText||M(t)).indexOf(e)>-1}}),lang:c(function(e){return G.test(e||"")||o.error("unsupported lang: "+e),e=e.replace(p,f).toLowerCase(),function(t){var n;do if(n=u?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType)return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return he.test(e.nodeName)},input:function(e){return je.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:_(function(){return[0]}),last:_(function(e,t){return[t-1]}),eq:_(function(e,t,n){return[0>n?n+t:n]}),even:_(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:_(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:_(function(e,t,n){for(var s=0>n?n+t:n;--s>=0;)e.push(s);return e}),gt:_(function(e,t,n){for(var s=0>n?n+t:n;++s<t;)e.push(s);return e})}},t.pseudos.nth=t.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[C]=de(C);for(C in{submit:!0,reset:!0})t.pseudos[C]=ue(C);function ee(){}ee.prototype=t.filters=t.pseudos,t.setFilters=new ee,A=o.tokenize=function(e,n){var s,i,a,r,c,l,d,u=oe[e+" "];if(u)return n?0:u.slice(0);for(s=e,l=[],d=t.preFilter;s;){a&&!(i=re.exec(s))||(i&&(s=s.slice(i[0].length)||s),l.push(c=[])),a=!1,(i=me.exec(s))&&(a=i.shift(),c.push({value:a,type:i[0].replace(T," ")}),s=s.slice(a.length));for(r in t.filter)!(i=F[r].exec(s))||d[r]&&!(i=d[r](i))||(a=i.shift(),c.push({value:a,type:r,matches:i}),s=s.slice(a.length));if(!a)break}return n?s.length:s?o.error(e):oe(e,l).slice(0)};function D(e){for(var t=0,s=e.length,n="";s>t;t++)n+=e[t].value;return n}function V(e,t,n){var s=t.dir,o=n&&"parentNode"===s,i=pe++;return t.first?function(t,n,i){for(;t=t[s];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,r){var c,l,d,u=[m,i];if(r){for(;t=t[s];)if((1===t.nodeType||o)&&e(t,n,r))return!0}else for(;t=t[s];)if(1===t.nodeType||o){if(d=t[a]||(t[a]={}),l=d[t.uniqueID]||(d[t.uniqueID]={}),(c=l[s])&&c[0]===m&&c[1]===i)return u[2]=c[2];if(l[s]=u,u[2]=e(t,n,r))return!0}}}function B(e){return e.length>1?function(t,n,s){for(var o=e.length;o--;)if(!e[o](t,n,s))return!1;return!0}:e[0]}function be(e,t,n){for(var s=0,i=t.length;i>s;s++)o(e,t[s],n);return n}function S(e,t,n,s,o){for(var a,r=[],i=0,c=e.length,l=t!=null;c>i;i++)(a=e[i])&&(n&&!n(a,s,o)||(r.push(a),l&&t.push(i)));return r}function I(e,t,n,s,o,i){return s&&!s[a]&&(s=I(s)),o&&!o[a]&&(o=I(o,i)),c(function(i,a,r,c){var d,u,h,p=[],f=[],g=a.length,v=i||be(t||"*",r.nodeType?[r]:r,[]),m=!e||!i&&t?v:S(v,p,e,r,c),l=n?o||(i?e:g||s)?[]:a:m;if(n&&n(m,l,r,c),s)for(u=S(l,f),s(u,[],r,c),d=u.length;d--;)(h=u[d])&&(l[f[d]]=!(m[f[d]]=h));if(i){if(o||e){if(o){for(u=[],d=l.length;d--;)(h=l[d])&&u.push(m[d]=h);o(null,l=[],u,c)}for(d=l.length;d--;)(h=l[d])&&(u=o?y(i,h):p[d])>-1&&(i[u]=!(a[u]=h))}}else l=S(l===a?l.splice(g,l.length):l),o?o(null,a,l,c):b.apply(a,l)})}function H(e){for(var s,o,r,c=e.length,l=t.relative[e[0].type],d=l||t.relative[" "],n=l?1:0,u=V(function(e){return e===r},d,!0),h=V(function(e){return y(r,e)>-1},d,!0),i=[function(e,t,n){var s=!l&&(n||t!==N)||((r=t).nodeType?u(e,t,n):h(e,t,n));return r=null,s}];c>n;n++)if(o=t.relative[e[n].type])i=[V(B(i),o)];else{if(o=t.filter[e[n].type].apply(null,e[n].matches),o[a]){for(s=++n;c>s;s++)if(t.relative[e[s].type])break;return I(n>1&&B(i),n>1&&D(e.slice(0,n-1).concat({value:" "===e[n-2].type?"*":""})).replace(T,"$1"),o,s>n&&H(e.slice(n,s)),c>s&&H(e=e.slice(s)),c>s&&D(e))}i.push(o)}return B(i)}function we(e,s){var i=s.length>0,a=e.length>0,r=function(r,c,l,d,h){var f,j,_,y=0,p="0",w=r&&[],g=[],O=N,x=r||a&&t.find.TAG("*",h),C=m+=O==null?1:Math.random()||.1,E=x.length;for(h&&(N=c===n||c||h);p!==E&&null!=(f=x[p]);p++){if(a&&f){for(_=0,c||f.ownerDocument===n||(v(f),l=!u);j=e[_++];)if(j(f,c||n,l)){d.push(f);break}h&&(m=C)}i&&((f=!j&&f)&&y--,r&&w.push(f))}if(y+=p,i&&p!==y){for(_=0;j=s[_++];)j(w,g,c,l);if(r){if(y>0)for(;p--;)w[p]||g[p]||(g[p]=ae.call(d));g=S(g)}b.apply(d,g),h&&!r&&g.length>0&&y+s.length>1&&o.uniqueSort(d)}return h&&(m=C,N=O),w};return i?c(r):r}return $=o.compile=function(e,t){var s,o=[],i=[],n=z[e+" "];if(!n){for(t||(t=A(e)),s=t.length;s--;)n=H(t[s]),n[a]?o.push(n):i.push(n);n=z(e,we(i,o)),n.selector=e}return n},ne=o.select=function(e,n,s,o){var a,r,c,h,m,d="function"==typeof e&&e,l=!o&&A(e=d.selector||e);if(s=s||[],1===l.length){if(a=l[0]=l[0].slice(0),a.length>2&&"ID"===(r=a[0]).type&&i.getById&&9===n.nodeType&&u&&t.relative[a[1].type]){if(n=(t.find.ID(r.matches[0].replace(p,f),n)||[])[0],!n)return s;d&&(n=n.parentNode),e=e.slice(a.shift().value.length)}for(c=F.needsContext.test(e)?0:a.length;c--;){if(r=a[c],t.relative[h=r.type])break;if((m=t.find[h])&&(o=m(r.matches[0].replace(p,f),P.test(a[0].type)&&W(n.parentNode)||n))){if(a.splice(c,1),e=o.length&&D(a),!e)return b.apply(s,o),s;break}}}return(d||$(e,l))(o,n,!u,s,!n||P.test(e)&&W(n.parentNode)||n),s},i.sortStable=a.split("").sort(Y).join("")===a,i.detectDuplicates=!!x,v(),i.sortDetached=h(function(e){return 1&e.compareDocumentPosition(n.createElement("div"))}),h(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||U("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),i.attributes&&h(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||U("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),h(function(e){return null==e.getAttribute("disabled")})||U(q,function(e,t,n){var s;return n?void 0:e[t]===!0?t.toLowerCase():(s=e.getAttributeNode(t))&&s.specified?s.value:null}),o}(e),n.find=j,n.expr=j.selectors,n.expr[":"]=n.expr.pseudos,n.uniqueSort=n.unique=j.uniqueSort,n.text=j.getText,n.isXMLDoc=j.isXML,n.contains=j.contains;var w=function(e,t,s){for(var o=[],i=void 0!==s;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&n(e).is(s))break;o.push(e)}return o},$e=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Ne=n.expr.match.needsContext,ze=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,dn=/^.[^:#[.,]*$/;function oe(e,t,s){if(n.isFunction(t))return n.grep(e,function(e,n){return!!t.call(e,n,e)!==s});if(t.nodeType)return n.grep(e,function(e){return e===t!==s});if("string"==typeof t){if(dn.test(t))return n.filter(t,e,s);t=n.filter(t,e)}return n.grep(e,function(e){return n.inArray(e,t)>-1!==s})}n.filter=function(e,t,s){var o=t[0];return s&&(e=":not("+e+")"),1===t.length&&1===o.nodeType?n.find.matchesSelector(o,e)?[o]:[]:n.find.matches(e,n.grep(t,function(e){return 1===e.nodeType}))},n.fn.extend({find:function(e){var t,s=[],o=this,i=o.length;if("string"!=typeof e)return this.pushStack(n(e).filter(function(){for(t=0;i>t;t++)if(n.contains(o[t],this))return!0}));for(t=0;i>t;t++)n.find(e,o[t],s);return s=this.pushStack(i>1?n.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(e){return this.pushStack(oe(this,e||[],!1))},not:function(e){return this.pushStack(oe(this,e||[],!0))},is:function(e){return!!oe(this,"string"==typeof e&&Ne.test(e)?n(e):e||[],!1).length}}),Be=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Ke=n.fn.init=function(e,t,s){var i,a;if(!e)return this;if(s=s||se,"string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:Be.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||s).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof n?t[0]:t,n.merge(this,n.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),ze.test(i[1])&&n.isPlainObject(t))for(i in t)n.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return se.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):n.isFunction(e)?"undefined"!=typeof s.ready?s.ready(e):e(n):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),n.makeArray(e,this))},Ke.prototype=n.fn,se=n(o),qe=/^(?:parents|prev(?:Until|All))/,gt={children:!0,contents:!0,next:!0,prev:!0},n.fn.extend({has:function(e){var t,s=n(e,this),o=s.length;return this.filter(function(){for(t=0;o>t;t++)if(n.contains(this,s[t]))return!0})},closest:function(e,t){for(var s,i=0,r=this.length,o=[],a=Ne.test(e)||"string"!=typeof e?n(e,t||this.context):0;r>i;i++)for(s=this[i];s&&s!==t;s=s.parentNode)if(s.nodeType<11&&(a?a.index(s)>-1:1===s.nodeType&&n.find.matchesSelector(s,e))){o.push(s);break}return this.pushStack(o.length>1?n.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?n.inArray(this[0],n(e)):n.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(n.uniqueSort(n.merge(this.get(),n(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function wt(e,t){do e=e[t];while(e&&1!==e.nodeType)return e}n.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return w(e,"parentNode")},parentsUntil:function(e,t,n){return w(e,"parentNode",n)},next:function(e){return wt(e,"nextSibling")},prev:function(e){return wt(e,"previousSibling")},nextAll:function(e){return w(e,"nextSibling")},prevAll:function(e){return w(e,"previousSibling")},nextUntil:function(e,t,n){return w(e,"nextSibling",n)},prevUntil:function(e,t,n){return w(e,"previousSibling",n)},siblings:function(e){return $e((e.parentNode||{}).firstChild,e)},children:function(e){return $e(e.firstChild)},contents:function(e){return n.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:n.merge([],e.childNodes)}},function(e,t){n.fn[e]=function(s,o){var i=n.map(this,t,s);return"Until"!==e.slice(-5)&&(o=s),o&&"string"==typeof o&&(i=n.filter(o,i)),this.length>1&&(gt[e]||(i=n.uniqueSort(i)),qe.test(e)&&(i=i.reverse())),this.pushStack(i)}}),c=/\S+/g;function $t(e){var t={};return n.each(e.match(c)||[],function(e,n){t[n]=!0}),t}n.Callbacks=function(e){e="string"==typeof e?$t(e):n.extend({},e);var s,i,a,l,t=[],r=[],o=-1,d=function(){for(i=e.once,l=a=!0;r.length;o=-1)for(s=r.shift();++o<t.length;)t[o].apply(s[0],s[1])===!1&&e.stopOnFalse&&(o=t.length,s=!1);e.memory||(s=!1),a=!1,i&&(t=s?[]:"")},c={add:function(){return t&&(s&&!a&&(o=t.length-1,r.push(s)),function s(o){n.each(o,function(o,i){n.isFunction(i)?e.unique&&c.has(i)||t.push(i):i&&i.length&&"string"!==n.type(i)&&s(i)})}(arguments),s&&!a&&d()),this},remove:function(){return n.each(arguments,function(e,s){for(var i;(i=n.inArray(s,t,i))>-1;)t.splice(i,1),o>=i&&o--}),this},has:function(e){return e?n.inArray(e,t)>-1:t.length>0},empty:function(){return t&&(t=[]),this},disable:function(){return i=r=[],t=s="",this},disabled:function(){return!t},lock:function(){return i=!0,s||c.disable(),this},locked:function(){return!!i},fireWith:function(e,t){return i||(t=t||[],t=[e,t.slice?t.slice():t],r.push(t),a||d()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!l}};return c},n.extend({Deferred:function(e){var o=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return t.done(arguments).fail(arguments),this},then:function(){var e=arguments;return n.Deferred(function(i){n.each(o,function(o,a){var r=n.isFunction(e[o])&&e[o];t[a[1]](function(){var e=r&&r.apply(this,arguments);e&&n.isFunction(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[a[0]+"With"](this===s?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?n.extend(e,s):s}},t={};return s.pipe=s.then,n.each(o,function(e,n){var a=n[2],r=n[3];s[n[1]]=a.add,r&&a.add(function(){i=r},o[1^e][2].disable,o[2][2].lock),t[n[0]]=function(){return t[n[0]+"With"](this===t?s:this,arguments),this},t[n[0]+"With"]=a.fireWith}),s.promise(t),e&&e.call(t,t),t},when:function(e){var r,c,d,t=0,o=p.call(arguments),s=o.length,a=1!==s||e&&n.isFunction(e.promise)?s:0,i=1===a?e:n.Deferred(),l=function(e,t,n){return function(s){t[e]=this,n[e]=arguments.length>1?p.call(arguments):s,n===r?i.notifyWith(t,n):--a||i.resolveWith(t,n)}};if(s>1)for(r=new Array(s),d=new Array(s),c=new Array(s);s>t;t++)o[t]&&n.isFunction(o[t].promise)?o[t].promise().progress(l(t,d,r)).done(l(t,c,o)).fail(i.reject):--a;return a||i.resolveWith(c,o),i.promise()}}),n.fn.ready=function(e){return n.ready.promise().done(e),this},n.extend({isReady:!1,readyWait:1,holdReady:function(e){e?n.readyWait++:n.ready(!0)},ready:function(e){(e===!0?--n.readyWait:n.isReady)||(n.isReady=!0,e!==!0&&--n.readyWait>0||(D.resolveWith(o,[n]),n.fn.triggerHandler&&(n(o).triggerHandler("ready"),n(o).off("ready"))))}});function xt(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",m),e.removeEventListener("load",m)):(o.detachEvent("onreadystatechange",m),e.detachEvent("onload",m))}function m(){(o.addEventListener||"load"===e.event.type||"complete"===o.readyState)&&(xt(),n.ready())}n.ready.promise=function(t){if(!D)if(D=n.Deferred(),"complete"===o.readyState||"loading"!==o.readyState&&!o.documentElement.doScroll)e.setTimeout(n.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",m),e.addEventListener("load",m);else{o.attachEvent("onreadystatechange",m),e.attachEvent("onload",m);var s=!1;try{s=null==e.frameElement&&o.documentElement}catch{}s&&s.doScroll&&!function t(){if(!n.isReady){try{s.doScroll("left")}catch{return e.setTimeout(t,50)}xt(),n.ready()}}()}return D.promise(t)},n.ready.promise();for(jt in n(s))break;s.ownFirst="0"===jt,s.inlineBlockNeedsLayout=!1,n(function(){var e,n,i,t=o.getElementsByTagName("body")[0];t&&t.style&&(e=o.createElement("div"),n=o.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(n).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",s.inlineBlockNeedsLayout=i=3===e.offsetWidth,i&&(t.style.zoom=1)),t.removeChild(n))}),function(){var e=o.createElement("div");s.deleteExpando=!0;try{delete e.test}catch{s.deleteExpando=!1}e=null}();var M=function(e){var t=n.noData[(e.nodeName+" ").toLowerCase()],s=+e.nodeType||1;return(1===s||9===s)&&(!t||t!==!0&&e.getAttribute("classid")===t)},pn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,fn=/([A-Z])/g;function at(e,t,s){if(void 0===s&&1===e.nodeType){var o="data-"+t.replace(fn,"-$1").toLowerCase();if(s=e.getAttribute(o),"string"==typeof s){try{s="true"===s||"false"!==s&&("null"===s?null:+s+""===s?+s:pn.test(s)?n.parseJSON(s):s)}catch{}n.data(e,t,s)}else s=void 0}return s}function J(e){var t;for(t in e)if(("data"!==t||!n.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function Xe(e,t,s,o){if(M(e)){var a,c,l=n.expando,u=e.nodeType,r=u?n.cache:e,i=u?e[l]:e[l]&&l;if(i&&r[i]&&(o||r[i].data)||void 0!==s||"string"!=typeof t)return i||(i=u?e[l]=d.pop()||n.guid++:l),r[i]||(r[i]=u?{}:{toJSON:n.noop}),"object"!=typeof t&&"function"!=typeof t||(o?r[i]=n.extend(r[i],t):r[i].data=n.extend(r[i].data,t)),a=r[i],o||(a.data||(a.data={}),a=a.data),void 0!==s&&(a[n.camelCase(t)]=s),"string"==typeof t?(c=a[t],c==null&&(c=a[n.camelCase(t)])):c=a,c}}function Ge(e,t,o){if(M(e)){var r,c,l=e.nodeType,i=l?n.cache:e,a=l?e[n.expando]:n.expando;if(i[a]){if(t&&(r=o?i[a]:i[a].data)){for(n.isArray(t)?t=t.concat(n.map(t,n.camelCase)):(t in r)?t=[t]:(t=n.camelCase(t),t=t in r?[t]:t.split(" ")),c=t.length;c--;)delete r[t[c]];if(o?!J(r):!n.isEmptyObject(r))return}(o||(delete i[a].data,J(i[a])))&&(l?n.cleanData([e],!0):s.deleteExpando||i!=i.window?delete i[a]:i[a]=void 0)}}}n.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?n.cache[e[n.expando]]:e[n.expando],!!e&&!J(e)},data:function(e,t,n){return Xe(e,t,n)},removeData:function(e,t){return Ge(e,t)},_data:function(e,t,n){return Xe(e,t,n,!0)},_removeData:function(e,t){return Ge(e,t,!0)}}),n.fn.extend({data:function(e,t){var o,i,a,s=this[0],r=s&&s.attributes;if(void 0===e){if(this.length&&(a=n.data(s),1===s.nodeType&&!n._data(s,"parsedAttrs"))){for(i=r.length;i--;)r[i]&&(o=r[i].name,0===o.indexOf("data-")&&(o=n.camelCase(o.slice(5)),at(s,o,a[o])));n._data(s,"parsedAttrs",!0)}return a}return"object"==typeof e?this.each(function(){n.data(this,e)}):arguments.length>1?this.each(function(){n.data(this,e,t)}):s?at(s,e,n.data(s,e)):void 0},removeData:function(e){return this.each(function(){n.removeData(this,e)})}}),n.extend({queue:function(e,t,s){var o;return e?(t=(t||"fx")+"queue",o=n._data(e,t),s&&(!o||n.isArray(s)?o=n._data(e,t,n.makeArray(s)):o.push(s)),o||[]):void 0},dequeue:function(e,t){t=t||"fx";var s=n.queue(e,t),a=s.length,o=s.shift(),i=n._queueHooks(e,t),r=function(){n.dequeue(e,t)};"inprogress"===o&&(o=s.shift(),a--),o&&("fx"===t&&s.unshift("inprogress"),delete i.stop,o.call(e,r,i)),!a&&i&&i.empty.fire()},_queueHooks:function(e,t){var s=t+"queueHooks";return n._data(e,s)||n._data(e,s,{empty:n.Callbacks("once memory").add(function(){n._removeData(e,t+"queue"),n._removeData(e,s)})})}}),n.fn.extend({queue:function(e,t){var s=2;return"string"!=typeof e&&(t=e,e="fx",s--),arguments.length<s?n.queue(this[0],e):void 0===t?this:this.each(function(){var s=n.queue(this,e,t);n._queueHooks(this,e),"fx"===e&&"inprogress"!==s[0]&&n.dequeue(this,e)})},dequeue:function(e){return this.each(function(){n.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var s,i=1,a=n.Deferred(),o=this,r=this.length,c=function(){--i||a.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)s=n._data(o[r],e+"queueHooks"),s&&s.empty&&(i++,s.empty.add(c));return c(),a.promise(t)}}),function(){var e;s.shrinkWrapBlocks=function(){if(e!=null)return e;e=!1;var t,n,s;return n=o.getElementsByTagName("body")[0],n&&n.style?(t=o.createElement("div"),s=o.createElement("div"),s.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(s).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(o.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(s),e):void 0}}();var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,K=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),b=["Top","Right","Bottom","Left"],S=function(e,t){return e=t||e,"none"===n.css(e,"display")||!n.contains(e.ownerDocument,e)};function We(e,t,s,o){var l,a=1,u=20,d=o?function(){return o.cur()}:function(){return n.css(e,t,"")},c=d(),r=s&&s[3]||(n.cssNumber[t]?"":"px"),i=(n.cssNumber[t]||"px"!==r&&+c)&&K.exec(n.css(e,t));if(i&&i[3]!==r){r=r||i[3],s=s||[],i=+c||1;do a=a||".5",i/=a,n.style(e,t,i+r);while(a!==(a=d()/c)&&1!==a&&--u)}return s&&(i=+i||+c||0,l=s[1]?i+(s[1]+1)*s[2]:+s[2],o&&(o.unit=r,o.start=i,o.end=l)),l}var h=function(e,t,s,o,i,a,r){var c=0,d=e.length,l=s==null;if("object"===n.type(s)){i=!0;for(c in s)h(e,t,c,s[c],!0,a,r)}else if(void 0!==o&&(i=!0,n.isFunction(o)||(r=!0),l&&(r?(t.call(e,o),t=null):(l=t,t=function(e,t,s){return l.call(n(e),s)})),t))for(;d>c;c++)t(e[c],s,r?o:o.call(e[c],c,t(e[c],s)));return i?e:l?t.call(e):d?t(e[0],s):a},$=/^(?:checkbox|radio)$/i,Ie=/<([\w:-]+)/,Pe=/^$|\/(?:java|ecma)script/i,ee=/^\s+/,Le="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function Se(e){var n=Le.split("|"),t=e.createDocumentFragment();if(t.createElement)for(;n.length;)t.createElement(n.pop());return t}!function(){var e=o.createElement("div"),i=o.createDocumentFragment(),t=o.createElement("input");e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",s.leadingWhitespace=3===e.firstChild.nodeType,s.tbody=!e.getElementsByTagName("tbody").length,s.htmlSerialize=!!e.getElementsByTagName("link").length,s.html5Clone="<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,t.type="checkbox",t.checked=!0,i.appendChild(t),s.appendChecked=t.checked,e.innerHTML="<textarea>x</textarea>",s.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,i.appendChild(e),t=o.createElement("input"),t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),s.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,s.noCloneEvent=!!e.addEventListener,e[n.expando]=1,s.attributes=!e.getAttribute(n.expando)}(),r={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:s.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},r.optgroup=r.option,r.tbody=r.tfoot=r.colgroup=r.caption=r.thead,r.th=r.td;function i(e,t){var o,a,r=0,s="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!s)for(s=[],a=e.childNodes||e;null!=(o=a[r]);r++)!t||n.nodeName(o,t)?s.push(o):n.merge(s,i(o,t));return void 0===t||t&&n.nodeName(e,t)?n.merge([e],s):s}function ie(e,t){for(var o,s=0;null!=(o=e[s]);s++)n._data(o,"globalEval",!t||n._data(t[s],"globalEval"))}ke=/<|&#?\w+;/,re=/<tbody/i;function mn(e){$.test(e.type)&&(e.defaultChecked=e.checked)}function xe(e,t,o,a,c){for(var l,d,u,m,g,v,b,j=e.length,f=Se(t),h=[],p=0;j>p;p++)if(l=e[p],l||0===l)if("object"===n.type(l))n.merge(h,l.nodeType?[l]:l);else if(ke.test(l)){for(d=d||f.appendChild(t.createElement("div")),g=(Ie.exec(l)||["",""])[1].toLowerCase(),m=r[g]||r._default,d.innerHTML=m[1]+n.htmlPrefilter(l)+m[2],u=m[0];u--;)d=d.lastChild;if(!s.leadingWhitespace&&ee.test(l)&&h.push(t.createTextNode(ee.exec(l)[0])),!s.tbody)for(l="table"!==g||re.test(l)?"<table>"!==m[1]||re.test(l)?0:d:d.firstChild,u=l&&l.childNodes.length;u--;)n.nodeName(v=l.childNodes[u],"tbody")&&!v.childNodes.length&&l.removeChild(v);for(n.merge(h,d.childNodes),d.textContent="";d.firstChild;)d.removeChild(d.firstChild);d=f.lastChild}else h.push(t.createTextNode(l));for(d&&f.removeChild(d),s.appendChecked||n.grep(i(h,"input"),mn),p=0;l=h[p++];)if(a&&n.inArray(l,a)>-1)c&&c.push(l);else if(b=n.contains(l.ownerDocument,l),d=i(f.appendChild(l),"script"),b&&ie(d),o)for(u=0;l=d[u++];)Pe.test(l.type||"")&&o.push(l);return d=null,f}!function(){var t,n,i=o.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(s[t]=n in e)||(i.setAttribute(n,"t"),s[t]=i.attributes[n].expando===!1);i=null}();var de=/^(?:input|select|textarea)$/i,hn=/^key/,un=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,_e=/^([^.]*)(?:\.(.+)|)/;function L(){return!0}function x(){return!1}function Ye(){try{return o.activeElement}catch{}}function Q(e,t,s,o,i,a){var r,c;if("object"==typeof t){"string"!=typeof s&&(o=o||s,s=void 0);for(c in t)Q(e,c,s,o,t[c],a);return e}if(o==null&&i==null?(i=s,o=s=void 0):i==null&&("string"==typeof s?(i=o,o=void 0):(i=o,o=s,s=void 0)),i===!1)i=x;else if(!i)return e;return 1===a&&(r=i,i=function(e){return n().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=n.guid++)),e.each(function(){n.event.add(this,t,i,o,s)})}n.event={global:{},add:function(e,t,s,o,i){var a,r,l,d,u,m,f,p,g,v,b,h=n._data(e);if(h){for(s.handler&&(f=s,s=f.handler,i=f.selector),s.guid||(s.guid=n.guid++),(m=h.events)||(m=h.events={}),(l=h.handle)||(l=h.handle=function(e){return"undefined"==typeof n||e&&n.event.triggered===e.type?void 0:n.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(c)||[""],g=t.length;g--;)p=_e.exec(t[g])||[],a=b=p[1],v=(p[2]||"").split(".").sort(),a&&(r=n.event.special[a]||{},a=(i?r.delegateType:r.bindType)||a,r=n.event.special[a]||{},d=n.extend({type:a,origType:b,data:o,handler:s,guid:s.guid,selector:i,needsContext:i&&n.expr.match.needsContext.test(i),namespace:v.join(".")},f),(u=m[a])||(u=m[a]=[],u.delegateCount=0,r.setup&&r.setup.call(e,o,v,l)!==!1||(e.addEventListener?e.addEventListener(a,l,!1):e.attachEvent&&e.attachEvent("on"+a,l))),r.add&&(r.add.call(e,d),d.handler.guid||(d.handler.guid=s.guid)),i?u.splice(u.delegateCount++,0,d):u.push(d),n.event.global[a]=!0);e=null}},remove:function(e,t,s,o,i){var a,r,l,d,u,h,f,p,g,v,b,m=n.hasData(e)&&n._data(e);if(m&&(h=m.events)){for(t=(t||"").match(c)||[""],p=t.length;p--;)if(l=_e.exec(t[p])||[],a=b=l[1],g=(l[2]||"").split(".").sort(),a){for(d=n.event.special[a]||{},a=(o?d.delegateType:d.bindType)||a,u=h[a]||[],l=l[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),v=f=u.length;f--;)r=u[f],!i&&b!==r.origType||s&&s.guid!==r.guid||l&&!l.test(r.namespace)||o&&o!==r.selector&&("**"!==o||!r.selector)||(u.splice(f,1),r.selector&&u.delegateCount--,d.remove&&d.remove.call(e,r));v&&!u.length&&(d.teardown&&d.teardown.call(e,g,m.handle)!==!1||n.removeEvent(e,a,m.handle),delete h[a])}else for(a in h)n.event.remove(e,a+t[p],s,o,!0);n.isEmptyObject(h)&&(delete m.handle,n._removeData(e,"events"))}},trigger:function(t,s,i,a){var r,l,d,u,h,p,g,f=[i||o],c=O.call(t,"type")?t.type:t,m=O.call(t,"namespace")?t.namespace.split("."):[];if(r=l=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!Oe.test(c+n.event.triggered)&&(c.indexOf(".")>-1&&(m=c.split("."),c=m.shift(),m.sort()),h=c.indexOf(":")<0&&"on"+c,t=t[n.expando]?t:new n.Event(c,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),s=s==null?[t]:n.makeArray(s,[t]),d=n.event.special[c]||{},a||!d.trigger||d.trigger.apply(i,s)!==!1)){if(!a&&!d.noBubble&&!n.isWindow(i)){for(p=d.delegateType||c,Oe.test(p+c)||(r=r.parentNode);r;r=r.parentNode)f.push(r),l=r;l===(i.ownerDocument||o)&&f.push(l.defaultView||l.parentWindow||e)}for(g=0;(r=f[g++])&&!t.isPropagationStopped();)t.type=g>1?p:d.bindType||c,u=(n._data(r,"events")||{})[t.type]&&n._data(r,"handle"),u&&u.apply(r,s),u=h&&r[h],u&&u.apply&&M(r)&&(t.result=u.apply(r,s),t.result===!1&&t.preventDefault());if(t.type=c,!a&&!t.isDefaultPrevented()&&(!d._default||d._default.apply(f.pop(),s)===!1)&&M(i)&&h&&i[c]&&!n.isWindow(i)){l=i[h],l&&(i[h]=null),n.event.triggered=c;try{i[c]()}catch{}n.event.triggered=void 0,l&&(i[h]=l)}return t.result}},dispatch:function(e){e=n.event.fix(e);var t,s,i,a,r,c=[],l=p.call(arguments),d=(n._data(this,"events")||{})[e.type]||[],o=n.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!o.preDispatch||o.preDispatch.call(this,e)!==!1){for(c=n.event.handlers.call(this,e,d),a=0;(s=c[a++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,r=0;(t=s.handlers[r++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(t.namespace)||(e.handleObj=t,e.data=t.data,i=((n.event.special[t.origType]||{}).handle||t.handler).apply(s.elem,l),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return o.postDispatch&&o.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,i,a,r,l=[],c=t.delegateCount,s=e.target;if(c&&s.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;s!=this;s=s.parentNode||this)if(1===s.nodeType&&(s.disabled!==!0||"click"!==e.type)){for(o=[],a=0;c>a;a++)r=t[a],i=r.selector+" ",void 0===o[i]&&(o[i]=r.needsContext?n(i,this).index(s)>-1:n.find(i,this,null,[s]).length),o[i]&&o.push(r);o.length&&l.push({elem:s,handlers:o})}return c<t.length&&l.push({elem:this,handlers:t.slice(c)}),l},fix:function(e){if(e[n.expando])return e;var a,r,c,s=e.type,i=e,t=this.fixHooks[s];for(t||(this.fixHooks[s]=t=un.test(s)?this.mouseHooks:hn.test(s)?this.keyHooks:{}),c=t.props?this.props.concat(t.props):this.props,e=new n.Event(i),a=c.length;a--;)r=c[a],e[r]=i[r];return e.target||(e.target=i.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,t.filter?t.filter(e,i):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,s,a,i=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(a=e.target.ownerDocument||o,s=a.documentElement,n=a.body,e.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===i||(e.which=1&i?1:2&i?3:4&i?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Ye()&&this.focus)try{return this.focus(),!1}catch{}},delegateType:"focusin"},blur:{trigger:function(){return this===Ye()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return n.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return n.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,s){var o=n.extend(new n.Event,s,{type:e,isSimulated:!0});n.event.trigger(o,null,t),o.isDefaultPrevented()&&s.preventDefault()}},n.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var s="on"+t;e.detachEvent&&("undefined"==typeof e[s]&&(e[s]=null),e.detachEvent(s,n))},n.Event=function(e,t){return this instanceof n.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?L:x):this.type=e,t&&n.extend(this,t),this.timeStamp=e&&e.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(e,t)},n.Event.prototype={constructor:n.Event,isDefaultPrevented:x,isPropagationStopped:x,isImmediatePropagationStopped:x,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=L,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=L,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=L,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){n.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,i=this,s=e.relatedTarget,a=e.handleObj;return s&&(s===i||n.contains(i,s))||(e.type=a.origType,o=a.handler.apply(this,arguments),e.type=t),o}}}),s.submit||(n.event.special.submit={setup:function(){return!n.nodeName(this,"form")&&void n.event.add(this,"click._submit keypress._submit",function(e){var s=e.target,t=n.nodeName(s,"input")||n.nodeName(s,"button")?n.prop(s,"form"):void 0;t&&!n._data(t,"submit")&&(n.event.add(t,"submit._submit",function(e){e._submitBubble=!0}),n._data(t,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&n.event.simulate("submit",this.parentNode,e))},teardown:function(){return!n.nodeName(this,"form")&&void n.event.remove(this,"._submit")}}),s.change||(n.event.special.change={setup:function(){return de.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(n.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),n.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),n.event.simulate("change",this,e)})),!1):void n.event.add(this,"beforeactivate._change",function(e){var t=e.target;de.test(t.nodeName)&&!n._data(t,"change")&&(n.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||n.event.simulate("change",this.parentNode,e)}),n._data(t,"change",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,"._change"),!de.test(this.nodeName)}}),s.focusin||n.each({focus:"focusin",blur:"focusout"},function(e,t){var s=function(e){n.event.simulate(t,e.target,n.event.fix(e))};n.event.special[t]={setup:function(){var o=this.ownerDocument||this,i=n._data(o,t);i||o.addEventListener(e,s,!0),n._data(o,t,(i||0)+1)},teardown:function(){var o=this.ownerDocument||this,i=n._data(o,t)-1;i?n._data(o,t,i):(o.removeEventListener(e,s,!0),n._removeData(o,t))}}}),n.fn.extend({on:function(e,t,n,s){return Q(this,e,t,n,s)},one:function(e,t,n,s){return Q(this,e,t,n,s,1)},off:function(e,t,s){var o,i;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,n(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return t!==!1&&"function"!=typeof t||(s=t,t=void 0),s===!1&&(s=x),this.each(function(){n.event.remove(this,e,s,t)})},trigger:function(e,t){return this.each(function(){n.event.trigger(e,t,this)})},triggerHandler:function(e,t){var s=this[0];return s?n.event.trigger(e,t,s,!0):void 0}});var ln=/ jQuery\d+="(?:null|\d+)"/g,ye=new RegExp("<(?:"+Le+")[\\s/>]","i"),cn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,rn=/<script|<style|<link/i,an=/checked\s*(?:[^=]|=\s*.checked.)/i,sn=/^true\/(.*)/,en=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,qt=Se(o),ae=qt.appendChild(o.createElement("div"));function Ae(e,t){return n.nodeName(e,"table")&&n.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ve(e){return e.type=(null!==n.find.attr(e,"type"))+"/"+e.type,e}function Me(e){var t=sn.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Fe(e,t){if(1===t.nodeType&&n.hasData(e)){var o,i,r,c=n._data(e),s=n._data(t,c),a=c.events;if(a){delete s.handle,s.events={};for(o in a)for(i=0,r=a[o].length;r>i;i++)n.event.add(t,o,a[o][i])}s.data&&(s.data=n.extend({},s.data))}}function Kt(e,t){var o,i,a;if(1===t.nodeType){if(o=t.nodeName.toLowerCase(),!s.noCloneEvent&&t[n.expando]){i=n._data(t);for(a in i.events)n.removeEvent(t,a,i.handle);t.removeAttribute(n.expando)}"script"===o&&t.text!==e.text?(ve(t).text=e.text,Me(t)):"object"===o?(t.parentNode&&(t.outerHTML=e.outerHTML),s.html5Clone&&e.innerHTML&&!n.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===o&&$.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===o?t.defaultSelected=t.selected=e.defaultSelected:"input"!==o&&"textarea"!==o||(t.defaultValue=e.defaultValue)}}function g(e,t,o,a){t=we.apply([],t);var r,l,d,u,h,p,c=0,m=e.length,b=m-1,f=t[0],v=n.isFunction(f);if(v||m>1&&"string"==typeof f&&!s.checkClone&&an.test(f))return e.each(function(n){var s=e.eq(n);v&&(t[0]=f.call(this,n,s.html())),g(s,t,o,a)});if(m&&(d=xe(t,e[0].ownerDocument,!1,e,a),u=d.firstChild,1===d.childNodes.length&&(d=u),u||a)){for(l=n.map(i(d,"script"),ve),h=l.length;m>c;c++)r=d,c!==b&&(r=n.clone(r,!0,!0),h&&n.merge(l,i(r,"script"))),o.call(e[c],r,c);if(h)for(p=l[l.length-1].ownerDocument,n.map(l,Me),c=0;h>c;c++)r=l[c],Pe.test(r.type||"")&&!n._data(r,"globalEval")&&n.contains(p,r)&&(r.src?n._evalUrl&&n._evalUrl(r.src):n.globalEval((r.text||r.textContent||r.innerHTML||"").replace(en,"")));d=u=null}return e}function De(e,t,s){for(var o,r=t?n.filter(t,e):e,a=0;null!=(o=r[a]);a++)s||1!==o.nodeType||n.cleanData(i(o)),o.parentNode&&(s&&n.contains(o.ownerDocument,o)&&ie(i(o,"script")),o.parentNode.removeChild(o));return e}n.extend({htmlPrefilter:function(e){return e.replace(cn,"<$1></$2>")},clone:function(e,t,o){var a,r,c,l,d,u=n.contains(e.ownerDocument,e);if(s.html5Clone||n.isXMLDoc(e)||!ye.test("<"+e.nodeName+">")?c=e.cloneNode(!0):(ae.innerHTML=e.outerHTML,ae.removeChild(c=ae.firstChild)),!(s.noCloneEvent&&s.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||n.isXMLDoc(e)))for(a=i(c),l=i(e),r=0;null!=(d=l[r]);++r)a[r]&&Kt(d,a[r]);if(t)if(o)for(l=l||i(e),a=a||i(c),r=0;null!=(d=l[r]);r++)Fe(d,a[r]);else Fe(e,c);return a=i(c,"script"),a.length>0&&ie(a,!u&&i(e,"script")),a=l=d=null,c},cleanData:function(e,t){for(var o,i,a,r,u=0,c=n.expando,l=n.cache,h=s.attributes,m=n.event.special;null!=(o=e[u]);u++)if((t||M(o))&&(i=o[c],r=i&&l[i])){if(r.events)for(a in r.events)m[a]?n.event.remove(o,a):n.removeEvent(o,a,r.handle);l[i]&&(delete l[i],h||"undefined"==typeof o.removeAttribute?o[c]=void 0:o.removeAttribute(c),d.push(i))}}}),n.fn.extend({domManip:g,detach:function(e){return De(this,e,!0)},remove:function(e){return De(this,e)},text:function(e){return h(this,function(e){return void 0===e?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return g(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ae(this,e);t.appendChild(e)}})},prepend:function(){return g(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ae(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return g(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return g(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&n.cleanData(i(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&n.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=e??!1,t=t??e,this.map(function(){return n.clone(this,e,t)})},html:function(e){return h(this,function(e){var t=this[0]||{},o=0,a=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(ln,""):void 0;if("string"==typeof e&&!rn.test(e)&&(s.htmlSerialize||!ye.test(e))&&(s.leadingWhitespace||!ee.test(e))&&!r[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=n.htmlPrefilter(e);try{for(;a>o;o++)t=this[o]||{},1===t.nodeType&&(n.cleanData(i(t,!1)),t.innerHTML=e);t=0}catch{}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return g(this,arguments,function(t){var s=this.parentNode;n.inArray(this,e)<0&&(n.cleanData(i(this)),s&&s.replaceChild(t,this))},e)}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){n.fn[e]=function(e){for(var o,s=0,i=[],a=n(e),r=a.length-1;r>=s;s++)o=s===r?this:this.clone(!0),n(a[s])[t](o),ne.apply(i,o.get());return this.pushStack(i)}}),te={HTML:"block",BODY:"block"};function Re(e,t){var s=n(t.createElement(e)).appendTo(t.body),o=n.css(s[0],"display");return s.detach(),o}function V(e){var s=o,t=te[e];return t||(t=Re(e,s),"none"!==t&&t||(A=(A||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(s.documentElement),s=(A[0].contentWindow||A[0].contentDocument).document,s.write(),s.close(),t=Re(e,s),A.detach()),te[e]=t),t}var He=/^margin/,z=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),X=function(e,t,n,s){var o,i,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,s||[]);for(o in t)e.style[o]=a[o];return i},Ve=o.documentElement;!function(){var i,a,l,d,u,h,c=o.createElement("div"),t=o.createElement("div");if(t.style){t.style.cssText="float:left;opacity:.5",s.opacity="0.5"===t.style.opacity,s.cssFloat=!!t.style.cssFloat,t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",s.clearCloneStyle="content-box"===t.style.backgroundClip,c=o.createElement("div"),c.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",t.innerHTML="",c.appendChild(t),s.boxSizing=""===t.style.boxSizing||""===t.style.MozBoxSizing||""===t.style.WebkitBoxSizing,n.extend(s,{reliableHiddenOffsets:function(){return i==null&&r(),a},boxSizingReliable:function(){return i==null&&r(),d},pixelMarginRight:function(){return i==null&&r(),l},pixelPosition:function(){return i==null&&r(),i},reliableMarginRight:function(){return i==null&&r(),u},reliableMarginLeft:function(){return i==null&&r(),h}});function r(){var n,s,r=o.documentElement;r.appendChild(c),t.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i=d=h=!1,l=u=!0,e.getComputedStyle&&(s=e.getComputedStyle(t),i="1%"!==(s||{}).top,h="2px"===(s||{}).marginLeft,d="4px"===(s||{width:"4px"}).width,t.style.marginRight="50%",l="4px"===(s||{marginRight:"4px"}).marginRight,n=t.appendChild(o.createElement("div")),n.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",t.style.width="1px",u=!parseFloat((e.getComputedStyle(n)||{}).marginRight),t.removeChild(n)),t.style.display="none",a=0===t.getClientRects().length,a&&(t.style.display="",t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t.childNodes[0].style.borderCollapse="separate",n=t.getElementsByTagName("td"),n[0].style.cssText="margin:0;border:0;padding:0;display:none",a=0===n[0].offsetHeight,a&&(n[0].style.display="",n[1].style.display="none",a=0===n[0].offsetHeight)),r.removeChild(c)}}}(),Ue=/^(top|right|bottom|left)$/,e.getComputedStyle?(_=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},f=function(e,t,o){var i,r,c,l,a=e.style;return o=o||_(e),i=o?o.getPropertyValue(t)||o[t]:void 0,""!==i&&void 0!==i||n.contains(e.ownerDocument,e)||(i=n.style(e,t)),o&&!s.pixelMarginRight()&&z.test(i)&&He.test(t)&&(r=a.width,c=a.minWidth,l=a.maxWidth,a.minWidth=a.maxWidth=a.width=i,i=o.width,a.width=r,a.minWidth=c,a.maxWidth=l),void 0===i?i:i+""}):Ve.currentStyle&&(_=function(e){return e.currentStyle},f=function(e,t,n){var s,i,a,r,o=e.style;return n=n||_(e),s=n?n[t]:void 0,s==null&&o&&o[t]&&(s=o[t]),z.test(s)&&!Ue.test(t)&&(r=o.left,i=e.runtimeStyle,a=i&&i.left,a&&(i.left=e.currentStyle.left),o.left="fontSize"===t?"1em":s,s=o.pixelLeft+"px",o.left=r,a&&(i.left=a)),void 0===s?s:s+""||"auto"});function Y(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}var q=/alpha\([^)]*\)/i,Ut=/opacity\s*=\s*([^)]*)/i,Wt=/^(none|table(?!-c[ea]).+)/,kt=new RegExp("^("+U+")(.*)$","i"),Vt={position:"absolute",visibility:"hidden",display:"block"},Ze={letterSpacing:"0",fontWeight:"400"},Je=["Webkit","O","Moz","ms"],et=o.createElement("div").style;function tt(e){if(e in et)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),t=Je.length;t--;)if(e=Je[t]+n,e in et)return e}function nt(e,t){for(var s,i,r,a=[],o=0,c=e.length;c>o;o++)s=e[o],s.style&&(a[o]=n._data(s,"olddisplay"),i=s.style.display,t?(a[o]||"none"!==i||(s.style.display=""),""===s.style.display&&S(s)&&(a[o]=n._data(s,"olddisplay",V(s.nodeName)))):(r=S(s),(i&&"none"!==i||!r)&&n._data(s,"olddisplay",r?i:n.css(s,"display"))));for(o=0;c>o;o++)s=e[o],s.style&&(t&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=t?a[o]||"":"none"));return e}function st(e,t,n){var s=kt.exec(t);return s?Math.max(0,s[1]-(n||0))+(s[2]||"px"):t}function ot(e,t,s,o,i){for(var a=s===(o?"border":"content")?4:"width"===t?1:0,r=0;4>a;a+=2)"margin"===s&&(r+=n.css(e,s+b[a],!0,i)),o?("content"===s&&(r-=n.css(e,"padding"+b[a],!0,i)),"margin"!==s&&(r-=n.css(e,"border"+b[a]+"Width",!0,i))):(r+=n.css(e,"padding"+b[a],!0,i),"padding"!==s&&(r+=n.css(e,"border"+b[a]+"Width",!0,i)));return r}function it(e,t,o){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,a=_(e),c=s.boxSizing&&"border-box"===n.css(e,"boxSizing",!1,a);if(0>=i||i==null){if(i=f(e,t,a),(0>i||i==null)&&(i=e.style[t]),z.test(i))return i;r=c&&(s.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+ot(e,t,o||(c?"border":"content"),r,a)+"px"}n.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=f(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:s.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,o,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,r,l,c=n.camelCase(t),d=e.style;if(t=n.cssProps[c]||(n.cssProps[c]=tt(c)||c),r=n.cssHooks[t]||n.cssHooks[c],void 0===o)return r&&"get"in r&&void 0!==(a=r.get(e,!1,i))?a:d[t];if(l=typeof o,"string"===l&&(a=K.exec(o))&&a[1]&&(o=We(e,t,a),l="number"),o!=null&&o===o&&("number"===l&&(o+=a&&a[3]||(n.cssNumber[c]?"":"px")),s.clearCloneStyle||""!==o||0!==t.indexOf("background")||(d[t]="inherit"),!(r&&"set"in r&&void 0===(o=r.set(e,o,i)))))try{d[t]=o}catch{}}},css:function(e,t,s,o){var i,r,c,a=n.camelCase(t);return t=n.cssProps[a]||(n.cssProps[a]=tt(a)||a),r=n.cssHooks[t]||n.cssHooks[a],r&&"get"in r&&(i=r.get(e,!0,s)),void 0===i&&(i=f(e,t,o)),"normal"===i&&t in Ze&&(i=Ze[t]),""===s||s?(c=parseFloat(i),s===!0||isFinite(c)?c||0:i):i}}),n.each(["height","width"],function(e,t){n.cssHooks[t]={get:function(e,s,o){return s?Wt.test(n.css(e,"display"))&&0===e.offsetWidth?X(e,Vt,function(){return it(e,t,o)}):it(e,t,o):void 0},set:function(e,o,i){var a=i&&_(e);return st(e,o,i?ot(e,t,i,s.boxSizing&&"border-box"===n.css(e,"boxSizing",!1,a),a):0)}}}),s.opacity||(n.cssHooks.opacity={get:function(e,t){return Ut.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var s=e.style,o=e.currentStyle,a=n.isNumeric(t)?"alpha(opacity="+100*t+")":"",i=o&&o.filter||s.filter||"";s.zoom=1,(t>=1||""===t)&&""===n.trim(i.replace(q,""))&&s.removeAttribute&&(s.removeAttribute("filter"),""===t||o&&!o.filter)||(s.filter=q.test(i)?i.replace(q,a):i+" "+a)}}),n.cssHooks.marginRight=Y(s.reliableMarginRight,function(e,t){return t?X(e,{display:"inline-block"},f,[e,"marginRight"]):void 0}),n.cssHooks.marginLeft=Y(s.reliableMarginLeft,function(e,t){return t?(parseFloat(f(e,"marginLeft"))||(n.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-X(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px":void 0}),n.each({margin:"",padding:"",border:"Width"},function(e,t){n.cssHooks[e+t]={expand:function(n){for(var s=0,i={},o="string"==typeof n?n.split(" "):[n];4>s;s++)i[e+b[s]+t]=o[s]||o[s-2]||o[0];return i}},He.test(e)||(n.cssHooks[e+t].set=st)}),n.fn.extend({css:function(e,t){return h(this,function(e,t,s){var i,a,r={},o=0;if(n.isArray(t)){for(i=_(e),a=t.length;a>o;o++)r[t[o]]=n.css(e,t[o],!1,i);return r}return void 0!==s?n.style(e,t,s):n.css(e,t)},e,t,arguments.length>1)},show:function(){return nt(this,!0)},hide:function(){return nt(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function a(e,t,n,s,o){return new a.prototype.init(e,t,n,s,o)}n.Tween=a,a.prototype={constructor:a,init:function(e,t,s,o,i,a){this.elem=e,this.prop=s,this.easing=i||n.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=o,this.unit=a||(n.cssNumber[s]?"":"px")},cur:function(){var e=a.propHooks[this.prop];return e&&e.get?e.get(this):a.propHooks._default.get(this)},run:function(e){var t,s=a.propHooks[this.prop];return this.options.duration?this.pos=t=n.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),s&&s.set?s.set(this):a.propHooks._default.set(this),this}},a.prototype.init.prototype=a.prototype,a.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=n.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){n.fx.step[e.prop]?n.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[n.cssProps[e.prop]]&&!n.cssHooks[e.prop]?e.elem[e.prop]=e.now:n.style(e.elem,e.prop,e.now+e.unit)}}},a.propHooks.scrollTop=a.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},n.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},n.fx=a.prototype.init,n.fx.step={},lt=/^(?:toggle|show|hide)$/,dt=/queueHooks$/;function ut(){return e.setTimeout(function(){C=void 0}),C=n.now()}function H(e,t){var s,n={height:e},o=0;for(t=t?1:0;4>o;o+=2-t)s=b[o],n["margin"+s]=n["padding"+s]=e;return t&&(n.opacity=n.width=e),n}function mt(e,t,n){for(var o,i=(l.tweeners[t]||[]).concat(l.tweeners["*"]),s=0,a=i.length;a>s;s++)if(o=i[s].call(n,t,e))return o}function Ht(e,t,o){var i,c,d,h,f,p,g,v,u=this,m={},r=e.style,l=e.nodeType&&S(e),a=n._data(e,"fxshow");o.queue||(c=n._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,v=c.empty.fire,c.empty.fire=function(){c.unqueued||v()}),c.unqueued++,u.always(function(){u.always(function(){c.unqueued--,n.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(o.overflow=[r.overflow,r.overflowX,r.overflowY],d=n.css(e,"display"),g="none"===d?n._data(e,"olddisplay")||V(e.nodeName):d,"inline"===g&&"none"===n.css(e,"float")&&(s.inlineBlockNeedsLayout&&"inline"!==V(e.nodeName)?r.zoom=1:r.display="inline-block")),o.overflow&&(r.overflow="hidden",s.shrinkWrapBlocks()||u.always(function(){r.overflow=o.overflow[0],r.overflowX=o.overflow[1],r.overflowY=o.overflow[2]}));for(i in t)if(f=t[i],lt.exec(f)){if(delete t[i],p=p||"toggle"===f,f===(l?"hide":"show")){if("show"!==f||!a||void 0===a[i])continue;l=!0}m[i]=a&&a[i]||n.style(e,i)}else d=void 0;if(n.isEmptyObject(m))"inline"===("none"===d?V(e.nodeName):d)&&(r.display=d);else{a?"hidden"in a&&(l=a.hidden):a=n._data(e,"fxshow",{}),p&&(a.hidden=!l),l?n(e).show():u.done(function(){n(e).hide()}),u.done(function(){var t;n._removeData(e,"fxshow");for(t in m)n.style(e,t,m[t])});for(i in m)h=mt(l?a[i]:0,i,u),i in a||(a[i]=h.start,l&&(h.end=h.start,h.start="width"===i||"height"===i?1:0))}}function Dt(e,t){var s,o,i,a,r;for(s in e)if(i=n.camelCase(s),a=t[i],o=e[s],n.isArray(o)&&(a=o[1],o=e[s]=o[0]),s!==i&&(e[i]=o,delete e[s]),r=n.cssHooks[i],r&&"expand"in r){o=r.expand(o),delete e[i];for(s in o)s in e||(e[s]=o[s],t[s]=a)}else t[i]=a}function l(e,t,s){var a,r,c=0,h=l.prefilters.length,i=n.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var c=C||ut(),t=Math.max(0,o.startTime+o.duration-c),l=t/o.duration||0,n=1-l,s=0,a=o.tweens.length;a>s;s++)o.tweens[s].run(n);return i.notifyWith(e,[o,n,t]),1>n&&a?t:(i.resolveWith(e,[o]),!1)},o=i.promise({elem:e,props:n.extend({},t),opts:n.extend(!0,{specialEasing:{},easing:n.easing._default},s),originalProperties:t,originalOptions:s,startTime:C||ut(),duration:s.duration,tweens:[],createTween:function(t,s){var i=n.Tween(e,o.opts,t,s,o.opts.specialEasing[t]||o.opts.easing);return o.tweens.push(i),i},stop:function(t){var n=0,s=t?o.tweens.length:0;if(r)return this;for(r=!0;s>n;n++)o.tweens[n].run(1);return t?(i.notifyWith(e,[o,1,0]),i.resolveWith(e,[o,t])):i.rejectWith(e,[o,t]),this}}),d=o.props;for(Dt(d,o.opts.specialEasing);h>c;c++)if(a=l.prefilters[c].call(o,e,d,o.opts))return n.isFunction(a.stop)&&(n._queueHooks(o.elem,o.opts.queue).stop=n.proxy(a.stop,a)),a;return n.map(d,mt,o),n.isFunction(o.opts.start)&&o.opts.start.call(e,o),n.fx.timer(n.extend(u,{elem:e,anim:o,queue:o.opts.queue})),o.progress(o.opts.progress).done(o.opts.done,o.opts.complete).fail(o.opts.fail).always(o.opts.always)}n.Animation=n.extend(l,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return We(n.elem,e,K.exec(t),n),n}]},tweener:function(e,t){n.isFunction(e)?(t=e,e=["*"]):e=e.match(c);for(var s,o=0,i=e.length;i>o;o++)s=e[o],l.tweeners[s]=l.tweeners[s]||[],l.tweeners[s].unshift(t)},prefilters:[Ht],prefilter:function(e,t){t?l.prefilters.unshift(e):l.prefilters.push(e)}}),n.speed=function(e,t,s){var o=e&&"object"==typeof e?n.extend({},e):{complete:s||!s&&t||n.isFunction(e)&&e,duration:e,easing:s&&t||t&&!n.isFunction(t)&&t};return o.duration=n.fx.off?0:"number"==typeof o.duration?o.duration:o.duration in n.fx.speeds?n.fx.speeds[o.duration]:n.fx.speeds._default,null!=o.queue&&o.queue!==!0||(o.queue="fx"),o.old=o.complete,o.complete=function(){n.isFunction(o.old)&&o.old.call(this),o.queue&&n.dequeue(this,o.queue)},o},n.fn.extend({fadeTo:function(e,t,n,s){return this.filter(S).css("opacity",0).show().end().animate({opacity:t},e,n,s)},animate:function(e,t,s,o){var r=n.isEmptyObject(e),a=n.speed(t,s,o),i=function(){var t=l(this,n.extend({},e),a);(r||n._data(this,"finish"))&&t.stop(!0)};return i.finish=i,r||a.queue===!1?this.each(i):this.queue(a.queue,i)},stop:function(e,t,s){var o=function(e){var t=e.stop;delete e.stop,t(s)};return"string"!=typeof e&&(s=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var r=!0,t=e!=null&&e+"queueHooks",a=n.timers,i=n._data(this);if(t)i[t]&&i[t].stop&&o(i[t]);else for(t in i)i[t]&&i[t].stop&&dt.test(t)&&o(i[t]);for(t=a.length;t--;)a[t].elem!==this||e!=null&&a[t].queue!==e||(a[t].anim.stop(s),r=!1,a.splice(t,1));!r&&s||n.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=n._data(this),s=i[e+"queue"],a=i[e+"queueHooks"],o=n.timers,r=s?s.length:0;for(i.finish=!0,n.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;r>t;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish})}}),n.each(["toggle","show","hide"],function(e,t){var s=n.fn[t];n.fn[t]=function(e,n,o){return e==null||"boolean"==typeof e?s.apply(this,arguments):this.animate(H(t,!0),e,n,o)}}),n.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){n.fn[e]=function(e,n,s){return this.animate(t,e,n,s)}}),n.timers=[],n.fx.tick=function(){var s,e=n.timers,t=0;for(C=n.now();t<e.length;t++)s=e[t],s()||e[t]!==s||e.splice(t--,1);e.length||n.fx.stop(),C=void 0},n.fx.timer=function(e){n.timers.push(e),e()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){I||(I=e.setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){e.clearInterval(I),I=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(t,s){return t=n.fx?n.fx.speeds[t]||t:t,s=s||"fx",this.queue(s,function(n,s){var o=e.setTimeout(n,t);s.stop=function(){e.clearTimeout(o)}})},function(){var n,e=o.createElement("input"),t=o.createElement("div"),i=o.createElement("select"),a=i.appendChild(o.createElement("option")),t=o.createElement("div");t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=t.getElementsByTagName("a")[0],e.setAttribute("type","checkbox"),t.appendChild(e),n=t.getElementsByTagName("a")[0],n.style.cssText="top:1px",s.getSetAttribute="t"!==t.className,s.style=/top/.test(n.getAttribute("style")),s.hrefNormalized="/a"===n.getAttribute("href"),s.checkOn=!!e.value,s.optSelected=a.selected,s.enctype=!!o.createElement("form").enctype,i.disabled=!0,s.optDisabled=!a.disabled,e=o.createElement("input"),e.setAttribute("value",""),s.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),s.radioValue="t"===e.value}(),vt=/\r/g,bt=/[\x20\t\r\n\f]+/g,n.fn.extend({val:function(e){var t,s,i,o=this[0];{if(arguments.length)return i=n.isFunction(e),this.each(function(s){var o;1===this.nodeType&&(o=i?e.call(this,s,n(this).val()):e,o==null?o="":"number"==typeof o?o+="":n.isArray(o)&&(o=n.map(o,function(e){return e==null?"":e+""})),t=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return t=n.valHooks[o.type]||n.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(s=t.get(o,"value"))?s:(s=o.value,"string"==typeof s?s.replace(vt,""):s??"")}}}),n.extend({valHooks:{option:{get:function(e){var t=n.find.attr(e,"value");return t??n.trim(n.text(e)).replace(bt," ")}},select:{get:function(e){for(var t,r,c=e.options,o=e.selectedIndex,i="select-one"===e.type||0>o,l=i?null:[],d=i?o+1:c.length,a=0>o?d:i?o:0;d>a;a++)if(t=c[a],(t.selected||a===o)&&(s.optDisabled?!t.disabled:null===t.getAttribute("disabled"))&&(!t.parentNode.disabled||!n.nodeName(t.parentNode,"optgroup"))){if(r=n(t).val(),i)return r;l.push(r)}return l},set:function(e,t){for(var s,i,o=e.options,r=n.makeArray(t),a=o.length;a--;)if(s=o[a],n.inArray(n.valHooks.option.get(s),r)>-1)try{s.selected=i=!0}catch{s.scrollHeight}else s.selected=!1;return i||(e.selectedIndex=-1),o}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(e,t){return n.isArray(t)?e.checked=n.inArray(n(e).val(),t)>-1:void 0}},s.checkOn||(n.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var k,yt,u=n.expr.attrHandle,pe=/^(?:checked|selected)$/i,v=s.getSetAttribute,T=s.input;n.fn.extend({attr:function(e,t){return h(this,n.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){n.removeAttr(this,e)})}}),n.extend({attr:function(e,t,s){var o,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return"undefined"==typeof e.getAttribute?n.prop(e,t,s):(1===a&&n.isXMLDoc(e)||(t=t.toLowerCase(),i=n.attrHooks[t]||(n.expr.match.bool.test(t)?yt:k)),void 0!==s?null===s?void n.removeAttr(e,t):i&&"set"in i&&void 0!==(o=i.set(e,s,t))?o:(e.setAttribute(t,s+""),s):i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=n.find.attr(e,t),o??void 0))},attrHooks:{type:{set:function(e,t){if(!s.radioValue&&"radio"===t&&n.nodeName(e,"input")){var o=e.value;return e.setAttribute("type",t),o&&(e.value=o),t}}}},removeAttr:function(e,t){var s,o,a=0,i=t&&t.match(c);if(i&&1===e.nodeType)for(;s=i[a++];)o=n.propFix[s]||s,n.expr.match.bool.test(s)?T&&v||!pe.test(s)?e[o]=!1:e[n.camelCase("default-"+s)]=e[o]=!1:n.attr(e,s,""),e.removeAttribute(v?s:o)}}),yt={set:function(e,t,s){return t===!1?n.removeAttr(e,s):T&&v||!pe.test(s)?e.setAttribute(!v&&n.propFix[s]||s,s):e[n.camelCase("default-"+s)]=e[s]=!0,s}},n.each(n.expr.match.bool.source.match(/\w+/g),function(e,t){var s=u[t]||n.find.attr;T&&v||!pe.test(t)?u[t]=function(e,t,n){var o,i;return n||(i=u[t],u[t]=o,o=null!=s(e,t,n)?t.toLowerCase():null,u[t]=i),o}:u[t]=function(e,t,s){return s?void 0:e[n.camelCase("default-"+t)]?t.toLowerCase():null}}),T&&v||(n.attrHooks.value={set:function(e,t,s){return n.nodeName(e,"input")?void(e.defaultValue=t):k&&k.set(e,t,s)}}),v||(k={set:function(e,t,n){var s=e.getAttributeNode(n);return s||e.setAttributeNode(s=e.ownerDocument.createAttribute(n)),s.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},u.id=u.name=u.coords=function(e,t,n){var s;return n?void 0:(s=e.getAttributeNode(t))&&""!==s.value?s.value:null},n.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:k.set},n.attrHooks.contenteditable={set:function(e,t,n){k.set(e,""!==t&&t,n)}},n.each(["width","height"],function(e,t){n.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),s.style||(n.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}}),Ct=/^(?:input|select|textarea|button|object)$/i,Et=/^(?:a|area)$/i,n.fn.extend({prop:function(e,t){return h(this,n.prop,e,t,arguments.length>1)},removeProp:function(e){return e=n.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch{}})}}),n.extend({prop:function(e,t,s){var o,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&n.isXMLDoc(e)||(t=n.propFix[t]||t,o=n.propHooks[t]),void 0!==s?o&&"set"in o&&void 0!==(i=o.set(e,s,t))?i:e[t]=s:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=n.find.attr(e,"tabindex");return t?parseInt(t,10):Ct.test(e.nodeName)||Et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),s.hrefNormalized||n.each(["href","src"],function(e,t){n.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),s.optSelected||(n.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this}),s.enctype||(n.propFix.enctype="encoding"),B=/[\t\r\n\f]/g;function y(e){return n.attr(e,"class")||""}n.fn.extend({addClass:function(e){var t,s,o,i,a,r,l,d=0;if(n.isFunction(e))return this.each(function(t){n(this).addClass(e.call(this,t,y(this)))});if("string"==typeof e&&e)for(r=e.match(c)||[];t=this[d++];)if(o=y(t),s=1===t.nodeType&&(" "+o+" ").replace(B," ")){for(l=0;i=r[l++];)s.indexOf(" "+i+" ")<0&&(s+=i+" ");a=n.trim(s),o!==a&&n.attr(t,"class",a)}return this},removeClass:function(e){var t,s,o,i,a,r,l,d=0;if(n.isFunction(e))return this.each(function(t){n(this).removeClass(e.call(this,t,y(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(r=e.match(c)||[];s=this[d++];)if(o=y(s),t=1===s.nodeType&&(" "+o+" ").replace(B," ")){for(l=0;i=r[l++];)for(;t.indexOf(" "+i+" ")>-1;)t=t.replace(" "+i+" "," ");a=n.trim(t),o!==a&&n.attr(s,"class",a)}return this},toggleClass:function(e,t){var s=typeof e;return"boolean"==typeof t&&"string"===s?t?this.addClass(e):this.removeClass(e):n.isFunction(e)?this.each(function(s){n(this).toggleClass(e.call(this,s,y(this),t),t)}):this.each(function(){if("string"===s){i=0,o=n(this),a=e.match(c)||[];for(var t,o,i,a;t=a[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t)}else void 0!==e&&"boolean"!==s||(t=y(this),t&&n._data(this,"__className__",t),n.attr(this,"class",t||e===!1?"":n._data(this,"__className__")||""))})},hasClass:function(e){for(var t,s=0,n=" "+e+" ";t=this[s++];)if(1===t.nodeType&&(" "+y(t)+" ").replace(B," ").indexOf(n)>-1)return!0;return!1}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){n.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),n.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var St=e.location,me=n.now(),he=/\?/,Tt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;n.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var i,s=null,o=n.trim(t+"");return o&&!n.trim(o.replace(Tt,function(e,t,n,o){return i&&t&&(s=0),0===s?e:(i=n||t,s+=!o-!n,"")}))?Function("return "+o)():n.error("Invalid JSON: "+t)},n.parseXML=function(t){var s,o;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(o=new e.DOMParser,s=o.parseFromString(t,"text/xml")):(s=new e.ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(t))}catch{s=void 0}return s&&s.documentElement&&!s.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+t),s};var zt=/#.*$/,pt=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Lt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Rt=/^(?:GET|HEAD)$/,Pt=/^\/\//,ft=/^([\w.+-]+:)(?:\/\/(?:[^/?#]*@|)([^/?#:]*)(?::(\d+)|)|)/,rt={},W={},Qe="*/".concat("*"),Z=St.href,E=ft.exec(Z.toLowerCase())||[];function be(e){return function(t,s){"string"!=typeof t&&(s=t,t="*");var o,i=0,a=t.toLowerCase().match(c)||[];if(n.isFunction(s))for(;o=a[i++];)"+"===o.charAt(0)?(o=o.slice(1)||"*",(e[o]=e[o]||[]).unshift(s)):(e[o]=e[o]||[]).push(s)}}function Te(e,t,s,o){var i={},r=e===W;function a(c){var l;return i[c]=!0,n.each(e[c]||[],function(e,n){var c=n(t,s,o);return"string"!=typeof c||r||i[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}return a(t.dataTypes[0])||!i["*"]&&a("*")}function ce(e,t){var s,o,i=n.ajaxSettings.flatOptions||{};for(s in t)void 0!==t[s]&&((i[s]?e:o||(o={}))[s]=t[s]);return o&&n.extend(!0,e,o),e}function Yt(e,t,n){for(var o,i,a,r,c=e.contents,s=e.dataTypes;"*"===s[0];)s.shift(),void 0===a&&(a=e.mimeType||t.getResponseHeader("Content-Type"));if(a)for(i in c)if(c[i]&&c[i].test(a)){s.unshift(i);break}if(s[0]in n)o=s[0];else{for(i in n){if(!s[0]||e.converters[i+" "+s[0]]){o=i;break}r||(r=i)}o=o||r}return o?(o!==s[0]&&s.unshift(o),n[o]):void 0}function Gt(e,t,n,s){var o,i,a,c,l,r={},d=e.dataTypes.slice();if(d[1])for(i in e.converters)r[i.toLowerCase()]=e.converters[i];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!a&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=o,o=d.shift())if("*"===o)o=a;else if("*"!==a&&a!==o){if(i=r[a+" "+o]||r["* "+o],!i)for(l in r)if(c=l.split(" "),c[1]===o&&(i=r[a+" "+c[0]]||r["* "+c[0]])){i===!0?i=r[l]:r[l]!==!0&&(o=c[0],d.unshift(c[1]));break}if(i!==!0)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+a+" to "+o}}}return{state:"success",data:t}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Z,type:"GET",isLocal:Lt.test(E[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Qe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ce(ce(e,n.ajaxSettings),t):ce(n.ajaxSettings,e)},ajaxPrefilter:be(rt),ajaxTransport:be(W),ajax:function(t,s){"object"==typeof t&&(s=t,t=void 0),s=s||{};var a,d,u,h,m,g,j,y,o=n.ajaxSetup({},s),l=o.context||o,v=o.context&&(l.nodeType||l.jquery)?n(l):n.event,b=n.Deferred(),_=n.Callbacks("once memory"),f=o.statusCode||{},w={},O={},r=0,x="canceled",i={readyState:0,getResponseHeader:function(e){if(2===r){if(!g){g={};for(var t;t=Nt.exec(y);)g[t[1].toLowerCase()]=t[2]}t=g[e.toLowerCase()]}return t??null},getAllResponseHeaders:function(){return 2===r?y:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return r||(e=O[n]=O[n]||e,w[e]=t),this},overrideMimeType:function(e){return r||(o.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>r)for(t in e)f[t]=[f[t],e[t]];else i.always(e[i.status]);return this},abort:function(e){var t=e||x;return m&&m.abort(t),p(0,t),this}};if(b.promise(i).complete=_.add,i.success=i.done,i.error=i.fail,o.url=((t||o.url||Z)+"").replace(zt,"").replace(Pt,E[1]+"//"),o.type=s.method||s.type||o.method||o.type,o.dataTypes=n.trim(o.dataType||"*").toLowerCase().match(c)||[""],null==o.crossDomain&&(u=ft.exec(o.url.toLowerCase()),o.crossDomain=!(!u||u[1]===E[1]&&u[2]===E[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(E[3]||("http:"===E[1]?"80":"443")))),o.data&&o.processData&&"string"!=typeof o.data&&(o.data=n.param(o.data,o.traditional)),Te(rt,o,s,i),2===r)return i;h=n.event&&o.global,h&&0===n.active++&&n.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Rt.test(o.type),a=o.url,o.hasContent||(o.data&&(a=o.url+=(he.test(a)?"&":"?")+o.data,delete o.data),o.cache===!1&&(o.url=pt.test(a)?a.replace(pt,"$1_="+me++):a+(he.test(a)?"&":"?")+"_="+me++)),o.ifModified&&(n.lastModified[a]&&i.setRequestHeader("If-Modified-Since",n.lastModified[a]),n.etag[a]&&i.setRequestHeader("If-None-Match",n.etag[a])),(o.data&&o.hasContent&&o.contentType!==!1||s.contentType)&&i.setRequestHeader("Content-Type",o.contentType),i.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Qe+"; q=0.01":""):o.accepts["*"]);for(d in o.headers)i.setRequestHeader(d,o.headers[d]);if(o.beforeSend&&(o.beforeSend.call(l,i,o)===!1||2===r))return i.abort();x="abort";for(d in{success:1,error:1,complete:1})i[d](o[d]);if(m=Te(W,o,s,i)){if(i.readyState=1,h&&v.trigger("ajaxSend",[i,o]),2===r)return i;o.async&&o.timeout>0&&(j=e.setTimeout(function(){i.abort("timeout")},o.timeout));try{r=1,m.send(w,p)}catch(e){if(!(2>r))throw e;p(-1,e)}}else p(-1,"No Transport");function p(t,s,c,d){var p,g,w,O,x,u=s;2!==r&&(r=2,j&&e.clearTimeout(j),m=void 0,y=d||"",i.readyState=t>0?4:0,p=t>=200&&300>t||304===t,c&&(g=Yt(o,i,c)),g=Gt(o,g,i,p),p?(o.ifModified&&(w=i.getResponseHeader("Last-Modified"),w&&(n.lastModified[a]=w),w=i.getResponseHeader("etag"),w&&(n.etag[a]=w)),204===t||"HEAD"===o.type?u="nocontent":304===t?u="notmodified":(u=g.state,x=g.data,O=g.error,p=!O)):(O=u,!t&&u||(u="error",0>t&&(t=0))),i.status=t,i.statusText=(s||u)+"",p?b.resolveWith(l,[x,u,i]):b.rejectWith(l,[i,u,O]),i.statusCode(f),f=void 0,h&&v.trigger(p?"ajaxSuccess":"ajaxError",[i,o,p?x:O]),_.fireWith(l,[i,u]),h&&(v.trigger("ajaxComplete",[i,o]),--n.active||n.event.trigger("ajaxStop")))}return i},getJSON:function(e,t,s){return n.get(e,t,s,"json")},getScript:function(e,t){return n.get(e,void 0,t,"script")}}),n.each(["get","post"],function(e,t){n[t]=function(e,s,o,i){return n.isFunction(s)&&(i=i||o,o=s,s=void 0),n.ajax(n.extend({url:e,type:t,dataType:i,data:s,success:o},n.isPlainObject(e)&&e))}}),n._evalUrl=function(e){return n.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(e){if(n.isFunction(e))return this.each(function(t){n(this).wrapAll(e.call(this,t))});if(this[0]){var t=n(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return n.isFunction(e)?this.each(function(t){n(this).wrapInner(e.call(this,t))}):this.each(function(){var t=n(this),s=t.contents();s.length?s.wrapAll(e):t.append(e)})},wrap:function(e){var t=n.isFunction(e);return this.each(function(s){n(this).wrapAll(t?e.call(this,s):e)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}});function Xt(e){return e.style&&e.style.display||n.css(e,"display")}function Qt(e){if(!n.contains(e.ownerDocument||o,e))return!0;for(;e&&1===e.nodeType;){if("none"===Xt(e)||"hidden"===e.type)return!0;e=e.parentNode}return!1}n.expr.filters.hidden=function(e){return s.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:Qt(e)},n.expr.filters.visible=function(e){return!n.expr.filters.hidden(e)};var Zt=/%20/g,Jt=/\[\]$/,Ce=/\r?\n/g,tn=/^(?:submit|button|image|reset|file)$/i,nn=/^(?:input|select|textarea|keygen)/i;function le(e,t,s,o){var i;if(n.isArray(t))n.each(t,function(t,n){s||Jt.test(e)?o(e,n):le(e+"["+("object"==typeof n&&n!=null?t:"")+"]",n,s,o)});else if(s||"object"!==n.type(t))o(e,t);else for(i in t)le(e+"["+i+"]",t[i],s,o)}n.param=function(e,t){var s,o=[],i=function(e,t){t=n.isFunction(t)?t():t??"",o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(e)||e.jquery&&!n.isPlainObject(e))n.each(e,function(){i(this.name,this.value)});else for(s in e)le(s,e[s],t,i);return o.join("&").replace(Zt,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=n.prop(this,"elements");return e?n.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!n(this).is(":disabled")&&nn.test(this.nodeName)&&!tn.test(e)&&(this.checked||!$.test(e))}).map(function(e,t){var s=n(this).val();return s==null?null:n.isArray(s)?n.map(s,function(e){return{name:t.name,value:e.replace(Ce,`
`)}}):{name:t.name,value:s.replace(Ce,`
`)}}).get()}}),n.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return this.isLocal?je():o.documentMode>8?fe():/^(get|post|head|put|delete|options)$/i.test(this.type)&&fe()||je()}:fe;var on=0,R={},F=n.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in R)R[e](void 0,!0)}),s.cors=!!F&&"withCredentials"in F,F=s.ajax=!!F,F&&n.ajaxTransport(function(t){if(!t.crossDomain||s.cors){var o;return{send:function(s,i){var r,a=t.xhr(),c=++on;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");for(r in s)void 0!==s[r]&&a.setRequestHeader(r,s[r]+"");a.send(t.hasContent&&t.data||null),o=function(e,s){var r,l,d;if(o&&(s||4===a.readyState))if(delete R[c],o=void 0,a.onreadystatechange=n.noop,s)4!==a.readyState&&a.abort();else{l={},r=a.status,"string"==typeof a.responseText&&(l.text=a.responseText);try{d=a.statusText}catch{d=""}r||!t.isLocal||t.crossDomain?1223===r&&(r=204):r=l.text?200:404}l&&i(r,d,l,a.getAllResponseHeaders())},t.async?4===a.readyState?e.setTimeout(o):a.onreadystatechange=R[c]=o:o()},abort:function(){o&&o(void 0,!0)}}}});function fe(){try{return new e.XMLHttpRequest}catch{}}function je(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch{}}n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return n.globalEval(e),e}}}),n.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),n.ajaxTransport("script",function(e){if(e.crossDomain){var t,s=o.head||n("head")[0]||o.documentElement;return{send:function(n,i){t=o.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success"))},s.insertBefore(t,s.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}}),ge=[],P=/(=)\?(?=&|$)|\?\?/,n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ge.pop()||n.expando+"_"+me++;return this[e]=!0,e}}),n.ajaxPrefilter("json jsonp",function(t,s,o){var i,a,r,c=t.jsonp!==!1&&(P.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&P.test(t.data)&&"data");return c||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=n.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,c?t[c]=t[c].replace(P,"$1"+i):t.jsonp!==!1&&(t.url+=(he.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return r||n.error(i+" was not called"),r[0]},t.dataTypes[0]="json",a=e[i],e[i]=function(){r=arguments},o.always(function(){void 0===a?n(e).removeProp(i):e[i]=a,t[i]&&(t.jsonpCallback=s.jsonpCallback,ge.push(i)),r&&n.isFunction(a)&&a(r[0]),r=a=void 0}),"script"):void 0}),n.parseHTML=function(e,t,s){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(s=t,t=!1),t=t||o;var i=ze.exec(e),a=!s&&[];return i?[t.createElement(i[1])]:(i=xe([e],t,a),a&&a.length&&n(a).remove(),n.merge([],i.childNodes))},ue=n.fn.load,n.fn.load=function(e,t,s){if("string"!=typeof e&&ue)return ue.apply(this,arguments);var o,r,c,i=this,a=e.indexOf(" ");return a>-1&&(o=n.trim(e.slice(a,e.length)),e=e.slice(0,a)),n.isFunction(t)?(s=t,t=void 0):t&&"object"==typeof t&&(r="POST"),i.length>0&&n.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){c=arguments,i.html(o?n("<div>").append(n.parseHTML(e)).find(o):e)}).always(s&&function(e,t){i.each(function(){s.apply(this,c||[e.responseText,t,e])})}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){n.fn[t]=function(e){return this.on(t,e)}}),n.expr.filters.animated=function(e){return n.grep(n.timers,function(t){return e===t.elem}).length};function Ee(e){return n.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}return n.offset={setOffset:function(e,t,s){var o,a,r,c,l,d,m,u=n.css(e,"position"),h=n(e),i={};"static"===u&&(e.style.position="relative"),o=h.offset(),c=n.css(e,"top"),d=n.css(e,"left"),m=("absolute"===u||"fixed"===u)&&n.inArray("auto",[c,d])>-1,m?(a=h.position(),l=a.top,r=a.left):(l=parseFloat(c)||0,r=parseFloat(d)||0),n.isFunction(t)&&(t=t.call(e,s,n.extend({},o))),null!=t.top&&(i.top=t.top-o.top+l),null!=t.left&&(i.left=t.left-o.left+r),"using"in t?t.using.call(e,i):h.css(i)}},n.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){n.offset.setOffset(this,e,t)});var t,i,o={top:0,left:0},s=this[0],a=s&&s.ownerDocument;if(a)return t=a.documentElement,n.contains(t,s)?("undefined"!=typeof s.getBoundingClientRect&&(o=s.getBoundingClientRect()),i=Ee(a),{top:o.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:o.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):o},position:function(){if(this[0]){var e,s,t={top:0,left:0},o=this[0];return"fixed"===n.css(o,"position")?s=o.getBoundingClientRect():(e=this.offsetParent(),s=this.offset(),n.nodeName(e[0],"html")||(t=e.offset()),t.top+=n.css(e[0],"borderTopWidth",!0),t.left+=n.css(e[0],"borderLeftWidth",!0)),{top:s.top-t.top-n.css(o,"marginTop",!0),left:s.left-t.left-n.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!n.nodeName(e,"html")&&"static"===n.css(e,"position");)e=e.offsetParent;return e||Ve})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var s=/Y/.test(t);n.fn[e]=function(o){return h(this,function(e,o,i){var a=Ee(e);return void 0===i?a?t in a?a[t]:a.document.documentElement[o]:e[o]:void(a?a.scrollTo(s?n(a).scrollLeft():i,s?i:n(a).scrollTop()):e[o]=i)},e,o,arguments.length,null)}}),n.each(["top","left"],function(e,t){n.cssHooks[t]=Y(s.pixelPosition,function(e,s){return s?(s=f(e,t),z.test(s)?n(e).position()[t]+"px":s):void 0})}),n.each({Height:"height",Width:"width"},function(e,t){n.each({padding:"inner"+e,content:t,"":"outer"+e},function(s,o){n.fn[o]=function(o,i){var a=arguments.length&&(s||"boolean"!=typeof o),r=s||(o===!0||i===!0?"margin":"border");return h(this,function(t,s,o){var i;return n.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===o?n.css(t,s,r):n.style(t,s,o,r)},t,a?o:void 0,a,null)}})}),n.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,s){return this.on(t,e,n,s)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n}),ct=e.jQuery,ht=e.$,n.noConflict=function(t){return e.$===n&&(e.$=ht),t&&e.jQuery===n&&(e.jQuery=ct),n},t||(e.jQuery=e.$=n),n}),function(e){var n=function(){function t(t,n,s){var o;this.row=t,this.tree=n,this.settings=s,this.id=this.row.data(this.settings.nodeIdAttr),o=this.row.data(this.settings.parentIdAttr),o!=null&&o!==""&&(this.parentId=o),this.treeCell=e(this.row.children(this.settings.columnElType)[this.settings.column]),this.expander=e(this.settings.expanderTemplate),this.indenter=e(this.settings.indenterTemplate),this.children=[],this.initialized=!1,this.treeCell.prepend(this.indenter)}return t.prototype.addChild=function(e){return this.children.push(e)},t.prototype.ancestors=function(){for(var e=this,t=[];e=e.parentNode();)t.push(e);return t},t.prototype.collapse=function(){return this.collapsed()?this:(this.row.removeClass("expanded").addClass("collapsed"),this._hideChildren(),this.expander.attr("title",this.settings.stringExpand),this.initialized&&this.settings.onNodeCollapse!=null&&this.settings.onNodeCollapse.apply(this),this)},t.prototype.collapsed=function(){return this.row.hasClass("collapsed")},t.prototype.expand=function(){return this.expanded()?this:(this.row.removeClass("collapsed").addClass("expanded"),this.initialized&&this.settings.onNodeExpand!=null&&this.settings.onNodeExpand.apply(this),e(this.row).is(":visible")&&this._showChildren(),this.expander.attr("title",this.settings.stringCollapse),this)},t.prototype.expanded=function(){return this.row.hasClass("expanded")},t.prototype.hide=function(){return this._hideChildren(),this.row.hide(),this},t.prototype.isBranchNode=function(){return this.children.length>0||this.row.data(this.settings.branchAttr)===!0},t.prototype.updateBranchLeafClass=function(){this.row.removeClass("branch"),this.row.removeClass("leaf"),this.row.addClass(this.isBranchNode()?"branch":"leaf")},t.prototype.level=function(){return this.ancestors().length},t.prototype.parentNode=function(){return this.parentId!=null?this.tree[this.parentId]:null},t.prototype.removeChild=function(t){var n=e.inArray(t,this.children);return this.children.splice(n,1)},t.prototype.render=function(){var n,s,t=this.settings;return t.expandable===!0&&this.isBranchNode()&&(n=function(n){return e(this).parents("table").treetable("node",e(this).parents("tr").data(t.nodeIdAttr)).toggle(),n.preventDefault()},this.indenter.html(this.expander),s=t.clickableNodeNames===!0?this.treeCell:this.expander,s.off("click.treetable").on("click.treetable",n),s.off("keydown.treetable").on("keydown.treetable",function(e){e.keyCode==13&&n.apply(this,[e])})),this.indenter[0].style.paddingLeft=""+this.level()*t.indent+"px",this},t.prototype.reveal=function(){return this.parentId!=null&&this.parentNode().reveal(),this.expand()},t.prototype.setParent=function(e){return this.parentId!=null&&this.tree[this.parentId].removeChild(this),this.parentId=e.id,this.row.data(this.settings.parentIdAttr,e.id),e.addChild(this)},t.prototype.show=function(){return this.initialized||this._initialize(),this.row.show(),this.expanded()&&this._showChildren(),this},t.prototype.toggle=function(){return this.expanded()?this.collapse():this.expand(),this},t.prototype._hideChildren=function(){var e,t,n,s=this.children,o=[];for(e=0,n=s.length;e<n;e++)t=s[e],o.push(t.hide());return o},t.prototype._initialize=function(){var e=this.settings;return this.render(),e.expandable===!0&&e.initialState==="collapsed"?this.collapse():this.expand(),e.onNodeInitialized!=null&&e.onNodeInitialized.apply(this),this.initialized=!0},t.prototype._showChildren=function(){var e,t,n,s=this.children,o=[];for(e=0,n=s.length;e<n;e++)t=s[e],o.push(t.show());return o},t}(),s=function(){function t(e,t){this.table=e,this.settings=t,this.tree={},this.nodes=[],this.roots=[]}return t.prototype.collapseAll=function(){var e,t,n,s=this.nodes,o=[];for(e=0,n=s.length;e<n;e++)t=s[e],o.push(t.collapse());return o},t.prototype.expandAll=function(){var e,t,n,s=this.nodes,o=[];for(e=0,n=s.length;e<n;e++)t=s[e],o.push(t.expand());return o},t.prototype.findLastNode=function(e){return e.children.length>0?this.findLastNode(e.children[e.children.length-1]):e},t.prototype.loadRows=function(t){var s,o,i;if(t!=null)for(o=0;o<t.length;o++)i=e(t[o]),i.data(this.settings.nodeIdAttr)!=null&&(s=new n(i,this.tree,this.settings),this.nodes.push(s),this.tree[s.id]=s,s.parentId!=null&&this.tree[s.parentId]?this.tree[s.parentId].addChild(s):this.roots.push(s));for(o=0;o<this.nodes.length;o++)s=this.nodes[o].updateBranchLeafClass();return this},t.prototype.move=function(t,n){var s=t.parentNode();return t!==n&&n.id!==t.parentId&&e.inArray(t,n.ancestors())===-1&&(t.setParent(n),this._moveRows(t,n),t.parentNode().children.length===1&&t.parentNode().render()),s&&s.updateBranchLeafClass(),t.parentNode()&&t.parentNode().updateBranchLeafClass(),t.updateBranchLeafClass(),this},t.prototype.removeNode=function(t){return this.unloadBranch(t),t.row.remove(),t.parentId!=null&&t.parentNode().removeChild(t),delete this.tree[t.id],this.nodes.splice(e.inArray(t,this.nodes),1),this},t.prototype.render=function(){var e,t,n,s=this.roots;for(e=0,n=s.length;e<n;e++)t=s[e],t.show();return this},t.prototype.sortBranch=function(e,t){return e.children.sort(t),this._sortChildRows(e),this},t.prototype.unloadBranch=function(e){var t,n=e.children.slice(0);for(t=0;t<n.length;t++)this.removeNode(n[t]);return e.children=[],e.updateBranchLeafClass(),this},t.prototype._moveRows=function(e,t){var n,s=e.children;e.row.insertAfter(t.row),e.render();for(n=s.length-1;n>=0;n--)this._moveRows(s[n],e)},t.prototype._sortChildRows=function(e){return this._moveRows(e,e)},t}(),t={init:function(t,n){var o=e.extend({branchAttr:"ttBranch",clickableNodeNames:!1,column:0,columnElType:"td",expandable:!1,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},t);return this.each(function(){var t,i=e(this);return(n||i.data("treetable")===void 0)&&(t=new s(this,o),t.loadRows(this.rows).render(),i.addClass("treetable").data("treetable",t),o.onInitialized!=null&&o.onInitialized.apply(t)),i})},destroy:function(){return this.each(function(){return e(this).removeData("treetable").removeClass("treetable")})},collapseAll:function(){return this.data("treetable").collapseAll(),this},collapseNode:function(e){var t=this.data("treetable").tree[e];if(t)t.collapse();else throw new Error("Unknown node '"+e+"'");return this},expandAll:function(){return this.data("treetable").expandAll(),this},expandNode:function(e){var t=this.data("treetable").tree[e];if(t)t.initialized||t._initialize(),t.expand();else throw new Error("Unknown node '"+e+"'");return this},loadBranch:function(t,n){var s,o=this.data("treetable").settings,i=this.data("treetable").tree;return n=e(n),t==null?this.append(n):(s=this.data("treetable").findLastNode(t),n.insertAfter(s.row)),this.data("treetable").loadRows(n),n.filter("tr").each(function(){i[e(this).data(o.nodeIdAttr)].show()}),t!=null&&t.render().expand(),this},move:function(e,t){var s=this.data("treetable").tree[e],n=this.data("treetable").tree[t];return this.data("treetable").move(s,n),this},node:function(e){return this.data("treetable").tree[e]},removeNode:function(e){var t=this.data("treetable").tree[e];if(t)this.data("treetable").removeNode(t);else throw new Error("Unknown node '"+e+"'");return this},reveal:function(e){var t=this.data("treetable").tree[e];if(t)t.reveal();else throw new Error("Unknown node '"+e+"'");return this},sortBranch:function(t,n){var s,i,o=this.data("treetable").settings;return n=n||o.column,s=n,e.isNumeric(n)&&(s=function(t,s){var o=function(t){var s=t.row.find("td:eq("+n+")").text();return e.trim(s).toUpperCase()},i=o(t),a=o(s);return i<a?-1:i>a?1:0}),this.data("treetable").sortBranch(t,s),this},unloadBranch:function(e){return this.data("treetable").unloadBranch(e),this}};e.fn.treetable=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):typeof n=="object"||!n?t.init.apply(this,arguments):e.error("Method "+n+" does not exist on jQuery.treetable")},this.TreeTable||(this.TreeTable={}),this.TreeTable.Node=n,this.TreeTable.Tree=s}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function(e){"use strict";function o(n){return this.each(function(){var s=e(this),o=s.data("bs.alert");o||s.data("bs.alert",o=new t(this)),"string"==typeof n&&o[n].call(s)})}var s,n='[data-dismiss="alert"]',t=function(t){e(t).on("click",n,this.close)};t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.prototype.close=function(n){function a(){s.detach().trigger("closed.bs.alert").remove()}var s,i=e(this),o=i.attr("data-target");o||(o=i.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),s=e("#"===o?[]:o),n&&n.preventDefault(),s.length||(s=i.closest(".alert")),s.trigger(n=e.Event("close.bs.alert")),n.isDefaultPrevented()||(s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",a).emulateTransitionEnd(t.TRANSITION_DURATION):a())},s=e.fn.alert,e.fn.alert=o,e.fn.alert.Constructor=t,e.fn.alert.noConflict=function(){return e.fn.alert=s,this},e(document).on("click.bs.alert.data-api",n,t.prototype.close)}(jQuery),+function(e){"use strict";function s(t){var s,n=t.attr("data-target");return n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),s=n&&e(n),s&&s.length?s:t.parent()}function o(t){t&&3===t.which||(e(r).remove(),e(n).each(function(){var o=e(this),n=s(o),i={relatedTarget:this};n.hasClass("open")&&(t&&"click"==t.type&&/input|textarea/i.test(t.target.tagName)&&e.contains(n[0],t.target)||(n.trigger(t=e.Event("hide.bs.dropdown",i)),t.isDefaultPrevented()||(o.attr("aria-expanded","false"),n.removeClass("open").trigger(e.Event("hidden.bs.dropdown",i)))))}))}function a(n){return this.each(function(){var s=e(this),o=s.data("bs.dropdown");o||s.data("bs.dropdown",o=new t(this)),"string"==typeof n&&o[n].call(s)})}var i,r=".dropdown-backdrop",n='[data-toggle="dropdown"]',t=function(t){e(t).on("click.bs.dropdown",this.toggle)};t.VERSION="3.3.7",t.prototype.toggle=function(t){if(n=e(this),!n.is(".disabled, :disabled")){var n,a,i=s(n),r=i.hasClass("open");if(o(),!r){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",o),a={relatedTarget:this},i.trigger(t=e.Event("show.bs.dropdown",a)),t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(e.Event("shown.bs.dropdown",a))}return!1}},t.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(a=e(this),t.preventDefault(),t.stopPropagation(),!a.is(".disabled, :disabled"))){var o,i,a,l,r=s(a),c=r.hasClass("open");if(!c&&27!=t.which||c&&27==t.which)return 27==t.which&&r.find(n).trigger("focus"),a.trigger("click");l=" li:not(.disabled):visible a",i=r.find(".dropdown-menu"+l),i.length&&(o=i.index(t.target),38==t.which&&o>0&&o--,40==t.which&&o<i.length-1&&o++,~o||(o=0),i.eq(o).trigger("focus"))}},i=e.fn.dropdown,e.fn.dropdown=a,e.fn.dropdown.Constructor=t,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=i,this},e(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,t.prototype.toggle).on("keydown.bs.dropdown.data-api",n,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown)}(jQuery),+function(e){"use strict";function n(n,s){return this.each(function(){var i=e(this),o=i.data("bs.modal"),a=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);o||i.data("bs.modal",o=new t(this,a)),"string"==typeof n?o[n](s):a.show&&o.show(s)})}var s,t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.VERSION="3.3.7",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var s=this,o=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){s.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(s.$element)&&(s.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o,i=e.support.transition&&s.$element.hasClass("fade");s.$element.parent().length||s.$element.appendTo(s.$body),s.$element.show().scrollTop(0),s.adjustDialog(),i&&s.$element[0].offsetWidth,s.$element.addClass("in"),s.enforceFocus(),o=e.Event("shown.bs.modal",{relatedTarget:n}),i?s.$dialog.one("bsTransitionEnd",function(){s.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(t.TRANSITION_DURATION):s.$element.trigger("focus").trigger(o)}))},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n),this.isShown&&!n.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var s,o,a=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){if(s=e.support.transition&&i,this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;s?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),o=function(){a.removeBackdrop(),n&&n()},e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):o()):n&&n()},t.prototype.handleUpdate=function(){this.adjustDialog()},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){var t,e=window.innerWidth;e||(t=document.documentElement.getBoundingClientRect(),e=t.right-Math.abs(t.left)),this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},t.prototype.measureScrollbar=function(){var t,e=document.createElement("div");return e.className="modal-scrollbar-measure",this.$body.append(e),t=e.offsetWidth-e.clientWidth,this.$body[0].removeChild(e),t},s=e.fn.modal,e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=s,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var s=e(this),i=s.attr("href"),o=e(s.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),a=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},o.data(),s.data());s.is("a")&&t.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){s.is(":visible")&&s.trigger("focus")})}),n.call(o,a,this)})}(jQuery),+function(e){"use strict";function s(t){var n,s=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(s)}function n(n){return this.each(function(){var o=e(this),s=o.data("bs.collapse"),i=e.extend({},t.DEFAULTS,o.data(),"object"==typeof n&&n);!s&&i.toggle&&/show|hide/.test(n)&&(i.toggle=!1),s||o.data("bs.collapse",s=new t(this,i)),"string"==typeof n&&s[n]()})}var o,t=function(n,s){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,s),this.$trigger=e('[data-toggle="collapse"][href="#'+n.id+'"],[data-toggle="collapse"][data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};t.VERSION="3.3.7",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var o,i,a,r,c,s=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(s&&s.length&&(i=s.data("bs.collapse"),i&&i.transitioning))&&(a=e.Event("show.bs.collapse"),this.$element.trigger(a),!a.isDefaultPrevented())){if(s&&s.length&&(n.call(s,"hide"),i||s.data("bs.collapse",null)),o=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")},!e.support.transition)return r.call(this);c=e.camelCase(["scroll",o].join("-")),this.$element.one("bsTransitionEnd",e.proxy(r,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][c])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var n,s,o=e.Event("hide.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented())return n=this.dimension(),this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")},e.support.transition?void this.$element[n](0).one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(t.TRANSITION_DURATION):s.call(this)}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,n){var o=e(n);this.addAriaAndCollapsedClass(s(o),o)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)},o=e.fn.collapse,e.fn.collapse=n,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=o,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){o=e(this),o.attr("data-target")||t.preventDefault();var o,i=s(o),a=i.data("bs.collapse"),r=a?"toggle":o.data();n.call(i,r)})}(jQuery),+function(e){"use strict";function t(){var t,n=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in e)if(void 0!==n.style[t])return{end:e[t]};return!1}e.fn.emulateTransitionEnd=function(t){var s,n=!1,o=this;return e(this).one("bsTransitionEnd",function(){n=!0}),s=function(){n||e(o).trigger(e.support.transition.end)},setTimeout(s,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){return e(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery);function openRuleDetailsDialog(e){var t,n=$('<button type="button" class="close btn btn-sm btn-default" data-dismiss="modal" aria-hidden="false" title="Close">&#x274c;</button>'),s=$('<div id="detail-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="false"><div id="detail-modal-body" class="modal-body"></div></div>');return $("body").prepend(s),t=$("#rule-detail-"+e).clone(),t.attr("id",""),t.children(".panel-heading").append(n),n.css({float:"right"}),n.css({"margin-top":"-=23px"}),$("#detail-modal-body").append(t),$("#detail-modal").on("hidden.bs.modal",function(){$("#detail-modal").remove()}),$("#detail-modal").modal(),!1}function toggleRuleDisplay(e){var t=e.value;e.checked?($(".rule-overview-leaf-"+t).removeClass("rule-result-filtered"),$(".rule-detail-"+t).removeClass("rule-result-filtered")):($(".rule-overview-leaf-"+t).addClass("rule-result-filtered"),$(".rule-detail-"+t).addClass("rule-result-filtered")),stripeTreeTable()}function toggleResultDetails(e){var t=$("#result-details");return t.is(":visible")?(t.hide(),$(e).html("Show all result details")):(t.show(),$(e).html("Hide all result details")),!1}function ruleSearchMatches(e,t){if(t.length==0)return!0;var n,s=!0,o=e.children(".keywords").text().toLowerCase();for(n=0;n<t.length;++n)if(o.indexOf(t[n].toLowerCase())<0){s=!1;break}return s}function ruleSearch(){var t=$("#search-input").val(),n=t.split(/[\s,.;]+/),e=0;$(".rule-detail").each(function(){var o=$(this).attr("id").substring(12),s=$("#rule-overview-leaf-"+o),t=$(this);ruleSearchMatches(t,n)?(s.removeClass("search-no-match"),t.removeClass("search-no-match"),++e):(s.addClass("search-no-match"),t.addClass("search-no-match"))}),t?e>0?$("#search-matches").html(e.toString()+" rules match."):$("#search-matches").html("No rules match your search criteria!"):$("#search-matches").html("")}var KeysEnum,is_original=!0,original_treetable=null;$(document).ready(function(){$("#result-details").hide(),$(".js-only").show(),$(".form-group select").val("default"),$(".toggle-rule-display").each(function(){toggleRuleDisplay(this)}),original_treetable=$(".treetable").clone(),$(".treetable").treetable({column:0,expandable:!0,clickableNodeNames:!0,initialState:"expanded",indent:0}),is_original=!0,stripeTreeTable()});function resetTreetable(){is_original||($(".treetable").remove(),$("#rule-overview").append(original_treetable.clone()),$(".treetable").treetable({column:0,expandable:!0,clickableNodeNames:!0,initialState:"expanded",indent:0}),$(".toggle-rule-display").each(function(){toggleRuleDisplay(this)}),is_original=!0)}function newGroupLine(e,t){var n=24;return e.length>n&&(e=e.substring(0,n-1)+""),'<tr class="rule-overview-inner-node" data-tt-id="'+t+'"><td colspan="3"><small>'+e+"</small> = <strong>"+t+"</strong></td></tr>"}KeysEnum={DEFAULT:"default",SEVERITY:"severity",RESULT:"result",NIST:"NIST SP 800-53 ID",DISA_CCI:"DISA CCI",DISA_SRG:"DISA SRG",DISA_STIG_ID:"DISA STIG ID",PCI_DSS:"PCI DSS Requirement",CIS:"CIS Recommendation"};function getTargetGroupsList(e,t){switch(t){case KeysEnum.SEVERITY:var n,s,o=e.children(".rule-severity").text();return[o];case KeysEnum.RESULT:return s=e.children(".rule-result").text(),[s];default:try{n=JSON.parse(e.attr("data-references"))}catch{return["unknown"]}return n.hasOwnProperty(t)?n[t]:["unknown"]}}function sortGroups(e,t){switch(t){case KeysEnum.SEVERITY:return["high","medium","low"];case KeysEnum.RESULT:return e.sort();default:return e.sort(function(e,t){var n=e.split(/[.()-]/),o=t.split(/[.()-]/),s=0,r=Math.min(n.length,o.length),a=/^[1-9][0-9]*$/;for(i=0;i<r&&s==0;i++)n[i].match(a)==null||n[i].match(a)==null?s=n[i].localeCompare(o[i]):s=parseInt(n[i])-parseInt(o[i]);return s==0&&(s=n.length-o.length),s})}}function groupRulesBy(e){if(resetTreetable(),e==KeysEnum.DEFAULT)return;var n,s,t={};$(".rule-overview-leaf").each(function(){$(this).children("td:first").css("padding-left","0px");var n,s,a,r=$(this).attr("data-tt-id"),o=getTargetGroupsList($(this),e);for(i=0;i<o.length;i++)n=o[i],t.hasOwnProperty(n)||(t[n]=[newGroupLine(e,n)]),s=$(this).clone(),s.attr("data-tt-id",r+"copy"+i),s.attr("data-tt-parent-id",n),a=s.wrap("<div>").parent().html(),t[n].push(a)}),$(".treetable").remove(),n=sortGroups(Object.keys(t),e),s="";for(i=0;i<n.length;i++)s+=t[n[i]].join(`
`);new_table='<table class="treetable table table-bordered"><thead><tr><th>Group</th> <th style="width: 120px; text-align: center">Severity</th><th style="width: 120px; text-align: center">Result</th></tr></thead><tbody>'+s+"</tbody></table>",$("#rule-overview").append(new_table),is_original=!1,$(".treetable").treetable({column:0,expandable:!0,clickableNodeNames:!0,initialState:"expanded",indent:0}),stripeTreeTable()}function stripeTreeTable(){var t=$(".rule-overview-leaf:not(.rule-result-filtered)"),e=!1;$(t).each(function(){$(this).css("background-color",e?"#F9F9F9":"inherit"),e=!e})}</script></head><body><nav class="navbar navbar-default"><div class=navbar-header style=float:none><a class=navbar-brand href=#><svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" id="svg2"><g transform="matrix(0.75266991,0,0,0.75266991,-17.752968,-104.57468)" id="g32"><path d="m24.7 173.5c0-9 3.5-17.5 9.9-23.9 6.8-6.8 15.7-10.4 25-10 8.6.3 16.9 3.9 22.9 9.8 6.4 6.4 9.9 14.9 10 23.8.1 9.1-3.5 17.8-10 24.3-13.2 13.2-34.7 13.1-48-.1-1.5-1.5-1.9-4.2.2-6.2l9-9c-2-3.6-4.9-13.1 2.6-20.7 7.6-7.6 18.6-6 24.4-.2 3.3 3.3 5.1 7.6 5.1 12.1.1 4.6-1.8 9.1-5.3 12.5-4.2 4.2-10.2 5.8-16.1 4.4-1.5-.4-2.4-1.9-2.1-3.4.4-1.5 1.9-2.4 3.4-2.1 4.1 1 8-.1 10.9-2.9 2.3-2.3 3.6-5.3 3.6-8.4v-.1c0-3-1.3-5.9-3.5-8.2-3.9-3.9-11.3-4.9-16.5.2-6.3 6.3-1.6 14.1-1.6 14.2 1.5 2.4.7 5-.9 6.3l-8.4 8.4c9.9 8.9 27.2 11.2 39.1-.8 5.4-5.4 8.4-12.5 8.4-20 0-.1.0-.2.0-.3-.1-7.5-3-14.6-8.4-19.9-5-5-11.9-8-19.1-8.2-7.8-.3-15.2 2.7-20.9 8.4-8.7 8.7-8.7 19-7.9 24.3.3 2.4 1.1 4.9 2.2 7.3.6 1.4.0 3.1-1.4 3.7s-3.1.0-3.7-1.4c-1.3-2.9-2.2-5.8-2.6-8.7-.3-1.7-.4-3.5-.4-5.2z" id="path34" style="fill:#12497f"/></g></svg></a><div><h1>OpenSCAP Evaluation Report</h1></div></div></nav><div class=container><div id=content><div id=introduction><div class=row><h2>Guide to the Secure Configuration of Red Hat OpenShift Container Platform 4</h2><blockquote>with profile <mark>CIS Red Hat OpenShift Container Platform 4 Benchmark</mark><div class="col-md-12 well well-lg horizontal-scroll"><div class="description profile-description"><small>This profile defines a baseline that aligns to the Center for Internet Security
Red Hat OpenShift Container Platform 4 Benchmark, V0.3, currently unreleased.
This profile includes Center for Internet Security
Red Hat OpenShift Container Platform 4 CIS Benchmarks content.
Note that this part of the profile is meant to run on the Platform that
Red Hat OpenShift Container Platform 4 runs on top of.
This profile is applicable to OpenShift versions 4.6 and greater.</small></div></div></blockquote><div class="col-md-12 well well-lg horizontal-scroll"><div class=front-matter>The ComplianceAsCode Project<br><a href=https://www.open-scap.org/security-policies/scap-security-guide>https://www.open-scap.org/security-policies/scap-security-guide</a></div><div class=description>This guide presents a catalog of security-relevant
configuration settings for Red Hat OpenShift Container Platform 4. It is a rendering of
content structured in the eXtensible Configuration Checklist Description Format (XCCDF)
in order to support security automation. The SCAP content is
is available in the <code>scap-security-guide</code> package which is developed at
<a href=https://www.open-scap.org/security-policies/scap-security-guide>https://www.open-scap.org/security-policies/scap-security-guide</a>.<br><br>Providing system administrators with such guidance informs them how to securely
configure systems under their control in a variety of network roles. Policy
makers and baseline creators can use this catalog of settings, with its
associated references to higher-level security control catalogs, in order to
assist them in security baseline creation. This guide is a <em>catalog, not a
checklist</em>, and satisfaction of every item is not likely to be possible or
sensible in many operational scenarios. However, the XCCDF format enables
granular selection and adjustment of settings, and their association with OVAL
and OCIL content provides an automated checking capability. Transformations of
this document, and its associated automated checking content, are capable of
providing baselines that meet a diverse set of policy objectives. Some example
XCCDF <em>Profiles</em>, which are selections of items that form checklists and
can be used as baselines, are available with this guide. They can be
processed, in an automated fashion, with tools that support the Security
Content Automation Protocol (SCAP). The NIST National Checklist Program (NCP),
which provides required settings for the United States Government, is one example
of a baseline created from this guidance.</div><div class=top-spacer-10><div class="alert alert-info">Do not attempt to implement any of the settings in
this guide without first testing them in a non-operational environment. The
creators of this guidance assume no responsibility whatsoever for its use by
other parties, and makes no guarantees, expressed or implied, about its
quality, reliability, or any other characteristic.</div></div></div></div></div><div id=characteristics><h2>Evaluation Characteristics</h2><div class=row><div class="col-md-5 well well-lg horizontal-scroll"><table class="table table-bordered"><tr><th>Evaluation target</th><td>ocp4-cis-api-checks-pod</td></tr><tr><th>Benchmark URL</th><td>/content/ssg-ocp4-ds.xml</td></tr><tr><th>Benchmark ID</th><td>xccdf_org.ssgproject.content_benchmark_OCP-4</td></tr><tr><th>Benchmark version</th><td>0.1.57</td></tr><tr><th>Profile ID</th><td>xccdf_org.ssgproject.content_profile_cis</td></tr><tr><th>Started at</th><td>2021-07-20T05:20:59+00:00</td></tr><tr><th>Finished at</th><td>2021-07-20T05:21:00+00:00</td></tr><tr><th>Performed by</th><td></td></tr><tr><th>Test system</th><td>cpe:/a:redhat:openscap:1.3.4</td></tr></table></div><div class="col-md-3 horizontal-scroll"><h4>CPE Platforms</h4><ul class=list-group><li class=list-group-item><span class="label label-success" title="CPE platform cpe:/a:redhat:openshift_container_platform:4.1 was found applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.1</span></li><li class=list-group-item><span class="label label-success" title="CPE platform cpe:/a:redhat:openshift_container_platform:4.7 was found applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.7</span></li><li class=list-group-item><span class="label label-default" title="This CPE platform was not applicable on the evaluated machine">cpe:/o:redhat:openshift_container_platform_node:4</span></li><li class=list-group-item><span class="label label-default" title="This CPE platform was not applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.6</span></li><li class=list-group-item><span class="label label-default" title="This CPE platform was not applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.8</span></li><li class=list-group-item><span class="label label-default" title="This CPE platform was not applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.9</span></li><li class=list-group-item><span class="label label-default" title="This CPE platform was not applicable on the evaluated machine">cpe:/a:redhat:openshift_container_platform:4.10</span></li></ul></div><div class="col-md-4 horizontal-scroll"><h4>Addresses</h4><ul class=list-group><li class=list-group-item><span class="label label-primary">IPv4</span>
127.0.0.1</li><li class=list-group-item><span class="label label-primary">IPv4</span>
10.130.0.19</li><li class=list-group-item><span class="label label-info">IPv6</span>
0:0:0:0:0:0:0:1</li><li class=list-group-item><span class="label label-info">IPv6</span>
fe80:0:0:0:858:aff:fe82:13</li><li class=list-group-item><span class="label label-default">MAC</span>
00:00:00:00:00:00</li><li class=list-group-item><span class="label label-default">MAC</span>
0A:58:0A:82:00:13</li></ul></div></div></div><div id=compliance-and-scoring><h2>Compliance and Scoring</h2><div class="alert alert-danger"><strong>The target system did not satisfy the conditions of 4 rules!</strong>
Please review rule results and consider applying remediation.</div><h3>Rule results</h3><div class=progress title="Displays proportion of passed/fixed, failed/error, and other rules (in that order). There were $not_ignored_rules_count rules taken into account."><div class="progress-bar progress-bar-success" style=width:65.5913978494624%>61 passed</div><div class="progress-bar progress-bar-danger" style=width:4.301075268817205%>4 failed</div><div class="progress-bar progress-bar-warning" style=width:30.1075268817204%>28 other</div></div><h3>Severity of failed rules</h3><div class=progress title="Displays proportion of high, medium, low, and other severity failed rules (in that order). There were 4 total failed rules."><div class="progress-bar progress-bar-success" style=width:0%>0 other</div><div class="progress-bar progress-bar-info" style=width:0%>0 low</div><div class="progress-bar progress-bar-warning" style=width:100%>4 medium</div><div class="progress-bar progress-bar-danger" style=width:0%>0 high</div></div><h3 title="As per the XCCDF specification">Score</h3><table class="table table-striped table-bordered"><thead><tr><th>Scoring system</th><th class=text-center>Score</th><th class=text-center>Maximum</th><th class=text-center style=width:40%>Percent</th></tr></thead><tbody><tr><td>urn:xccdf:scoring:default</td><td class=text-center>89.285721</td><td class=text-center>100.000000</td><td><div class=progress><div class="progress-bar progress-bar-success" style=width:89.285721%>89.29%</div><div class="progress-bar progress-bar-danger" style=width:10.714279%></div></div></td></tr></tbody></table></div><div id=rule-overview><h2>Rule Overview</h2><div class="form-group js-only hidden-print"><div class=row><div title="Filter rules by their XCCDF result"><div class="col-sm-2 toggle-rule-display-success"><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=pass>pass</label></div><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=fixed>fixed</label></div><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=informational>informational</label></div></div><div class="col-sm-2 toggle-rule-display-danger"><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=fail>fail</label></div><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=error>error</label></div><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=unknown>unknown</label></div></div><div class="col-sm-2 toggle-rule-display-other"><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=notchecked>notchecked</label></div><div class=checkbox><label><input class=toggle-rule-display type=checkbox onclick=toggleRuleDisplay(this) checked value=notapplicable>notapplicable</label></div></div></div><div class=col-sm-6><div class=input-group><input type=text class=form-control placeholder="Search through XCCDF rules" id=search-input oninput=ruleSearch()><div class=input-group-btn><button class="btn btn-default" onclick=ruleSearch()>Search</button></div></div><p id=search-matches></p>Group rules by:
<select name=groupby onchange=groupRulesBy(value)><option value=default selected>Default</option><option value=severity>Severity</option><option value=result>Result</option><option disabled></option><option value="NIST SP 800-53">NIST SP 800-53</option><option value=https://www.cisecurity.org/benchmark/kubernetes/>https://www.cisecurity.org/benchmark/kubernetes/</option></select></div></div></div><table class="treetable table table-bordered"><thead><tr><th>Title</th><th style=width:120px;text-align:center>Severity</th><th style=width:120px;text-align:center>Result</th></tr></thead><tbody><tr data-tt-id=xccdf_org.ssgproject.content_benchmark_OCP-4 class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_benchmark_OCP-4"><td colspan=3 style=padding-left:0><strong>Guide to the Secure Configuration of Red Hat OpenShift Container Platform 4</strong><span class=badge>4x fail</span><span class=badge>28x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_openshift class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_openshift" data-tt-parent-id=xccdf_org.ssgproject.content_benchmark_OCP-4><td colspan=3 style=padding-left:19px><strong>OpenShift Settings</strong><span class=badge>4x fail</span><span class=badge>28x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_accounts class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_accounts" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>OpenShift - Account and Access Control</strong><span class=badge>2x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens" id=rule-overview-leaf-idm45420686581312 data-tt-parent-id=xccdf_org.ssgproject.content_group_accounts data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.6"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686581312 onclick='return openRuleDetailsDialog("idm45420686581312")'>Restrict Automounting of Service Account Tokens</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_accounts_unique_service_account class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_accounts_unique_service_account" id=rule-overview-leaf-idm45420686578640 data-tt-parent-id=xccdf_org.ssgproject.content_group_accounts data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686578640 onclick='return openRuleDetailsDialog("idm45420686578640")'>Ensure Usage of Unique Service Accounts</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_scheduler class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_scheduler" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>OpenShift - Kubernetes - Scheduler Settings<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_scheduler")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scheduler_no_bind_address class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scheduler_no_bind_address" id=rule-overview-leaf-idm45420686575984 data-tt-parent-id=xccdf_org.ssgproject.content_group_scheduler data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.4.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686575984 onclick='return openRuleDetailsDialog("idm45420686575984")'>Ensure that the bind-address parameter is not used</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_secrets class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_secrets" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>OpenShift Secrets Management</strong><span class=badge>2x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_secrets_consider_external_storage class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_secrets_consider_external_storage" id=rule-overview-leaf-idm45420686569008 data-tt-parent-id=xccdf_org.ssgproject.content_group_secrets data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.4.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686569008 onclick='return openRuleDetailsDialog("idm45420686569008")'>Consider external secret storage</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_secrets_no_environment_variables class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_secrets_no_environment_variables" id=rule-overview-leaf-idm45420686566352 data-tt-parent-id=xccdf_org.ssgproject.content_group_secrets data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.4.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686566352 onclick='return openRuleDetailsDialog("idm45420686566352")'>Do Not Use Environment Variables with Secrets</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_api-server class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_api-server" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>OpenShift Kube API Server</strong><span class=badge>3x fail</span><span class=badge>2x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_client_ca class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_client_ca" id=rule-overview-leaf-idm45420686563696 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.31"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686563696 onclick='return openRuleDetailsDialog("idm45420686563696")'>Configure the Client Certificate Authority for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_request_timeout class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_request_timeout" id=rule-overview-leaf-idm45420686558704 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.26"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686558704 onclick='return openRuleDetailsDialog("idm45420686558704")'>Configure the API Server Minimum Request Timeout</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysPullImages class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysPullImages" id=rule-overview-leaf-idm45420686553504 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.12"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686553504 onclick='return openRuleDetailsDialog("idm45420686553504")'>Ensure that the Admission Control Plugin AlwaysPullImages is not set</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_bind_address class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_bind_address" id=rule-overview-leaf-idm45420686549152 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.20"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686549152 onclick='return openRuleDetailsDialog("idm45420686549152")'>Ensure that the bindAddress is set to a relevant secure port</a></td><td class=rule-severity style=text-align:center>low</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_service_account_public_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_service_account_public_key" id=rule-overview-leaf-idm45420686544176 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.28"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686544176 onclick='return openRuleDetailsDialog("idm45420686544176")'>Configure the Service Account Public Key for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled" id=rule-overview-leaf-idm45420686539152 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.13","1.2.14","1.2.14","1.2.15","1.2.16","1.2.17"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686539152 onclick='return openRuleDetailsDialog("idm45420686539152")'>Ensure all admission control plugins are enabled</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_audit_log_forwarding_enabled class="rule-overview-leaf rule-overview-leaf-fail rule-overview-needs-attention" id=rule-overview-leaf-idm45420686534112 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["AC-2(12)","AU-6","AU-6(1)","AU-6(3)","AU-9(2)","SI-4(16)","AU-4(1)","AU-11","AU-7","AU-7(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.23"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686534112 onclick='return openRuleDetailsDialog("idm45420686534112")'>Ensure that Audit Log Forwarding Is Enabled</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites" id=rule-overview-leaf-idm45420686529088 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.35"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686529088 onclick='return openRuleDetailsDialog("idm45420686529088")'>Use Strong Cryptographic Ciphers on the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac" id=rule-overview-leaf-idm45420686524768 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.9"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686524768 onclick='return openRuleDetailsDialog("idm45420686524768")'>Ensure authorization-mode RBAC is configured</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_tls_cert class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_tls_cert" id=rule-overview-leaf-idm45420686519744 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.30"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686519744 onclick='return openRuleDetailsDialog("idm45420686519744")'>Configure the Certificate for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn" id=rule-overview-leaf-idm45420686514752 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686514752 onclick='return openRuleDetailsDialog("idm45420686514752")'>Ensure that the --kubelet-https argument is set to true</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize" id=rule-overview-leaf-idm45420686510432 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.25"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686510432 onclick='return openRuleDetailsDialog("idm45420686510432")'>Configure Kubernetes API Server Maximum Audit Log Size</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert" id=rule-overview-leaf-idm45420686505408 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686505408 onclick='return openRuleDetailsDialog("idm45420686505408")'>Configure the kubelet Certificate File for the API Server</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_basic_auth class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_basic_auth" id=rule-overview-leaf-idm45420686500384 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686500384 onclick='return openRuleDetailsDialog("idm45420686500384")'>Disable basic-auth-file for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NodeRestriction class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NodeRestriction" id=rule-overview-leaf-idm45420686495392 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.17"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686495392 onclick='return openRuleDetailsDialog("idm45420686495392")'>Enable the NodeRestriction Admission Control Plugin</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa" id=rule-overview-leaf-idm45420686490336 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.7"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686490336 onclick='return openRuleDetailsDialog("idm45420686490336")'>The authorization-mode cannot be AlwaysAllow</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_service_account_lookup class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_service_account_lookup" id=rule-overview-leaf-idm45420686485312 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.27"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686485312 onclick='return openRuleDetailsDialog("idm45420686485312")'>Ensure that the service-account-lookup argument is set to true</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_auth_mode_node class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_node" id=rule-overview-leaf-idm45420686480288 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.8"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686480288 onclick='return openRuleDetailsDialog("idm45420686480288")'>Ensure authorization-mode Node is configured</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_insecure_bind_address class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_insecure_bind_address" id=rule-overview-leaf-idm45420686475264 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.18"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686475264 onclick='return openRuleDetailsDialog("idm45420686475264")'>Disable Use of the Insecure Bind Address</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled" id=rule-overview-leaf-idm45420686470240 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.10"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686470240 onclick='return openRuleDetailsDialog("idm45420686470240")'>Enable the APIPriorityAndFairness feature gate</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority" id=rule-overview-leaf-idm45420686465216 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.6"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686465216 onclick='return openRuleDetailsDialog("idm45420686465216")'>Configure the kubelet Certificate Authority for the API Server</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_SecurityContextDeny class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_SecurityContextDeny" id=rule-overview-leaf-idm45420686460176 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.13"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686460176 onclick='return openRuleDetailsDialog("idm45420686460176")'>Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_encryption_provider_cipher class="rule-overview-leaf rule-overview-leaf-fail rule-overview-needs-attention" id=rule-overview-leaf-idm45420686455104 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-28","SC-28(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.34"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686455104 onclick='return openRuleDetailsDialog("idm45420686455104")'>Configure the Encryption Provider Cipher</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac" id=rule-overview-leaf-idm45420686450784 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.21"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686450784 onclick='return openRuleDetailsDialog("idm45420686450784")'>Profiling is protected by RBAC</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_anonymous_auth class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_anonymous_auth" id=rule-overview-leaf-idm45420686445744 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686445744 onclick='return openRuleDetailsDialog("idm45420686445744")'>Ensure that anonymous requests to the API Server are authorized</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert" id=rule-overview-leaf-idm45420686441424 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686441424 onclick='return openRuleDetailsDialog("idm45420686441424")'>Ensure the openshift-oauth-apiserver service uses TLS</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_tls_private_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_tls_private_key" id=rule-overview-leaf-idm45420686438752 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.30"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686438752 onclick='return openRuleDetailsDialog("idm45420686438752")'>Configure the Certificate Key for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_audit_log_path class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_path" id=rule-overview-leaf-idm45420686433728 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.22"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686433728 onclick='return openRuleDetailsDialog("idm45420686433728")'>Configure the Audit Log Path</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all" id=rule-overview-leaf-idm45420686428704 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.10"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686428704 onclick='return openRuleDetailsDialog("idm45420686428704")'>Ensure catch-all FlowSchema object for API Priority and Fairness Exists (v1alpha1)</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_encryption_provider_config class="rule-overview-leaf rule-overview-leaf-fail rule-overview-needs-attention" id=rule-overview-leaf-idm45420686423648 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-28","SC-28(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.33"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686423648 onclick='return openRuleDetailsDialog("idm45420686423648")'>Configure the Encryption Provider</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup" id=rule-overview-leaf-idm45420686418624 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.24"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686418624 onclick='return openRuleDetailsDialog("idm45420686418624")'>Configure the Kubernetes API Server Maximum Retained Audit Logs</a></td><td class=rule-severity style=text-align:center>low</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_insecure_port class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_insecure_port" id=rule-overview-leaf-idm45420686413632 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.19"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686413632 onclick='return openRuleDetailsDialog("idm45420686413632")'>Prevent Insecure Port Access</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_etcd_cert class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_etcd_cert" id=rule-overview-leaf-idm45420686408624 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.29"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686408624 onclick='return openRuleDetailsDialog("idm45420686408624")'>Configure the etcd Certificate for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key" id=rule-overview-leaf-idm45420686403632 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686403632 onclick='return openRuleDetailsDialog("idm45420686403632")'>Configure the kubelet Certificate Key for the API Server</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_token_auth class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_token_auth" id=rule-overview-leaf-idm45420686398608 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686398608 onclick='return openRuleDetailsDialog("idm45420686398608")'>Disable Token-based Authentication</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_ServiceAccount class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_ServiceAccount" id=rule-overview-leaf-idm45420686393616 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.14"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686393616 onclick='return openRuleDetailsDialog("idm45420686393616")'>Enable the ServiceAccount Admission Control Plugin</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize" id=rule-overview-leaf-idm45420686388560 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.25"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686388560 onclick='return openRuleDetailsDialog("idm45420686388560")'>Configure OpenShift API Server Maximum Audit Log Size</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysAdmit class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysAdmit" id=rule-overview-leaf-idm45420686383536 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.11"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686383536 onclick='return openRuleDetailsDialog("idm45420686383536")'>Disable the AlwaysAdmit Admission Control Plugin</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NamespaceLifecycle class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NamespaceLifecycle" id=rule-overview-leaf-idm45420686378480 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.15"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686378480 onclick='return openRuleDetailsDialog("idm45420686378480")'>Enable the NamespaceLifecycle Admission Control Plugin</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_etcd_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_etcd_key" id=rule-overview-leaf-idm45420686373408 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.29"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686373408 onclick='return openRuleDetailsDialog("idm45420686373408")'>Configure the etcd Certificate Key for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert" id=rule-overview-leaf-idm45420686368416 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686368416 onclick='return openRuleDetailsDialog("idm45420686368416")'>Ensure the openshift-oauth-apiserver service uses TLS</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup" id=rule-overview-leaf-idm45420686365760 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.24"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686365760 onclick='return openRuleDetailsDialog("idm45420686365760")'>Configure the OpenShift API Server Maximum Retained Audit Logs</a></td><td class=rule-severity style=text-align:center>low</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_etcd_ca class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_etcd_ca" id=rule-overview-leaf-idm45420686360768 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.32"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686360768 onclick='return openRuleDetailsDialog("idm45420686360768")'>Configure the etcd Certificate Authority for the API Server</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_Scc class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_Scc" id=rule-overview-leaf-idm45420686355776 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.16"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686355776 onclick='return openRuleDetailsDialog("idm45420686355776")'>Enable the SecurityContextConstraint Admission Control Plugin</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all class="rule-overview-leaf rule-overview-leaf-notapplicable rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all" id=rule-overview-leaf-idm45420686350736 data-tt-parent-id=xccdf_org.ssgproject.content_group_api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.10"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686350736 onclick='return openRuleDetailsDialog("idm45420686350736")'>Ensure catch-all FlowSchema object for API Priority and Fairness Exists</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notapplicable"><div><abbr title="The Rule was not applicable to the target of the test. For example, the Rule might have been specific to a different version of the target OS, or it might have been a test against a platform feature that was not installed.">notapplicable</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_scc class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_scc" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>Security Context Constraints (SCC)</strong><span class=badge>9x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace" id=rule-overview-leaf-idm45420686348064 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686348064 onclick='return openRuleDetailsDialog("idm45420686348064")'>Limit Access to the Host IPC Namespace</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_root_containers class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_root_containers" id=rule-overview-leaf-idm45420686344704 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.6"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686344704 onclick='return openRuleDetailsDialog("idm45420686344704")'>Limit Container Running As Root User</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_drop_container_capabilities class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_drop_container_capabilities" id=rule-overview-leaf-idm45420686342048 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.9"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686342048 onclick='return openRuleDetailsDialog("idm45420686342048")'>Drop Container Capabilities</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace" id=rule-overview-leaf-idm45420686339392 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686339392 onclick='return openRuleDetailsDialog("idm45420686339392")'>Limit Access to the Host Process ID Namespace</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_network_namespace class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_network_namespace" id=rule-overview-leaf-idm45420686336736 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686336736 onclick='return openRuleDetailsDialog("idm45420686336736")'>Limit Access to the Host Network Namespace</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation" id=rule-overview-leaf-idm45420686333376 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686333376 onclick='return openRuleDetailsDialog("idm45420686333376")'>Limit Containers Ability to Escalate Privileges</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities" id=rule-overview-leaf-idm45420686330016 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.8"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686330016 onclick='return openRuleDetailsDialog("idm45420686330016")'>Limit Container Capabilities</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_privileged_containers class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_privileged_containers" id=rule-overview-leaf-idm45420686327344 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686327344 onclick='return openRuleDetailsDialog("idm45420686327344")'>Limit Privileged Container Use</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability" id=rule-overview-leaf-idm45420686324688 data-tt-parent-id=xccdf_org.ssgproject.content_group_scc data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.2.7"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686324688 onclick='return openRuleDetailsDialog("idm45420686324688")'>Limit Use of the CAP_NET_RAW</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_authentication class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_authentication" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>Authentication<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_authentication")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_idp_is_configured class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_idp_is_configured" id=rule-overview-leaf-idm45420686121024 data-tt-parent-id=xccdf_org.ssgproject.content_group_authentication data-references='{"NIST SP 800-53":["AC-2","AC-2(1)","AC-2(2)","AC-2(3)","AC-2(4)","AC-2(5)","AC-2(6)","AC-2(7)","AC-2(8)","AC-7"],"https://www.cisecurity.org/benchmark/kubernetes/":["3.1.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686121024 onclick='return openRuleDetailsDialog("idm45420686121024")'>Configure An Identity Provider</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_worker class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_worker" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>OpenShift - Master Node Settings</strong><span class=badge>1x fail</span><span class=badge>2x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig" id=rule-overview-leaf-idm45420686102768 data-tt-parent-id=xccdf_org.ssgproject.content_group_worker data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.1.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686102768 onclick='return openRuleDetailsDialog("idm45420686102768")'>Verify Group Who Owns The Worker Proxy Kubeconfig File</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig class="rule-overview-leaf rule-overview-leaf-fail rule-overview-needs-attention" id=rule-overview-leaf-idm45420686081520 data-tt-parent-id=xccdf_org.ssgproject.content_group_worker data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.1.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686081520 onclick='return openRuleDetailsDialog("idm45420686081520")'>Verify Permissions on the Worker Proxy Kubeconfig File</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig" id=rule-overview-leaf-idm45420686073840 data-tt-parent-id=xccdf_org.ssgproject.content_group_worker data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.1.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686073840 onclick='return openRuleDetailsDialog("idm45420686073840")'>Verify User Who Owns The Worker Proxy Kubeconfig File</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_etcd class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_etcd" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>OpenShift etcd Settings<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_etcd")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_key_file class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_key_file" id=rule-overview-leaf-idm45420686063952 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686063952 onclick='return openRuleDetailsDialog("idm45420686063952")'>Ensure That The etcd Key File Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_peer_cert_file class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_peer_cert_file" id=rule-overview-leaf-idm45420686058960 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686058960 onclick='return openRuleDetailsDialog("idm45420686058960")'>Ensure That The etcd Peer Client Certificate Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth" id=rule-overview-leaf-idm45420686053968 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686053968 onclick='return openRuleDetailsDialog("idm45420686053968")'>Enable The Peer Client Certificate Authentication</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_peer_key_file class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_peer_key_file" id=rule-overview-leaf-idm45420686048944 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686048944 onclick='return openRuleDetailsDialog("idm45420686048944")'>Ensure That The etcd Peer Key File Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_cert_file class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_cert_file" id=rule-overview-leaf-idm45420686043952 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686043952 onclick='return openRuleDetailsDialog("idm45420686043952")'>Ensure That The etcd Client Certificate Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_client_cert_auth class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_client_cert_auth" id=rule-overview-leaf-idm45420686037024 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686037024 onclick='return openRuleDetailsDialog("idm45420686037024")'>Enable The Client Certificate Authentication</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_peer_auto_tls class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_peer_auto_tls" id=rule-overview-leaf-idm45420686032032 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.6"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686032032 onclick='return openRuleDetailsDialog("idm45420686032032")'>Disable etcd Peer Self-Signed Certificates</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_etcd_auto_tls class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_etcd_auto_tls" id=rule-overview-leaf-idm45420686027040 data-tt-parent-id=xccdf_org.ssgproject.content_group_etcd data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["2.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686027040 onclick='return openRuleDetailsDialog("idm45420686027040")'>Disable etcd Self-Signed Certificates</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_general class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_general" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>OpenShift - General Security Practices</strong><span class=badge>5x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_general_namespaces_in_use class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_general_namespaces_in_use" id=rule-overview-leaf-idm45420686022048 data-tt-parent-id=xccdf_org.ssgproject.content_group_general data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.6.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686022048 onclick='return openRuleDetailsDialog("idm45420686022048")'>Create administrative boundaries between resources using namespaces</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook" id=rule-overview-leaf-idm45420686019392 data-tt-parent-id=xccdf_org.ssgproject.content_group_general data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.5.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686019392 onclick='return openRuleDetailsDialog("idm45420686019392")'>Manage Image Provenance Using ImagePolicyWebhook</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_general_default_namespace_use class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_general_default_namespace_use" id=rule-overview-leaf-idm45420686016736 data-tt-parent-id=xccdf_org.ssgproject.content_group_general data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.6.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686016736 onclick='return openRuleDetailsDialog("idm45420686016736")'>The default namespace should not be used</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_general_apply_scc class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_general_apply_scc" id=rule-overview-leaf-idm45420686014080 data-tt-parent-id=xccdf_org.ssgproject.content_group_general data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.6.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686014080 onclick='return openRuleDetailsDialog("idm45420686014080")'>Apply Security Context to Your Pods and Containers</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_general_default_seccomp_profile class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_general_default_seccomp_profile" id=rule-overview-leaf-idm45420686011440 data-tt-parent-id=xccdf_org.ssgproject.content_group_general data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.6.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686011440 onclick='return openRuleDetailsDialog("idm45420686011440")'>Ensure Seccomp Profile Pod Definitions</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_openshift-api-server class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_openshift-api-server" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>OpenShift API Server<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_openshift-api-server")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path" id=rule-overview-leaf-idm45420686008784 data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift-api-server data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.2.22"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686008784 onclick='return openRuleDetailsDialog("idm45420686008784")'>Configure the Audit Log Path</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_controller class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_controller" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>OpenShift Controller Settings<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_controller")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_secure_port class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_secure_port" id=rule-overview-leaf-idm45420686003760 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.7"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420686003760 onclick='return openRuleDetailsDialog("idm45420686003760")'>Ensure Controller secure-port argument is set</a></td><td class=rule-severity style=text-align:center>low</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_use_service_account class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_use_service_account" id=rule-overview-leaf-idm45420685996848 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685996848 onclick='return openRuleDetailsDialog("idm45420685996848")'>Ensure that use-service-account-credentials is enabled</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_insecure_port_disabled class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_insecure_port_disabled" id=rule-overview-leaf-idm45420685991824 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.7"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685991824 onclick='return openRuleDetailsDialog("idm45420685991824")'>Ensure Controller insecure port argument is unset</a></td><td class=rule-severity style=text-align:center>low</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_service_account_ca class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_service_account_ca" id=rule-overview-leaf-idm45420685986832 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.5"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685986832 onclick='return openRuleDetailsDialog("idm45420685986832")'>Configure the Service Account Certificate Authority Key for the Controller Manager</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_service_account_private_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_service_account_private_key" id=rule-overview-leaf-idm45420685981808 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685981808 onclick='return openRuleDetailsDialog("idm45420685981808")'>Configure the Service Account Private Key for the Controller Manager</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs" id=rule-overview-leaf-idm45420685976768 data-tt-parent-id=xccdf_org.ssgproject.content_group_controller data-references='{"NIST SP 800-53":["CM-6","CM-6(1)","SC-8","SC-8(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.6"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685976768 onclick='return openRuleDetailsDialog("idm45420685976768")'>Ensure that the RotateKubeletServerCertificate argument is set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_kubelet class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_kubelet" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>Kubernetes Kubelet Settings<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_kubelet")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert" id=rule-overview-leaf-idm45420685969056 data-tt-parent-id=xccdf_org.ssgproject.content_group_kubelet data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.2.10"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685969056 onclick='return openRuleDetailsDialog("idm45420685969056")'>Ensure That The kubelet Client Certificate Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port" id=rule-overview-leaf-idm45420685906848 data-tt-parent-id=xccdf_org.ssgproject.content_group_kubelet data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.2.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685906848 onclick='return openRuleDetailsDialog("idm45420685906848")'>kubelet - Disable the Read-Only Port</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key" id=rule-overview-leaf-idm45420685901824 data-tt-parent-id=xccdf_org.ssgproject.content_group_kubelet data-references='{"NIST SP 800-53":["SC-8","SC-8(1)","SC-8(2)"],"https://www.cisecurity.org/benchmark/kubernetes/":["4.2.10"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685901824 onclick='return openRuleDetailsDialog("idm45420685901824")'>Ensure That The kubelet Server Key Is Correctly Set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_logging class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_logging" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px>OpenShift - Logging Settings<script>$(document).ready(function(){$(".treetable").treetable("collapseNode","xccdf_org.ssgproject.content_group_logging")})</script></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_audit_profile_set class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_audit_profile_set" id=rule-overview-leaf-idm45420685894832 data-tt-parent-id=xccdf_org.ssgproject.content_group_logging data-references='{"NIST SP 800-53":["AU-2","AU-3","AU-3(1)","AU-6","AU-6(1)","AU-7","AU-7(1)","AU-8","AU-8(1)","AU-9","AU-12","CM-5(1)","SI-11","SI-12"],"https://www.cisecurity.org/benchmark/kubernetes/":["3.2.1","3.2.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685894832 onclick='return openRuleDetailsDialog("idm45420685894832")'>Ensure that the cluster's audit profile is properly set</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_rbac class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_rbac" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>Role-based Acess Control</strong><span class=badge>4x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_rbac_wildcard_use class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_rbac_wildcard_use" id=rule-overview-leaf-idm45420685888960 data-tt-parent-id=xccdf_org.ssgproject.content_group_rbac data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.3"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685888960 onclick='return openRuleDetailsDialog("idm45420685888960")'>Minimize Wildcard Usage in Cluster and Local Roles</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_rbac_limit_secrets_access class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_rbac_limit_secrets_access" id=rule-overview-leaf-idm45420685886320 data-tt-parent-id=xccdf_org.ssgproject.content_group_rbac data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685886320 onclick='return openRuleDetailsDialog("idm45420685886320")'>Limit Access to Kubernetes Secrets</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_rbac_pod_creation_access class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_rbac_pod_creation_access" id=rule-overview-leaf-idm45420685883664 data-tt-parent-id=xccdf_org.ssgproject.content_group_rbac data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.4"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685883664 onclick='return openRuleDetailsDialog("idm45420685883664")'>Minimize Access to Pod Creation</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof class="rule-overview-leaf rule-overview-leaf-pass rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof" id=rule-overview-leaf-idm45420685881008 data-tt-parent-id=xccdf_org.ssgproject.content_group_rbac data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["1.3.2","1.4.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685881008 onclick='return openRuleDetailsDialog("idm45420685881008")'>Profiling is protected by RBAC</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin" id=rule-overview-leaf-idm45420685875984 data-tt-parent-id=xccdf_org.ssgproject.content_group_rbac data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.1.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685875984 onclick='return openRuleDetailsDialog("idm45420685875984")'>Ensure that the cluster-admin role is only used where required</a></td><td class=rule-severity style=text-align:center>medium</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_group_networking class="rule-overview-inner-node rule-overview-inner-node-id-xccdf_org.ssgproject.content_group_networking" data-tt-parent-id=xccdf_org.ssgproject.content_group_openshift><td colspan=3 style=padding-left:38px><strong>Network Configuration and Firewalls</strong><span class=badge>2x notchecked</span></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces" id=rule-overview-leaf-idm45420685869424 data-tt-parent-id=xccdf_org.ssgproject.content_group_networking data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.3.2"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685869424 onclick='return openRuleDetailsDialog("idm45420685869424")'>Ensure that application Namespaces have Network Policies defined.</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr data-tt-id=xccdf_org.ssgproject.content_rule_configure_network_policies class="rule-overview-leaf rule-overview-leaf-notchecked rule-overview-leaf-id-xccdf_org.ssgproject.content_rule_configure_network_policies" id=rule-overview-leaf-idm45420685864112 data-tt-parent-id=xccdf_org.ssgproject.content_group_networking data-references='{"NIST SP 800-53":["CM-6","CM-6(1)"],"https://www.cisecurity.org/benchmark/kubernetes/":["5.3.1"]}'><td style=padding-left:57px><a href=#rule-detail-idm45420685864112 onclick='return openRuleDetailsDialog("idm45420685864112")'>Ensure that the CNI in use supports Network Policies</a></td><td class=rule-severity style=text-align:center>high</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr></tbody></table></div><div class="js-only hidden-print"><button type=button class="btn btn-info" onclick="return toggleResultDetails(this)">Show all result details</button></div><div id=result-details><h2>Result Details</h2><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens" id=rule-detail-idm45420686581312><div class="keywords sr-only">Restrict Automounting of Service Account Tokensxccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens medium</div><div class=panel-heading><h3 class=panel-title>Restrict Automounting of Service Account Tokens</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Service accounts tokens should not be mounted in pods except where the workload
running in the pod explicitly needs to communicate with the API server.
To ensure pods do not automatically mount tokens, set
<code>automountServiceAccountToken</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Mounting service account tokens inside pods can provide an avenue
for privilege escalation attacks where an attacker is able to
compromise a single pod in the cluster.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_accounts_unique_service_account" id=rule-detail-idm45420686578640><div class="keywords sr-only">Ensure Usage of Unique Service Accounts xccdf_org.ssgproject.content_rule_accounts_unique_service_account medium</div><div class=panel-heading><h3 class=panel-title>Ensure Usage of Unique Service Accounts</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_accounts_unique_service_account</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Using the <code>default</code> service account prevents accurate application
rights review and audit tracing. Instead of <code>default</code>, create
a new and unique service account with the following command:<pre>$ oc create sa <i>service_account_name</i></pre>where <i>service_account_name</i> is the name of a service account
that is needed in the project namespace.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Kubernetes provides a default service account which is used by
cluster workloads where no specific service account is assigned to the pod.
Where access to the Kubernetes API from a pod is required, a specific service account
should be created for that pod, and rights granted to that service account.
This increases auditability of service account rights and access making it
easier and more accurate to trace potential malicious behaviors to a specific
service account and project.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_scheduler_no_bind_address" id=rule-detail-idm45420686575984><div class="keywords sr-only">Ensure that the bind-address parameter is not usedxccdf_org.ssgproject.content_rule_scheduler_no_bind_address mediumCCE-83674-2</div><div class=panel-heading><h3 class=panel-title>Ensure that the bind-address parameter is not used</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scheduler_no_bind_address</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-scheduler_no_bind_address:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83674-2">CCE-83674-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.4.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The Scheduler API service which runs on port 10251/TCP by default is used for
health and metrics information and is available without authentication or
encryption. As such it should only be bound to a localhost interface, to
minimize the cluster's attack surface.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>In OpenShift 4, The Kubernetes Scheduler operator manages and updates the
Kubernetes Scheduler deployed on top of OpenShift. By default, the operator
exposes metrics via metrics service. The metrics are collected from the
Kubernetes Scheduler operator. Profiling data is sent to healthzPort,
the port of the localhost healthz endpoint. Changing this value may disrupt
components that monitor the kubelet health.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod' find only one object at path '.data["pod.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_scheduler_no_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-scheduler/configmaps</td><td>kube-scheduler-pod</td><td>.data["pod.yaml"]</td><td>{"kind":"Pod","apiVersion":"v1","metadata":{"name":"openshift-kube-scheduler","namespace":"openshift-kube-scheduler","creationTimestamp":null,"labels":{"app":"openshift-kube-scheduler","revision":"REVISION","scheduler":"true"},"annotations":{"kubectl.kubernetes.io/default-logs-container":"kube-scheduler"}},"spec":{"volumes":[{"name":"resource-dir","hostPath":{"path":"/etc/kubernetes/static-pod-resources/kube-scheduler-pod-REVISION"}},{"name":"cert-dir","hostPath":{"path":"/etc/kubernetes/static-pod-resources/kube-scheduler-certs"}}],"initContainers":[{"name":"wait-for-host-port","image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:0286a17f0671310c1610508127f4730aab5c30048f5fd5af88c0e439eaf5ac30","command":["/usr/bin/timeout","30","/bin/bash","-c"],"args":["echo -n \"Waiting for port :10259 and :10251 to be released.\"\nwhile [ -n \"$(ss -Htan '( sport = 10251 or sport = 10259 )')\" ]; do\n echo -n \".\"\n sleep 1\ndone\n"],"resources":{"requests":{"cpu":"15m","memory":"50Mi"}},"terminationMessagePolicy":"FallbackToLogsOnError","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"kube-scheduler","image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:0286a17f0671310c1610508127f4730aab5c30048f5fd5af88c0e439eaf5ac30","command":["hyperkube","kube-scheduler"],"args":["--config=/etc/kubernetes/static-pod-resources/configmaps/config/config.yaml","--cert-dir=/var/run/kubernetes","--port=0","--authentication-kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig","--authorization-kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig","--feature-gates=APIPriorityAndFairness=true,LegacyNodeRoleBehavior=false,NodeDisruptionExclusion=true,RemoveSelfLink=false,RotateKubeletServerCertificate=true,SCTPSupport=true,ServiceNodeExclusion=true,SupportPodPidsLimit=true","-v=2","--tls-cert-file=/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.crt","--tls-private-key-file=/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.key"],"ports":[{"containerPort":10259}],"resources":{"requests":{"cpu":"15m","memory":"50Mi"}},"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources"},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs"}],"livenessProbe":{"httpGet":{"path":"healthz","port":10259,"scheme":"HTTPS"},"initialDelaySeconds":45},"readinessProbe":{"httpGet":{"path":"healthz","port":10259,"scheme":"HTTPS"},"initialDelaySeconds":45},"terminationMessagePolicy":"FallbackToLogsOnError","imagePullPolicy":"IfNotPresent"},{"name":"kube-scheduler-cert-syncer","image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:68ed6ae84719afd9c0d17f918a0c09212700f039b39e9b60d96a0624da7cc7ff","command":["cluster-kube-scheduler-operator","cert-syncer"],"args":["--kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig","--namespace=$(POD_NAMESPACE)","--destination-dir=/etc/kubernetes/static-pod-certs"],"env":[{"name":"POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"resources":{"requests":{"cpu":"5m","memory":"50Mi"}},"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources"},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs"}],"terminationMessagePolicy":"FallbackToLogsOnError","imagePullPolicy":"IfNotPresent"},{"name":"kube-scheduler-recovery-controller","image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:68ed6ae84719afd9c0d17f918a0c09212700f039b39e9b60d96a0624da7cc7ff","command":["/bin/bash","-euxo","pipefail","-c"],"args":["timeout 3m /bin/bash -exuo pipefail -c 'while [ -n \"$(ss -Htanop \\( sport = 11443 \\))\" ]; do sleep 1; done'\n\nexec cluster-kube-scheduler-operator cert-recovery-controller --kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig --namespace=${POD_NAMESPACE} --listen=0.0.0.0:11443 -v=2\n"],"env":[{"name":"POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}],"resources":{"requests":{"cpu":"5m","memory":"50Mi"}},"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources"},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs"}],"terminationMessagePolicy":"FallbackToLogsOnError","imagePullPolicy":"IfNotPresent"}],"hostNetwork":true,"tolerations":[{"operator":"Exists"}],"priorityClassName":"system-node-critical"},"status":{}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_scheduler_no_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-scheduler/configmaps/kube-scheduler-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>5262</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_secrets_consider_external_storage" id=rule-detail-idm45420686569008><div class="keywords sr-only">Consider external secret storagexccdf_org.ssgproject.content_rule_secrets_consider_external_storage medium</div><div class=panel-heading><h3 class=panel-title>Consider external secret storage</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_secrets_consider_external_storage</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.4.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Consider the use of an external secrets storage and management system,
instead of using Kubernetes Secrets directly, if you have more complex
secret management needs. Ensure the solution requires authentication to
access secrets, has auditing of access to and use of secrets, and encrypts
secrets. Some solutions also make it easier to rotate secrets.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Kubernetes supports secrets as first-class objects, but care needs to be
taken to ensure that access to secrets is carefully limited. Using an
external secrets provider can ease the management of access to secrets,
especially where secrets are used across both Kubernetes and non-Kubernetes
environments.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_secrets_no_environment_variables" id=rule-detail-idm45420686566352><div class="keywords sr-only">Do Not Use Environment Variables with Secretsxccdf_org.ssgproject.content_rule_secrets_no_environment_variables medium</div><div class=panel-heading><h3 class=panel-title>Do Not Use Environment Variables with Secrets</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_secrets_no_environment_variables</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.4.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Secrets should be mounted as data volumes instead of environment
variables.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Environment variables are subject and very susceptible to
malicious hijacking methods by an adversary, as such,
environment variables should never be used for secrets.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_client_ca" id=rule-detail-idm45420686563696><div class="keywords sr-only">Configure the Client Certificate Authority for the API Serverxccdf_org.ssgproject.content_rule_api_server_client_ca mediumCCE-84284-9</div><div class=panel-heading><h3 class=panel-title>Configure the Client Certificate Authority for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_client_ca</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_client_ca:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84284-9">CCE-84284-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.31</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>Certificates must be provided to fully setup TLS client certificate
authentication. To ensure the API Server utilizes its own TLS certificates, the
<code>clientCA</code> must be configured. Verify
that <code>servingInfo</code> has the <code>clientCA</code> configured in
the <code>openshift-kube-apiserver</code> <code>config</code> configmap
to something similar to:<pre>
"apiServerArguments": {
  ...
    "client-ca-file": [
      "/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"
    ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>API Server communication contains sensitive parameters that should remain
encrypted in transit. Configure the API Server to serve only HTTPS traffic.
If <code>-clientCA</code> is set, any request presenting a client
certificate signed by one of the authorities in the <code>client-ca-file</code>
is authenticated with an identity corresponding to the <i>CommonName</i> of
the client certificate.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_client_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_client_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_request_timeout" id=rule-detail-idm45420686558704><div class="keywords sr-only">Configure the API Server Minimum Request Timeoutxccdf_org.ssgproject.content_rule_api_server_request_timeout medium</div><div class=panel-heading><h3 class=panel-title>Configure the API Server Minimum Request Timeout</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_request_timeout</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_request_timeout:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.26</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The API server minimum request timeout defines the minimum number of
seconds a handler must keep a request open before timing it out. To set this,
edit the <code>openshift-kube-apiserver</code> configmap and set
<code>min-request-timeout</code> under the <code>apiServerArguments</code> field:<pre>
"apiServerArguments":{
  ...
  "min-request-timeout":[
    <abbr title="from TestResult: xccdf_org.ssgproject.content_value_var_api_min_request_timeout">3600</abbr>
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Setting global request timout allows extending the API Server request
timeout limit to a duration appropriate to the user's connection speed. By
default, it is set to 1800 seconds which might not be suitable for some
environments. Setting the limit too low may result in excessive timeouts,
and a limit that is too large may exhaust the API Server resources making
it prone to Denial-of-Service attack. It is recommended to set this limit
as appropriate and change the default limit of 1800 seconds only if needed.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">Variable test to check XCCDF variable</span>
<span class="label label-default">oval:ssg-test_api_server_request_timeout:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Var ref</th><th>Value</th></tr></thead><tbody><tr><td>oval:ssg-local_variable_api_server_request_timeout:var:1</td><td>3600</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_request_timeout:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysPullImages" id=rule-detail-idm45420686553504><div class="keywords sr-only">Ensure that the Admission Control Plugin AlwaysPullImages is not setxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysPullImages high</div><div class=panel-heading><h3 class=panel-title>Ensure that the Admission Control Plugin AlwaysPullImages is not set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysPullImages</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_AlwaysPullImages:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.12</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The <code>AlwaysPullImages</code> admission control plugin should be disabled,
since it can introduce new failure modes for control plane components if an
image registry is unreachable.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Setting admission control policy to AlwaysPullImages forces every new pod
to pull the required images every time. In a multi-tenant cluster users can
be assured that their private images can only be used by those who have the
credentials to pull them. Without this admission control policy, once an
image has been pulled to a node, any pod from any user can use it simply by
knowing the images name, without any authorization check against the image
ownership. When this plug-in is enabled, images are always pulled prior to
starting containers, which means valid credentials are required.
However, turning on this admission plugin can introduce new kinds of
cluster failure modes. OpenShift 4 master and infrastructure components are
deployed as pods. Enabling this feature can result in cases where loss of
contact to an image registry can cause a redeployed infrastructure pod
(oauth-server for example) to fail on an image pull for an image that is
currently present on the node. We use PullIfNotPresent so that a loss of
image registry access does not prevent the pod from starting. If it
becomes PullAlways, then an image registry access outage can cause key
infrastructure components to fail.
The pull policy can be managed per container, using
<code>imagePullPolicy</code>.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_AlwaysPullImages:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_AlwaysPullImages:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_bind_address" id=rule-detail-idm45420686549152><div class="keywords sr-only">Ensure that the bindAddress is set to a relevant secure portxccdf_org.ssgproject.content_rule_api_server_bind_address lowCCE-83646-0</div><div class=panel-heading><h3 class=panel-title>Ensure that the bindAddress is set to a relevant secure port</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_bind_address</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_bind_address:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>low</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83646-0">CCE-83646-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.20</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The bindAddress is set by default to <code>0.0.0.0:6443</code>, and listening with TLS enabled.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The OpenShift API server is served over HTTPS with authentication and authorization;
the secure API endpoint is bound to <code>0.0.0.0:6443</code> by default. In OpenShift, the only
supported way to access the API server pod is through the load balancer and then through
the internal service. The value is set by the bindAddress argument under the servingInfo
parameter.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_service_account_public_key" id=rule-detail-idm45420686544176><div class="keywords sr-only">Configure the Service Account Public Key for the API Serverxccdf_org.ssgproject.content_rule_api_server_service_account_public_key mediumCCE-83350-9</div><div class=panel-heading><h3 class=panel-title>Configure the Service Account Public Key for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_service_account_public_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_service_account_public_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83350-9">CCE-83350-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.28</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the API Server utilizes its own key pair,
edit the <code>openshift-kube-apiserver</code> configmap
and set the <code>serviceAccountPublicKeyFiles</code> parameter to the public
key file for service accounts:<pre>
...
"serviceAccountPublicKeyFiles":[
  "/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs"
],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default if no <code>service-account-key-file</code> is specified
to the apiserver, it uses the private key from the TLS serving
certificate to verify service account tokens. To ensure that the
keys for service account tokens are rotated as needed, a
separate public/private key pair should be used for signing service
account tokens.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_service_account_public_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_service_account_public_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled" id=rule-detail-idm45420686539152><div class="keywords sr-only">Ensure all admission control plugins are enabledxccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled mediumCCE-83799-7</div><div class=panel-heading><h3 class=panel-title>Ensure all admission control plugins are enabled</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_no_adm_ctrl_plugins_disabled:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83799-7">CCE-83799-7</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.13</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.14</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.14</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.15</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.16</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.17</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To make sure none of them is explicitly disabled, run the following command:<pre>$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data."config.yaml"' | jq '.apiServerArguments."disable-admission-plugins"'</pre>and make sure the output is empty.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Several hardening controls depend on certain API server admission plugins
being enabled. Checking that no admission control plugins are disabled
helps assert that all the critical admission control plugins are indeed
enabled and providing the security benefits required.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_no_adm_ctrl_plugins_disabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_no_adm_ctrl_plugins_disabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-fail rule-detail-id-xccdf_org.ssgproject.content_rule_audit_log_forwarding_enabled" id=rule-detail-idm45420686534112><div class="keywords sr-only">Ensure that Audit Log Forwarding Is Enabledxccdf_org.ssgproject.content_rule_audit_log_forwarding_enabled mediumCCE-84076-9</div><div class=panel-heading><h3 class=panel-title>Ensure that Audit Log Forwarding Is Enabled</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_audit_log_forwarding_enabled</td></tr><tr><td>Result</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-audit_log_forwarding_enabled:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84076-9">CCE-84076-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.23</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(12)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-6(3)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-9(2)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SI-4(16)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-4(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-11</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-7(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>OpenShift audit works at the API server level, logging all requests coming to the server.
Audit is on by default and the best practice is to ship audit logs off the cluster for retention.
The cluster-logging-operator is able to do this with the<pre>ClusterLogForwarders</pre>resource.
The forementioned resource can be configured to logs to different third party systems.
For more information on this, please reference the official documentation:
<a href=https://docs.openshift.com/container-platform/4.6/logging/cluster-logging-external.html>https://docs.openshift.com/container-platform/4.6/logging/cluster-logging-external.html</a></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Retaining logs ensures the ability to go back in time to investigate or correlate any events.
Offloading audit logs from the cluster ensures that an attacker that has access to the cluster will not be able to
tamper with the logs because of the logs being stored off-site.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance' find only one object at path 'spec.pipelines[:].inputRefs[:]'.</span>
<span class="label label-default">oval:ssg-test_audit_log_forwarding_enabled:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_audit_log_forwarding_enabled:obj:1</abbr></strong> of type
<strong>yamlfilecontent_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Yamlpath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance</td></tr></table></td><td>spec.pipelines[:].inputRefs[:]</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance').</span>
<span class="label label-default">oval:ssg-test_file_for_audit_log_forwarding_enabled:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_file_for_audit_log_forwarding_enabled:obj:1</abbr></strong> of type
<strong>file_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/logging.openshift.io/v1/namespaces/openshift-logging/clusterlogforwarders/instance</td></tr></table></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites" id=rule-detail-idm45420686529088><div class="keywords sr-only">Use Strong Cryptographic Ciphers on the API Serverxccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites medium</div><div class=panel-heading><h3 class=panel-title>Use Strong Cryptographic Ciphers on the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_tls_cipher_suites:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.35</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure that the API Server is configured to only use strong
cryptographic ciphers, verify the <code>openshift-kube-apiserver</code>
configmap contains the following set of ciphers, with no additions:<pre>
"servingInfo":{
  ...
  "cipherSuites": [
    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256",
    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256",
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>TLS ciphers have had a number of known vulnerabilities and weaknesses,
which can reduce the protection provided. By default, OpenShift supports
a number of TLS ciphersuites including some that have security concerns,
weakening the protection provided.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
Once configured, API Server clients that cannot support modern
cryptographic ciphers will not be able to make connections to the API
server.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_tls_cipher_suites:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_tls_cipher_suites:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac" id=rule-detail-idm45420686524768><div class="keywords sr-only">Ensure authorization-mode RBAC is configuredxccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac mediumCCE-84102-3</div><div class=panel-heading><h3 class=panel-title>Ensure authorization-mode RBAC is configured</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_auth_mode_rbac:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84102-3">CCE-84102-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.9</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure OpenShift restricts different identities to a defined set
of operations they are allowed to perform, check that the API server's
<code>authorization-mode</code> configuration option list containst RBAC.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Role Based Access Control (RBAC) allows fine-grained control over the
operations that different entities can perform on different objects in
the cluster. Enabling RBAC is critical in regulating access to an
OpenShift cluster as the RBAC rules specify, given a user, which operations
can be executed over a set of namespaced or cluster-wide resources.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_auth_mode_rbac:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_auth_mode_rbac:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_tls_cert" id=rule-detail-idm45420686519744><div class="keywords sr-only">Configure the Certificate for the API Serverxccdf_org.ssgproject.content_rule_api_server_tls_cert mediumCCE-83779-9</div><div class=panel-heading><h3 class=panel-title>Configure the Certificate for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_tls_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_tls_cert:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83779-9">CCE-83779-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.30</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the API Server utilizes its own TLS certificates, the
<code>tls-cert-file</code> must be configured. Verify
that the <code>apiServerArguments</code> section has the <code>tls-cert-file</code> configured in
the <code>config</code> configmap in the <code>openshift-kube-apiserver</code> namespace
similar to:<pre>
"apiServerArguments":{
...
"tls-cert-file": [
  "/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"
],
...
}
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>API Server communication contains sensitive parameters that should remain
encrypted in transit. Configure the API Server to serve only HTTPS
traffic.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_tls_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_tls_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn" id=rule-detail-idm45420686514752><div class="keywords sr-only">Ensure that the --kubelet-https argument is set to truexccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn medium</div><div class=panel-heading><h3 class=panel-title>Ensure that the --kubelet-https argument is set to true</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_https_for_kubelet_conn:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:20:59+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The kube-apiserver ensures https to the kubelet by default. The apiserver
flag "--kubelet-https" is deprecated and should be either set to "true" or
omitted from the argument list.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Connections from the kube-apiserver to kubelets could potentially carry
sensitive data such as secrets and keys. It is thus important to use
in-transit encryption for any communication between the apiserver and
kubelets.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_https_for_kubelet_conn:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_https_for_kubelet_conn:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize" id=rule-detail-idm45420686510432><div class="keywords sr-only">Configure Kubernetes API Server Maximum Audit Log Sizexccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize mediumCCE-83607-2</div><div class=panel-heading><h3 class=panel-title>Configure Kubernetes API Server Maximum Audit Log Size</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_audit_log_maxsize:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83607-2">CCE-83607-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.25</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To rotate audit logs upon reaching a maximum size,
edit the <code>openshift-kube-apiserver</code> configmap
and set the <code>audit-log-maxsize</code> parameter to
an appropriate size in MB. For example, to set it to 100 MB:<pre>
"apiServerArguments":{
  ...
  "audit-log-maxsize": ["100"],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>OpenShift automatically rotates log files. Retaining old log files ensures that
OpenShift Operators have sufficient log data available for carrying out any
investigation or correlation. If you have set file size of 100 MB and the number of
old log files to keep as 10, there would be approximately 1 GB of log data
available for use in analysis.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_audit_log_maxsize:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_audit_log_maxsize:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert" id=rule-detail-idm45420686505408><div class="keywords sr-only">Configure the kubelet Certificate File for the API Serverxccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert highCCE-84080-1</div><div class=panel-heading><h3 class=panel-title>Configure the kubelet Certificate File for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_kubelet_client_cert:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84080-1">CCE-84080-1</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To enable certificate based kubelet authentication,
edit the <code>config</code> configmap in the <code>openshift-kube-apiserver</code>
namespace and set the below parameter in the <code>config.yaml</code> key if
it is not already configured:<pre>
"apiServerArguments":{
...
  "kubelet-client-certificate":"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt",
...
}
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default the API Server does not authenticate itself to the kublet's
HTTPS endpoints. Requests from the API Server are treated anonymously.
Configuring certificate-based kubelet authentication ensures that the
API Server authenticates itself to kubelets when submitting requests.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_kubelet_client_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_kubelet_client_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_basic_auth" id=rule-detail-idm45420686500384><div class="keywords sr-only">Disable basic-auth-file for the API Serverxccdf_org.ssgproject.content_rule_api_server_basic_auth mediumCCE-83936-5</div><div class=panel-heading><h3 class=panel-title>Disable basic-auth-file for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_basic_auth</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_basic_auth:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83936-5">CCE-83936-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Basic Authentication should not be used for any reason. If needed, edit API
Edit the <code>openshift-kube-apiserver</code> configmap
and remove the <code>basic-auth-file</code> parameter:<pre>
"apiServerArguments":{
  ...
  "basic-auth-file":[
    "/path/to/any/file"
  ],
  ...
</pre>Alternate authentication mechanisms such as tokens and certificates will need to be
used. Username and password for basic authentication will be disabled.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Basic authentication uses plaintext credentials for authentication.
Currently the basic authentication credentials last indefinitely, and
the password cannot be changed without restarting the API Server. The
Basic Authentication is currently supported for convenience and is
not intended for production workloads.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_basic_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_basic_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NodeRestriction" id=rule-detail-idm45420686495392><div class="keywords sr-only">Enable the NodeRestriction Admission Control Pluginxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NodeRestriction mediumCCE-83753-4</div><div class=panel-heading><h3 class=panel-title>Enable the NodeRestriction Admission Control Plugin</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NodeRestriction</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_NodeRestriction:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83753-4">CCE-83753-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.17</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To limit the <code>Node</code> and <code>Pod</code> objects that a kubelet could modify,
ensure that the <code>NodeRestriction</code> plugin on kubelets is enabled in
the api-server configuration by running the following command:<pre>$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data."config.yaml"' | jq '.apiServerArguments."enable-admission-plugins"'</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Using the <code>NodeRestriction</code> plugin ensures that the kubelet is
restricted to the <code>Node</code> and <code>Pod</code> objects that it could
modify as defined. Such kubelets will only be allowed to modify their
own <code>Node</code> API object, and only modify <code>Pod</code> API objects
that are bound to their node.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_NodeRestriction:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_NodeRestriction:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa" id=rule-detail-idm45420686490336><div class="keywords sr-only">The authorization-mode cannot be AlwaysAllowxccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa mediumCCE-84207-0</div><div class=panel-heading><h3 class=panel-title>The authorization-mode cannot be AlwaysAllow</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_auth_mode_no_aa:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84207-0">CCE-84207-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Do not always authorize all requests.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_auth_mode_no_aa:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_auth_mode_no_aa:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_service_account_lookup" id=rule-detail-idm45420686485312><div class="keywords sr-only">Ensure that the service-account-lookup argument is set to truexccdf_org.ssgproject.content_rule_api_server_service_account_lookup mediumCCE-83370-7</div><div class=panel-heading><h3 class=panel-title>Ensure that the service-account-lookup argument is set to true</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_service_account_lookup</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_service_account_lookup:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83370-7">CCE-83370-7</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.27</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Validate service account before validating token.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>If <code>service-account-lookup</code> is not enabled, the apiserver
only verifies that the authentication token is valid, and
does not validate that the service account token mentioned
in the request is actually present in etcd. This allows
using a service account token even after the corresponding
service account is deleted. This is an example of time of
check to time of use security issue.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_service_account_lookup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_service_account_lookup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_auth_mode_node" id=rule-detail-idm45420686480288><div class="keywords sr-only">Ensure authorization-mode Node is configuredxccdf_org.ssgproject.content_rule_api_server_auth_mode_node mediumCCE-83889-6</div><div class=panel-heading><h3 class=panel-title>Ensure authorization-mode Node is configured</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_auth_mode_node</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_auth_mode_node:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83889-6">CCE-83889-6</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Restrict kubelet nodes to reading only objects associated with them.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The Node authorization mode only allows kubelets to read Secret,
ConfigMap, PersistentVolume, and PersistentVolumeClaim objects
associated with their nodes.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_auth_mode_node:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_auth_mode_node:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_insecure_bind_address" id=rule-detail-idm45420686475264><div class="keywords sr-only">Disable Use of the Insecure Bind Addressxccdf_org.ssgproject.content_rule_api_server_insecure_bind_address mediumCCE-83955-5</div><div class=panel-heading><h3 class=panel-title>Disable Use of the Insecure Bind Address</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_insecure_bind_address</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_insecure_bind_address:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83955-5">CCE-83955-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.18</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>OpenShift should not bind to non-loopback insecure addresses.
Edit the <code>openshift-kube-apiserver</code> configmap
and remove the <code>insecure-bind-address</code> if it exists:<pre>
"apiServerArguments":{
  ...
  "insecure-bind-address":[
    "127.0.0.1"
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>If the API Server is bound to an insecure address the installation would
be susceptible to unauthented and unencrypted access to the master node(s).
The API Server does not perform authentication checking for insecure
binds and the traffic is generally not encrypted.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_insecure_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_insecure_bind_address:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled" id=rule-detail-idm45420686470240><div class="keywords sr-only">Enable the APIPriorityAndFairness feature gatexccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled mediumCCE-83656-9</div><div class=panel-heading><h3 class=panel-title>Enable the APIPriorityAndFairness feature gate</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_api_priority_gate_enabled:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83656-9">CCE-83656-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.10</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To limit the rate at which the API Server accepts requests, make
sure that the API Priority and Fairness feature is enabled.
Using <code>APIPriorityAndFairness</code> feature provides a fine-grained way
to control the behaviour of the Kubernetes API server in an overload
situation. To enable the <code>APIPriorityAndFairness</code> feature gate,
make sure that the <code>feature-gates</code> API server argument, typically
set in the <code>config</code> configMap in the <code>openshift-kube-apiserver</code>
namespace contains <code>APIPriorityAndFairness=true</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The <code>APIPriorityAndFairness</code> feature gate enables the use of the
<code>FlowSchema</code> API objects which enforce a limit on the number of
events that the API Server will accept in a given time slice In a large
multi-tenant cluster, there might be a small percentage of misbehaving
tenants which could have a significant impact on the performance of
the cluster overall. It is recommended to limit the rate of events
that the API Server will accept.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/operator.openshift.io/v1/kubeapiservers/cluster</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/operator.openshift.io/v1/kubeapiservers/cluster</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/operator.openshift.io/v1/kubeapiservers/cluster' find only one object at path '.spec.observedConfig.apiServerArguments["feature-gates"][:]'.</span>
<span class="label label-default">oval:ssg-test_api_server_api_priority_gate_enabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/operator.openshift.io/v1/kubeapiservers/cluster</td><td>/kubernetes-api-resources/apis/operator.openshift.io/v1/kubeapiservers</td><td>cluster</td><td>.spec.observedConfig.apiServerArguments["feature-gates"][:]</td><td>APIPriorityAndFairness=true
RotateKubeletServerCertificate=true
SupportPodPidsLimit=true
NodeDisruptionExclusion=true
ServiceNodeExclusion=true
SCTPSupport=true
LegacyNodeRoleBehavior=false
RemoveSelfLink=false</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/operator.openshift.io/v1/kubeapiservers/cluster').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_api_priority_gate_enabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/operator.openshift.io/v1/kubeapiservers/cluster</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>9727</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority" id=rule-detail-idm45420686465216><div class="keywords sr-only">Configure the kubelet Certificate Authority for the API Serverxccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority highCCE-84196-5</div><div class=panel-heading><h3 class=panel-title>Configure the kubelet Certificate Authority for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_kubelet_certificate_authority:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84196-5">CCE-84196-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure OpenShift verifies kubelet certificates before establishing
connections, follow the OpenShift documentation and setup the TLS connection
between the API Server and kubelets.
Edit the <code>openshift-kube-apiserver</code> configmap
and set the below parameter if it is not already configured:<pre>
"apiServerArguments":{
  ...
  "kubelet-certificate-authority":"/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt",
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Connections from the API Server to the kubelet are used for fetching logs
for pods, attaching (through kubectl) to running pods, and using the kubelet
port-forwarding functionality. These connections terminate at the kubelet
HTTPS endpoint. By default, the API Server does not verify the kubelet serving
certificate, which makes the connection subject to man-in-the-middle attacks,
and unsafe to run over untrusted and/or public networks.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_kubelet_certificate_authority:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_kubelet_certificate_authority:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_SecurityContextDeny" id=rule-detail-idm45420686460176><div class="keywords sr-only">Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not usedxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_SecurityContextDeny mediumCCE-83586-8</div><div class=panel-heading><h3 class=panel-title>Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_SecurityContextDeny</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_SecurityContextDeny:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83586-8">CCE-83586-8</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.13</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Instead of using a customized SecurityContext for pods, a Pod Security
Policy (PSP) or a SecurityContextConstraint should be used. These are
cluster-level resources that control the actions that a pod can perform
and what resource the pod may access. The <code>SecurityContextDeny</code>
disallows folks from setting a pod's <code>securityContext</code> fields.
Ensure that the list of admission controllers does not include
SecurityContextDeny:<pre>$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data."config.yaml"' | jq '.apiServerArguments."enable-admission-plugins"' </pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The <code>SecurityContextDeny</code> admission control plugin disallows
setting any security options for your pods. <code>SecurityContextConstraints</code>
allow you to enforce RBAC rules on who can set these options on the pods, and
what they're allowed to set. Thus, using the <code>SecurityContextDeny</code>
will deter you from enforcing granular permissions on your pods.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_SecurityContextDeny:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_SecurityContextDeny:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-fail rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_encryption_provider_cipher" id=rule-detail-idm45420686455104><div class="keywords sr-only">Configure the Encryption Provider Cipherxccdf_org.ssgproject.content_rule_api_server_encryption_provider_cipher medium</div><div class=panel-heading><h3 class=panel-title>Configure the Encryption Provider Cipher</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_encryption_provider_cipher</td></tr><tr><td>Result</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_encryption_provider_cipher:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.34</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-28</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-28(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the correct cipher, set the encryption type <code>aescbc</code> in the
<code>apiserver</code> object which configures the API server itself.<pre>
spec:
  encryption:
    type: aescbc
</pre>For more information, follow
<a href=https://docs.openshift.com/container-platform/4.6/security/encrypting-etcd.html>the relevant documentation</a>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale><code>aescbc</code> is currently the strongest encryption provider, it should
be preferred over other providers.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/config.openshift.io/v1/apiservers/cluster</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/config.openshift.io/v1/apiservers/cluster</code> file.</div></div></td></tr><tr class=noprint><td colspan=2><div class=remediation><a class="btn btn-success" data-toggle=collapse data-target=#idm45420683111408 tabindex=0 role=button aria-expanded=false title="Activate to reveal" href=#!>Remediation script </a><br><div class="panel-collapse collapse" id=idm45420683111408><pre><code>---
apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  encryption:
    type: aescbc
</code></pre></div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/config.openshift.io/v1/apiservers/cluster' find only one object at path '.spec.encryption.type'.</span>
<span class="label label-default">oval:ssg-test_api_server_encryption_provider_cipher:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_api_server_encryption_provider_cipher:obj:1</abbr></strong> of type
<strong>yamlfilecontent_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Yamlpath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td></tr></table></td><td>.spec.encryption.type</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/config.openshift.io/v1/apiservers/cluster').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_encryption_provider_cipher:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>869</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac" id=rule-detail-idm45420686450784><div class="keywords sr-only">Profiling is protected by RBACxccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac mediumCCE-84212-0</div><div class=panel-heading><h3 class=panel-title>Profiling is protected by RBAC</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_profiling_protected_by_rbac:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84212-0">CCE-84212-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.21</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Ensure that the cluster-debugger cluster role includes the /metrics
resource URL. This demonstrates that profiling is protected by RBAC, with a
specific cluster role to allow access.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Profiling allows for the identification of specific performance bottlenecks.
It generates a significant amount of program data that could potentially be
exploited to uncover system and program details.
To ensure the collected data is not exploited, profiling endpoints are secured
via RBAC (see cluster-debugger role). By default, the profiling endpoints are
accessible only by users bound to cluster-admin or cluster-debugger role.
Profiling can not be disabled.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger' find only one object at path '.rules[0].nonResourceURLs[:]'.</span>
<span class="label label-default">oval:ssg-test_api_server_profiling_protected_by_rbac:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</td><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles</td><td>cluster-debugger</td><td>.rules[0].nonResourceURLs[:]</td><td>/debug/pprof
/debug/pprof/*
/metrics</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_profiling_protected_by_rbac:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>773</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_anonymous_auth" id=rule-detail-idm45420686445744><div class="keywords sr-only">Ensure that anonymous requests to the API Server are authorizedxccdf_org.ssgproject.content_rule_api_server_anonymous_auth medium</div><div class=panel-heading><h3 class=panel-title>Ensure that anonymous requests to the API Server are authorized</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_anonymous_auth</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_anonymous_auth:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>By default, anonymous access to the OpenShift API is enabled, but at
the same time, all requests must be authorized. If no authentication
mechanism is used, the request is assigned the <code>system:anonymous</code>
virtual user and the <code>system:unauthenticated</code> virtual group.
This allows the authorization layer to determin which requests, if any,
is an anonymous user authorized to make.
To verify the authorization rules for anonymous requests run the following:<pre>$ oc describe clusterrolebindings</pre>and inspect the bidnings of the <code>system:anonymous</code>
virtual user and the <code>system:unauthenticated</code> virtual group.
To test that an anonymous request is authorized to access the <code>readyz</code>
endpoint, run:<pre>$ oc get --as="system:anonymous" --raw='/readyz?verbose'</pre>In contrast, a request to list all projects should not be authorized:<pre>$ oc get --as="system:anonymous" projects</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>When enabled, requests that are not rejected by other configured
authentication methods are treated as anonymous requests. These requests
are then served by the API server. If you are using RBAC authorization,
it is generally considered reasonable to allow anonymous access to the
API Server for health checks and discovery purposes, and hence this
recommendation is not scored. However, you should consider whether
anonymous discovery is an acceptable risk for your purposes.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/rbac.authorization.k8s.io/v1/clusterrolebindings' find only one object at path '.items[:]['subjects'][:].name'.</span>
<span class="label label-default">oval:ssg-test_api_server_anonymous_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterrolebindings</td><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1</td><td>clusterrolebindings</td><td>.items[:]['subjects'][:].name</td><td>alertmanager-main</td><td>strimzi-cluster-operator</td><td>strimzi-cluster-operator</td><td>system:authenticated</td><td>cloud-credential-operator</td><td>system:masters</td><td>admin</td><td>system:cluster-admins
system:admin</td><td>cluster-autoscaler</td><td>cluster-autoscaler-operator</td><td>cluster-baremetal-operator</td><td>cluster-monitoring-operator</td><td>cluster-node-tuning-operator</td><td>tuned</td><td>system:cluster-readers</td><td>cluster-samples-operator</td><td>cluster-samples-operator</td><td>system:authenticated</td><td>cluster-storage-operator</td><td>default</td><td>compliance-operator</td><td>api-resource-collector</td><td>console</td><td>system:authenticated</td><td>console-operator</td><td>console-operator</td><td>csi-snapshot-controller-operator</td><td>cluster-image-registry-operator</td><td>default</td><td>default</td><td>prometheus-k8s</td><td>grafana</td><td>system:authenticated</td><td>operator</td><td>operator</td><td>gather</td><td>gather</td><td>kube-apiserver
system:kube-apiserver</td><td>kube-state-metrics</td><td>machine-api-controllers</td><td>machine-api-operator</td><td>machine-config-controller</td><td>machine-config-daemon</td><td>machine-config-server</td><td>marketplace-operator</td><td>metrics-daemon-sa</td><td>multus</td><td>multus</td><td>multus</td><td>network-diagnostics</td><td>node-exporter</td><td>olm-operator-serviceaccount</td><td>csi-snapshot-controller</td><td>dns</td><td>dns-operator</td><td>pruner</td><td>ingress-operator</td><td>router</td><td>ovn-kubernetes-controller</td><td>ovn-kubernetes-node</td><td>openshift-state-metrics</td><td>olm-operator-serviceaccount</td><td>postgres-operator</td><td>prometheus-adapter</td><td>prometheus-adapter</td><td>prometheus-k8s</td><td>prometheus-k8s</td><td>prometheus-operator</td><td>prometheus-k8s</td><td>registry</td><td>prometheus-adapter</td><td>prometheus-k8s</td><td>nfs-client-provisioner</td><td>system:authenticated
system:unauthenticated</td><td>system:authenticated:oauth</td><td>apicurio-registry-operator</td><td>apicurio-registry-operator</td><td>kube-storage-version-migrator-sa</td><td>node-bootstrapper</td><td>system:nodes</td><td>system:authenticated</td><td>system:authenticated</td><td>system:authenticated</td><td>system:authenticated</td><td>attachdetach-controller</td><td>certificate-controller</td><td>clusterrole-aggregation-controller</td><td>cronjob-controller</td><td>daemon-set-controller</td><td>deployment-controller</td><td>disruption-controller</td><td>endpoint-controller</td><td>endpointslice-controller</td><td>endpointslicemirroring-controller</td><td>expand-controller</td><td>generic-garbage-collector</td><td>horizontal-pod-autoscaler
horizontal-pod-autoscaler</td><td>job-controller</td><td>namespace-controller</td><td>node-controller</td><td>persistent-volume-binder</td><td>pod-garbage-collector</td><td>pv-protection-controller</td><td>pvc-protection-controller</td><td>replicaset-controller</td><td>replication-controller</td><td>resourcequota-controller</td><td>root-ca-cert-publisher</td><td>route-controller</td><td>service-account-controller</td><td>service-controller</td><td>statefulset-controller</td><td>ttl-controller</td><td>default-rolebindings-controller</td><td>system:authenticated</td><td>default-rolebindings-controller</td><td>default-rolebindings-controller</td><td>system:kube-controller-manager</td><td>kube-dns</td><td>system:kube-scheduler</td><td>system:masters</td><td>system:monitoring</td><td>system:master
system:kube-apiserver
system:node-admins</td><td>system:master
system:node-admins</td><td>node-bootstrapper</td><td>system:kube-proxy</td><td>system:nodes</td><td>system:authenticated
system:unauthenticated</td><td>build-config-change-controller</td><td>build-controller</td><td>cluster-quota-reconciliation-controller</td><td>default-rolebindings-controller</td><td>deployer-controller</td><td>deploymentconfig-controller</td><td>horizontal-pod-autoscaler</td><td>image-import-controller</td><td>image-trigger-controller</td><td>system:serviceaccount:openshift-kube-apiserver:check-endpoints</td><td>system:serviceaccount:openshift-kube-apiserver:check-endpoints</td><td>system:serviceaccount:openshift-kube-apiserver:check-endpoints</td><td>machine-approver-sa</td><td>namespace-security-allocation-controller</td><td>origin-namespace-controller</td><td>pv-recycler-controller</td><td>resourcequota-controller</td><td>service-ca</td><td>service-ingress-ip-controller</td><td>service-serving-cert-controller</td><td>serviceaccount-controller</td><td>serviceaccount-pull-secrets-controller</td><td>template-instance-controller</td><td>template-instance-controller</td><td>template-instance-finalizer-controller</td><td>template-instance-finalizer-controller</td><td>template-service-broker</td><td>unidling-controller</td><td>system:authenticated</td><td>cloud-provider</td><td>oauth-apiserver-sa</td><td>openshift-apiserver-sa</td><td>oauth-openshift</td><td>openshift-controller-manager-sa</td><td>ingress-to-route-controller</td><td>authentication-operator</td><td>openshift-kube-scheduler-operator</td><td>etcd-operator</td><td>kube-apiserver-operator</td><td>localhost-recovery-client</td><td>kube-controller-manager-operator</td><td>localhost-recovery-client</td><td>localhost-recovery-client</td><td>openshift-kube-scheduler-sa</td><td>kube-storage-version-migrator-operator</td><td>openshift-apiserver-operator</td><td>openshift-config-operator</td><td>openshift-controller-manager-operator</td><td>installer-sa</td><td>installer-sa</td><td>installer-sa</td><td>installer-sa</td><td>service-ca-operator</td><td>system:authenticated
system:unauthenticated</td><td>openshift-controller-manager-sa</td><td>system:authenticated:oauth</td><td>system:authenticated
system:unauthenticated</td><td>system:authenticated
system:unauthenticated</td><td>system:nodes</td><td>system:serviceaccounts</td><td>system:kube-scheduler</td><td>system:authenticated
system:unauthenticated</td><td>telemeter-client</td><td>telemeter-client</td><td>thanos-querier</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/rbac.authorization.k8s.io/v1/clusterrolebindings').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_anonymous_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterrolebindings</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>214095</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert" id=rule-detail-idm45420686441424><div class="keywords sr-only">Ensure the openshift-oauth-apiserver service uses TLSxccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert medium</div><div class=panel-heading><h3 class=panel-title>Ensure the openshift-oauth-apiserver service uses TLS</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>By default, the OpenShift API Server uses TLS. HTTPS should be
used for connections between openshift-apiserver and kube-apiserver.
OpenShift API server enables TLS automatically if a TLS key and a
certificate are provided via the <code>serving-cert</code> secret
in the <code>openshift-apiserver</code> namespace.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Connections between the kube-apiserver and the extension
openshift-apiserver could potentially carry sensitive data such
as secrets and keys. It is important to use in-transit encryption
for any communication between the kube-apiserver and the extension
openshift-apiserver.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_tls_private_key" id=rule-detail-idm45420686438752><div class="keywords sr-only">Configure the Certificate Key for the API Serverxccdf_org.ssgproject.content_rule_api_server_tls_private_key mediumCCE-84282-3</div><div class=panel-heading><h3 class=panel-title>Configure the Certificate Key for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_tls_private_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_tls_private_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84282-3">CCE-84282-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.30</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the API Server utilizes its own TLS certificates, the
<code>tls-private-key-file</code> must be configured. Verify
that the <code>apiServerArguments</code> section has the <code>tls-private-key-file</code> configured in
the <code>config</code> configmap in the <code>openshift-kube-apiserver</code> namespace
similar to:<pre>
"apiServerArguments":{
...
"tls-private-key-file": [
  "/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"
],
...
}
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>API Server communication contains sensitive parameters that should remain
encrypted in transit. Configure the API Server to serve only HTTPS
traffic.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_tls_private_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_tls_private_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_path" id=rule-detail-idm45420686433728><div class="keywords sr-only">Configure the Audit Log Pathxccdf_org.ssgproject.content_rule_api_server_audit_log_path highCCE-84020-7</div><div class=panel-heading><h3 class=panel-title>Configure the Audit Log Path</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_audit_log_path</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_audit_log_path:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84020-7">CCE-84020-7</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.22</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To enable auditing on the Kubernetes API Server, the audit log path must be set.
Edit the <code>openshift-kube-apiserver</code> configmap
and set the <code>audit-log-path</code> to a suitable path and file
where audit logs should be written. For example:<pre>
"apiServerArguments":{
  ...
  "audit-log-path":"/var/log/kube-apiserver/audit.log",
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Auditing of the Kubernetes API Server is not enabled by default. Auditing the API Server
provides a security-relevant chronological set of records documenting the sequence
of activities that have affected the system by users, administrators, or other
system components.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_audit_log_path:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_audit_log_path:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all" id=rule-detail-idm45420686428704><div class="keywords sr-only">Ensure catch-all FlowSchema object for API Priority and Fairness Exists (v1alpha1)xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all mediumCCE-84002-5</div><div class=panel-heading><h3 class=panel-title>Ensure catch-all FlowSchema object for API Priority and Fairness Exists (v1alpha1)</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_api_priority_v1alpha1_flowschema_catch_all:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84002-5">CCE-84002-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.10</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Using <code>APIPriorityAndFairness</code> feature provides a fine-grained way
to control the behaviour of the Kubernetes API server in an overload
situation. The well-known FlowSchema <code>catch-all</code> should be available
to make sure that every request gets some kind of classification. By default,
the <code>catch-all</code> priority level only allows one concurrency share and
does not queue requests. To inspect all the <code>FlowSchema</code> objects, run:<pre>oc get flowschema</pre>To inspect the well-known <code>catch-all</code> object, run the following:<pre>oc describe flowschema catch-all</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The <code>FlowSchema</code> API objects enforce a limit on the
number of events that the API Server will accept in a given time slice
In a large multi-tenant cluster, there might be a small percentage of
misbehaving tenants which could have a significant impact on the
performance of the cluster overall. It is recommended to limit the rate
of events that the API Server will accept.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all</code> file.</div></div><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
Note that this rule is only applicable in OpenShift Container Platform
versions 4.7 and below.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all' find only one object at path '.spec.rules[0].subjects[:].group["name"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_api_priority_v1alpha1_flowschema_catch_all:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all</td><td>/kubernetes-api-resources/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas</td><td>catch-all</td><td>.spec.rules[0].subjects[:].group["name"]</td><td>system:unauthenticated
system:authenticated</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_api_priority_v1alpha1_flowschema_catch_all:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/flowcontrol.apiserver.k8s.io/v1alpha1/flowschemas/catch-all</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>1927</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-fail rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_encryption_provider_config" id=rule-detail-idm45420686423648><div class="keywords sr-only">Configure the Encryption Providerxccdf_org.ssgproject.content_rule_api_server_encryption_provider_config mediumCCE-83585-0</div><div class=panel-heading><h3 class=panel-title>Configure the Encryption Provider</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_encryption_provider_config</td></tr><tr><td>Result</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_encryption_provider_config:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83585-0">CCE-83585-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.33</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-28</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-28(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To encrypt the etcd key-value store, set the encryption type <code>aescbc</code> in the
<code>apiserver</code> object which configures the API server itself.<pre>
spec:
  encryption:
    type: aescbc
</pre>For more information, follow
<a href=https://docs.openshift.com/container-platform/4.6/security/encrypting-etcd.html>the relevant documentation</a>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>etcd is a highly available key-value store used by OpenShift deployments
for persistent storage of all REST API objects. These objects are
sensitive in nature and should be encrypted at rest to avoid any
disclosures.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/config.openshift.io/v1/apiservers/cluster</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/config.openshift.io/v1/apiservers/cluster</code> file.</div></div></td></tr><tr class=noprint><td colspan=2><div class=remediation><a class="btn btn-success" data-toggle=collapse data-target=#idm45420683001584 tabindex=0 role=button aria-expanded=false title="Activate to reveal" href=#!>Remediation script </a><br><div class="panel-collapse collapse" id=idm45420683001584><pre><code>---
apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  encryption:
    type: aescbc
</code></pre></div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/config.openshift.io/v1/apiservers/cluster' find only one object at path '.spec.encryption.type'.</span>
<span class="label label-default">oval:ssg-test_api_server_encryption_provider_config:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_api_server_encryption_provider_config:obj:1</abbr></strong> of type
<strong>yamlfilecontent_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Yamlpath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td></tr></table></td><td>.spec.encryption.type</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/config.openshift.io/v1/apiservers/cluster').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_encryption_provider_config:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>869</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup" id=rule-detail-idm45420686418624><div class="keywords sr-only">Configure the Kubernetes API Server Maximum Retained Audit Logsxccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup lowCCE-83739-3</div><div class=panel-heading><h3 class=panel-title>Configure the Kubernetes API Server Maximum Retained Audit Logs</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_audit_log_maxbackup:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>low</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83739-3">CCE-83739-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.24</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To configure how many rotations of audit logs are retained,
edit the <code>openshift-kube-apiserver</code> configmap
and set the <code>audit-log-maxbackup</code> parameter to
<code>10</code> or to an organizationally appropriate value:<pre>
"apiServerArguments":{
  ...
  "audit-log-maxbackup": [10],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>OpenShift automatically rotates the log files. Retaining old log files ensures
OpenShift Operators will have sufficient log data available for carrying out
any investigation or correlation. For example, if the audit log size is set to
100 MB and the number of retained log files is set to 10, OpenShift Operators
would have approximately 1 GB of log data to use during analysis.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_audit_log_maxbackup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_audit_log_maxbackup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_insecure_port" id=rule-detail-idm45420686413632><div class="keywords sr-only">Prevent Insecure Port Accessxccdf_org.ssgproject.content_rule_api_server_insecure_port mediumCCE-83813-6</div><div class=panel-heading><h3 class=panel-title>Prevent Insecure Port Access</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_insecure_port</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_insecure_port:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83813-6">CCE-83813-6</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.19</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>By default, traffic for the OpenShift API server is served over
HTTPS with authentication and authorization, and the secure API endpoint
is bound to <code>0.0.0.0:8443</code>. To ensure that the insecure port configuration
has not been enabled, the <code>insecure-port</code> parameter should be set to 0.
Edit the <code>openshift-kube-apiserver</code> configmap and change the
<code>insecure-port</code> value to 0:<pre>
"apiServerArguments":{
  ...
  "insecure-port":[
    "1234"
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Configuring the API Server on an insecure port would allow unauthenticated
and unencrypted access to your master node(s). It is assumed firewall rules
will be configured to ensure this port is not reachable from outside
the cluster, however as a defense in depth measure, OpenShift should not
be configured to use insecure ports.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_insecure_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_insecure_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_etcd_cert" id=rule-detail-idm45420686408624><div class="keywords sr-only">Configure the etcd Certificate for the API Serverxccdf_org.ssgproject.content_rule_api_server_etcd_cert mediumCCE-83876-3</div><div class=panel-heading><h3 class=panel-title>Configure the etcd Certificate for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_etcd_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_etcd_cert:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83876-3">CCE-83876-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.29</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure etcd is configured to make use of TLS encryption for client
communications, follow the OpenShift documentation and setup the TLS
connection between the API Server and etcd. Then, verify
that <code>apiServerArguments</code> has the <code>etcd-certfile</code> configured in
the <code>openshift-kube-apiserver</code> configmap to something similar to:<pre>
...
"etcd-certfile": [
    "/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"
],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>etcd is a highly-available key-value store used by OpenShift deployments
for persistent storage of all REST API objects. These objects are sensitive
in nature and should be protected by client authentication. This requires the
API Server to identify itself to the etcd server using a client certificate
and key.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_etcd_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_etcd_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key" id=rule-detail-idm45420686403632><div class="keywords sr-only">Configure the kubelet Certificate Key for the API Serverxccdf_org.ssgproject.content_rule_api_server_kubelet_client_key highCCE-83591-8</div><div class=panel-heading><h3 class=panel-title>Configure the kubelet Certificate Key for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_kubelet_client_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83591-8">CCE-83591-8</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To enable certificate based kubelet authentication,
edit the <code>config</code> configmap in the <code>openshift-kube-apiserver</code>
namespace and set the below parameter in the <code>config.yaml</code> key if
it is not already configured:<pre>
"apiServerArguments":{
...
  "kubelet-client-key":"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key",
...
}
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default the API Server does not authenticate itself to the kubelet's
HTTPS endpoints. Requests from the API Server are treated anonymously.
Configuring certificate-based kubelet authentication ensures that the
API Server authenticates itself to kubelets when submitting requests.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_kubelet_client_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_kubelet_client_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_token_auth" id=rule-detail-idm45420686398608><div class="keywords sr-only">Disable Token-based Authenticationxccdf_org.ssgproject.content_rule_api_server_token_auth highCCE-83481-2</div><div class=panel-heading><h3 class=panel-title>Disable Token-based Authentication</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_token_auth</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_token_auth:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83481-2">CCE-83481-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure OpenShift does not accept token-based authentication,
follow the OpenShift documentation and configure alternate mechanisms for
authentication. Then, edit the API Server pod specification file
Edit the <code>openshift-kube-apiserver</code> configmap
and remove the <code>token-auth-file</code> parameter:<pre>
"apiServerArguments":{
  ...
  "token-auth-file":[
    "/path/to/any/file"
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The token-based authentication utilizes static tokens to authenticate
requests to the API Server. The tokens are stored in clear-text in a file
on the API Server, and cannot be revoked or rotated without restarting the
API Server.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_token_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_token_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_ServiceAccount" id=rule-detail-idm45420686393616><div class="keywords sr-only">Enable the ServiceAccount Admission Control Pluginxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_ServiceAccount mediumCCE-83791-4</div><div class=panel-heading><h3 class=panel-title>Enable the ServiceAccount Admission Control Plugin</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_ServiceAccount</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_ServiceAccount:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83791-4">CCE-83791-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.14</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure <code>ServiceAccount</code> objects must be created and granted
before pod creation is allowed, follow the documentation and create
<code>ServiceAccount</code> objects as per your environment.
Ensure that the plugin is enabled in the api-server configuration:<pre>$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data."config.yaml"' | jq '.apiServerArguments."enable-admission-plugins"'</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>When a pod is created, if a service account is not specified, the pod
is automatically assigned the <i>default</i> service account in the same
namespace. OpenShift operators should create unique service accounts
and let the API Server manage its security tokens.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_ServiceAccount:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_ServiceAccount:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize" id=rule-detail-idm45420686388560><div class="keywords sr-only">Configure OpenShift API Server Maximum Audit Log Sizexccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize mediumCCE-83687-4</div><div class=panel-heading><h3 class=panel-title>Configure OpenShift API Server Maximum Audit Log Size</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-ocp_api_server_audit_log_maxsize:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83687-4">CCE-83687-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.25</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To rotate audit logs upon reaching a maximum size,
edit the <code>openshift-apiserver</code> configmap
and set the <code>audit-log-maxsize</code> parameter to
an appropriate size in MB. For example, to set it to 100 MB:<pre>
"apiServerArguments":{
  ...
  "audit-log-maxsize": ["100"],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>OpenShift automatically rotates log files. Retaining old log files ensures that
OpenShift Operators have sufficient log data available for carrying out any
investigation or correlation. If you have set file size of 100 MB and the number of
old log files to keep as 10, there would be approximately 1 GB of log data
available for use in analysis.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_ocp_api_server_audit_log_maxsize:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiServerArguments":{"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/openshift-apiserver/audit.log"],"audit-policy-file":["/var/run/configmaps/audit/secure-oauth-storage-default.yaml"],"shutdown-delay-duration":["3s"]},"apiVersion":"openshiftcontrolplane.config.openshift.io/v1","imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"OpenShiftAPIServerConfig","projectConfig":{"projectRequestMessage":""},"routingConfig":{"subdomain":"apps.ocp.ispworld.at"},"servingInfo":{"bindNetwork":"tcp","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12"},"storageConfig":{"urls":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379"]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_ocp_api_server_audit_log_maxsize:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>1565</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysAdmit" id=rule-detail-idm45420686383536><div class="keywords sr-only">Disable the AlwaysAdmit Admission Control Pluginxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysAdmit mediumCCE-84148-6</div><div class=panel-heading><h3 class=panel-title>Disable the AlwaysAdmit Admission Control Plugin</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_AlwaysAdmit</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_AlwaysAdmit:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84148-6">CCE-84148-6</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.11</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure OpenShift only responses to requests explicitly allowed by the
admission control plugin. Check that the <code>config</code> ConfigMap object does not
contain the AlwaysAdmit plugin.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Enabling the admission control plugin <code>AlwaysAdmit</code> allows all
requests and does not provide any filtering.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_AlwaysAdmit:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_AlwaysAdmit:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NamespaceLifecycle" id=rule-detail-idm45420686378480><div class="keywords sr-only">Enable the NamespaceLifecycle Admission Control Pluginxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NamespaceLifecycle mediumCCE-83854-0</div><div class=panel-heading><h3 class=panel-title>Enable the NamespaceLifecycle Admission Control Plugin</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_NamespaceLifecycle</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_NamespaceLifecycle:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83854-0">CCE-83854-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.15</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>OpenShift enables the <code>NamespaceLifecycle</code> plugin by default.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Setting admission control policy to <code>NamespaceLifecycle</code> ensures that
objects cannot be created in non-existent namespaces, and that namespaces
undergoing termination are not used for creating new objects. This
is recommended to enforce the integrity of the namespace termination process
and also for the availability of new objects.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_NamespaceLifecycle:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_NamespaceLifecycle:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_etcd_key" id=rule-detail-idm45420686373408><div class="keywords sr-only">Configure the etcd Certificate Key for the API Serverxccdf_org.ssgproject.content_rule_api_server_etcd_key mediumCCE-83546-2</div><div class=panel-heading><h3 class=panel-title>Configure the etcd Certificate Key for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_etcd_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_etcd_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83546-2">CCE-83546-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.29</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure etcd is configured to make use of TLS encryption for client
communications, follow the OpenShift documentation and setup the TLS
connection between the API Server and etcd. Then, verify
that <code>apiServerArguments</code> has the <code>etcd-keyfile</code> configured in
the <code>openshift-kube-apiserver</code> configmap to something similar to:<pre>
...
"etcd-keyfile": [
    "/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"
],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>etcd is a highly-available key-value store used by OpenShift deployments
for persistent storage of all REST API objects. These objects are sensitive
in nature and should be protected by client authentication. This requires the
API Server to identify itself to the etcd server using a client certificate
and key.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_etcd_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_etcd_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert" id=rule-detail-idm45420686368416><div class="keywords sr-only">Ensure the openshift-oauth-apiserver service uses TLSxccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert medium</div><div class=panel-heading><h3 class=panel-title>Ensure the openshift-oauth-apiserver service uses TLS</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>By default, the OpenShift OAuth API Server uses TLS. HTTPS should be
used for connections between openshift-oauth-apiserver and kube-apiserver.
OpenShift OAuth API server enables TLS automatically if a TLS key and a
certificate are provided via the <code>serving-cert</code> secret
in the <code>openshift-oauth-apiserver</code> namespace.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Connections between the kube-apiserver and the extension
openshift-oauth-apiserver could potentially carry sensitive data such
as secrets and keys. It is important to use in-transit encryption
for any communication between the kube-apiserver and the extension
openshift-apiserver.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup" id=rule-detail-idm45420686365760><div class="keywords sr-only">Configure the OpenShift API Server Maximum Retained Audit Logsxccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup lowCCE-83977-9</div><div class=panel-heading><h3 class=panel-title>Configure the OpenShift API Server Maximum Retained Audit Logs</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-ocp_api_server_audit_log_maxbackup:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>low</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83977-9">CCE-83977-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.24</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To configure how many rotations of audit logs are retained,
edit the <code>openshift-apiserver</code> configmap
and set the <code>audit-log-maxbackup</code> parameter to
<code>10</code> or to an organizationally appropriate value:<pre>
"apiServerArguments":{
  ...
  "audit-log-maxbackup": [10],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>OpenShift automatically rotates the log files. Retaining old log files ensures
OpenShift Operators will have sufficient log data available for carrying out
any investigation or correlation. For example, if the audit log size is set to
100 MB and the number of retained log files is set to 10, OpenShift Operators
would have approximately 1 GB of log data to use during analysis.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_ocp_api_server_audit_log_maxbackup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiServerArguments":{"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/openshift-apiserver/audit.log"],"audit-policy-file":["/var/run/configmaps/audit/secure-oauth-storage-default.yaml"],"shutdown-delay-duration":["3s"]},"apiVersion":"openshiftcontrolplane.config.openshift.io/v1","imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"OpenShiftAPIServerConfig","projectConfig":{"projectRequestMessage":""},"routingConfig":{"subdomain":"apps.ocp.ispworld.at"},"servingInfo":{"bindNetwork":"tcp","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12"},"storageConfig":{"urls":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379"]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_ocp_api_server_audit_log_maxbackup:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>1565</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_etcd_ca" id=rule-detail-idm45420686360768><div class="keywords sr-only">Configure the etcd Certificate Authority for the API Serverxccdf_org.ssgproject.content_rule_api_server_etcd_ca mediumCCE-84216-1</div><div class=panel-heading><h3 class=panel-title>Configure the etcd Certificate Authority for the API Server</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_etcd_ca</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_etcd_ca:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84216-1">CCE-84216-1</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.32</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure etcd is configured to make use of TLS encryption for client
connections, follow the OpenShift documentation and setup the TLS
connection between the API Server and etcd. Then, verify
that <code>apiServerArguments</code> has the <code>etcd-cafile</code> configured in
the <code>openshift-kube-apiserver</code> <code>config</code> configmap to something
similar to:<pre>
"apiServerArguments": {
  ...
    "etcd-cafile": [
        "/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"
    ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>etcd is a highly-available key-value store used by OpenShift deployments
for persistent storage of all REST API objects. These objects are
sensitive in nature and should be protected by client authentication. This
requires the API Server to identify itself to the etcd server using
a SSL Certificate Authority file.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_etcd_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_etcd_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_Scc" id=rule-detail-idm45420686355776><div class="keywords sr-only">Enable the SecurityContextConstraint Admission Control Pluginxccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_Scc mediumCCE-83602-3</div><div class=panel-heading><h3 class=panel-title>Enable the SecurityContextConstraint Admission Control Plugin</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_Scc</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-api_server_admission_control_plugin_Scc:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83602-3">CCE-83602-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.16</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure pod permissions are managed, make sure that the
<code>SecurityContextConstraint</code> admission control plugin is used.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>A Security Context Constraint is a cluster-level resource that controls the actions
which a pod can perform and what the pod may access. The
<code>SecurityContextConstraint</code> objects define a set of conditions that a pod
must run with in order to be accepted into the system. Security Context Constraints
are comprised of settings and strategies that control the security features
a pod has access to and hence this must be used to control pod access
permissions.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_api_server_admission_control_plugin_Scc:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_api_server_admission_control_plugin_Scc:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notapplicable rule-detail-id-xccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all" id=rule-detail-idm45420686350736><div class="keywords sr-only">Ensure catch-all FlowSchema object for API Priority and Fairness Existsxccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all mediumCCE-83522-3</div><div class=panel-heading><h3 class=panel-title>Ensure catch-all FlowSchema object for API Priority and Fairness Exists</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all</td></tr><tr><td>Result</td><td class="rule-result rule-result-notapplicable"><div><abbr title="The Rule was not applicable to the target of the test. For example, the Rule might have been specific to a different version of the target OS, or it might have been a test against a platform feature that was not installed.">notapplicable</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83522-3">CCE-83522-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.10</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Using <code>APIPriorityAndFairness</code> feature provides a fine-grained way
to control the behaviour of the Kubernetes API server in an overload
situation. The well-known FlowSchema <code>catch-all</code> should be available
to make sure that every request gets some kind of classification. By default,
the <code>catch-all</code> priority level only allows one concurrency share and
does not queue requests. To inspect all the <code>FlowSchema</code> objects, run:<pre>oc get flowschema</pre>To inspect the well-known <code>catch-all</code> object, run the following:<pre>oc describe flowschema catch-all</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The <code>FlowSchema</code> API objects enforce a limit on the
number of events that the API Server will accept in a given time slice
In a large multi-tenant cluster, there might be a small percentage of
misbehaving tenants which could have a significant impact on the
performance of the cluster overall. It is recommended to limit the rate
of events that the API Server will accept.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/flowcontrol.apiserver.k8s.io/v1beta1/flowschemas/catch-all</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/flowcontrol.apiserver.k8s.io/v1beta1/flowschemas/catch-all</code> file.</div></div><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
Note that this is only applicable in OpenShift Container Platform version 4.8
and higher</div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace" id=rule-detail-idm45420686348064><div class="keywords sr-only">Limit Access to the Host IPC Namespacexccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace mediumCCE-84042-1</div><div class=panel-heading><h3 class=panel-title>Limit Access to the Host IPC Namespace</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84042-1">CCE-84042-1</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not be allowed access to the host's Interprocess Commication (IPC)
namespace. To prevent containers from getting access to a host's
IPC namespace, the appropriate Security Context Constraints (SCCs)
should set <code>allowHostIPC</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>A container running in the host's IPC namespace can use IPC
to interact with processes outside the container potentially
allowing an attacker to exploit a host process thereby enabling an
attacker to exploit other services.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_root_containers" id=rule-detail-idm45420686344704><div class="keywords sr-only">Limit Container Running As Root Userxccdf_org.ssgproject.content_rule_scc_limit_root_containers medium</div><div class=panel-heading><h3 class=panel-title>Limit Container Running As Root User</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_root_containers</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should be limited to only the privileges required
to run and should very rarely be run as root user. To prevent
containers from running as root user,
the appropriate Security Context Constraints (SCCs) should set
<code>allowPrivilegedContainer</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Privileged containers have access to all Linux Kernel
capabilities and devices. If a privileged container were
compromised, an attacker would have full access to the container
and host.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_drop_container_capabilities" id=rule-detail-idm45420686342048><div class="keywords sr-only">Drop Container Capabilitiesxccdf_org.ssgproject.content_rule_scc_drop_container_capabilities medium</div><div class=panel-heading><h3 class=panel-title>Drop Container Capabilities</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_drop_container_capabilities</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.9</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not enable more capabilites than needed as this
opens the door for malicious use. To disable the
capabilities, the appropriate Security Context Constraints (SCCs)
should set all capabilities as <code>*</code> or a list of capabilities in
<code>requiredDropCapabilities</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default, containers run with a default set of capabilities as assigned
by the Container Runtime which can include dangerous or highly privileged
capabilities. Capabilities should be dropped unless absolutely critical for
the container to run software as added capabilities that are not required
allow for malicious containers or attackers.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace" id=rule-detail-idm45420686339392><div class="keywords sr-only">Limit Access to the Host Process ID Namespacexccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace medium</div><div class=panel-heading><h3 class=panel-title>Limit Access to the Host Process ID Namespace</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not be allowed access to the host's process
ID namespace. To prevent containers from getting access to a host's
process ID namespace, the appropriate Security Context Constraints (SCCs)
should set <code>allowHostPID</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>A container running in the host's PID namespace can inspect
processes running outside the container which can be used to
escalate privileges outside of the container.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_network_namespace" id=rule-detail-idm45420686336736><div class="keywords sr-only">Limit Access to the Host Network Namespacexccdf_org.ssgproject.content_rule_scc_limit_network_namespace mediumCCE-83492-9</div><div class=panel-heading><h3 class=panel-title>Limit Access to the Host Network Namespace</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_network_namespace</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83492-9">CCE-83492-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not be allowed access to the host's network
namespace. To prevent containers from getting access to a host's
network namespace, the appropriate Security Context Constraints (SCCs)
should set <code>allowHostNetwork</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>A container running in the host's network namespace could
access the host network traffic to and from other pods
potentially allowing an attacker to exploit pods and network
traffic.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation" id=rule-detail-idm45420686333376><div class="keywords sr-only">Limit Containers Ability to Escalate Privilegesxccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation mediumCCE-83447-3</div><div class=panel-heading><h3 class=panel-title>Limit Containers Ability to Escalate Privileges</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83447-3">CCE-83447-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should be limited to only the privileges required
to run and should not be allowed to escalate their privileges.
To prevent containers from escalating privileges,
the appropriate Security Context Constraints (SCCs)
should set <code>allowPrivilegeEscalation</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Privileged containers have access to more of the Linux Kernel
capabilities and devices. If a privileged container were
compromised, an attacker would have full access to the container
and host.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities" id=rule-detail-idm45420686330016><div class="keywords sr-only">Limit Container Capabilitiesxccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities medium</div><div class=panel-heading><h3 class=panel-title>Limit Container Capabilities</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not enable more capabilites than needed as this
opens the door for malicious use. To enable only the
required capabilities, the appropriate Security Context Constraints (SCCs)
should set capabilities as a list in <code>allowedCapabilities</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default, containers run with a default set of capabilities as assigned
by the Container Runtime which can include dangerous or highly privileged
capabilities. Capabilities should be dropped unless absolutely critical for
the container to run software as added capabilities that are not required
allow for malicious containers or attackers.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_privileged_containers" id=rule-detail-idm45420686327344><div class="keywords sr-only">Limit Privileged Container Usexccdf_org.ssgproject.content_rule_scc_limit_privileged_containers medium</div><div class=panel-heading><h3 class=panel-title>Limit Privileged Container Use</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_privileged_containers</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should be limited to only the privileges required
to run. To prevent containers from running as privileged containers,
the appropriate Security Context Constraints (SCCs) should set
<code>allowPrivilegedContainer</code> to <code>false</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Privileged containers have access to all Linux Kernel
capabilities and devices. If a privileged container were
compromised, an attacker would have full access to the container
and host.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability" id=rule-detail-idm45420686324688><div class="keywords sr-only">Limit Use of the CAP_NET_RAWxccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability medium</div><div class=panel-heading><h3 class=panel-title>Limit Use of the CAP_NET_RAW</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.2.7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Containers should not enable more capabilites than needed as this
opens the door for malicious use. <code>CAP_NET_RAW</code> enables a container
to launch a network attack on another container or cluster. To disable the
<code>CAP_NET_RAW</code> capability, the appropriate Security Context Constraints (SCCs)
should set <code>NET_RAW</code> in <code>requiredDropCapabilities</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default, containers run with a default set of capabilities as assigned
by the Container Runtime which can include dangerous or highly privileged
capabilities. If the CAP_NET_RAW is enabled, it may be misused
by malicious containers or attackers.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_idp_is_configured" id=rule-detail-idm45420686121024><div class="keywords sr-only">Configure An Identity Providerxccdf_org.ssgproject.content_rule_idp_is_configured mediumCCE-84088-4</div><div class=panel-heading><h3 class=panel-title>Configure An Identity Provider</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_idp_is_configured</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-idp_is_configured:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84088-4">CCE-84088-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>3.1.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(2)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(3)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(4)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(5)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(6)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(7)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-2(8)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AC-7</a></p></td></tr><tr><td>Description</td><td><div class=description><p>For users to interact with OpenShift Container Platform, they must first
authenticate to the cluster. The authentication layer identifies the user
associated with requests to the OpenShift Container Platform API. The
authorization layer then uses information about the requesting user to
determine if the request is allowed.
<a href=https://docs.openshift.com/container-platform/4.6/logging/cluster-logging-external.html>Understanding authentication | Authentication | OpenShift Container Platform</a></p><p>The OpenShift Container Platform includes a built-in OAuth server for
token-based authentication. Developers and administrators obtain OAuth
access tokens to authenticate themselves to the API. It is recommended for
an administrator to configure OAuth to specify an identity provider after
the cluster is installed. User access to the cluster is managed through the
identity provider.
<a href=https://docs.openshift.com/container-platform/4.6/authentication/understanding-identity-provider.html>Understanding identity provider configuration | Authentication | OpenShift Container Platform</a></p><p>OpenShift includes built-in role based access control (RBAC) to determine
whether a user is allowed to perform a given action within the cluster.
Roles can have cluster scope or local (i.e. project) scope.
<a href=https://docs.openshift.com/container-platform/4.6/authentication/using-rbac.html>Using RBAC to define and apply permissions | Authentication | OpenShift Container Platform</a></p></div></td></tr><tr><td>Rationale</td><td><div class=rationale><p>With any authentication mechanism the ability to revoke credentials if they
are compromised or no longer required, is a key control. Kubernetes client
certificate authentication does not allow for this due to a lack of support
for certificate revocation.</p><p>OpenShift's built-in OAuth server allows credential revocation by relying on
the Identity provider, as well as giving the administrators the ability to
revoke any tokens given to a specific user.</p></div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/config.openshift.io/v1/oauths/cluster</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/config.openshift.io/v1/oauths/cluster</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/config.openshift.io/v1/oauths/cluster' find only one object at path '.spec.identityProviders[:].type'.</span>
<span class="label label-default">oval:ssg-test_idp_is_configured:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/oauths/cluster</td><td>/kubernetes-api-resources/apis/config.openshift.io/v1/oauths</td><td>cluster</td><td>.spec.identityProviders[:].type</td><td>HTPasswd</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/config.openshift.io/v1/oauths/cluster').</span>
<span class="label label-default">oval:ssg-test_file_for_idp_is_configured:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/oauths/cluster</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>981</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig" id=rule-detail-idm45420686102768><div class="keywords sr-only">Verify Group Who Owns The Worker Proxy Kubeconfig Filexccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig medium</div><div class=panel-heading><h3 class=panel-title>Verify Group Who Owns The Worker Proxy Kubeconfig File</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.1.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the
correct ownership, make sure that the <code>sdn-config</code> ConfigMap is mounted using
a ConfigMap at the <code>/config</code> mount point and that the <code>sdn</code> container
points to that configuration using the <code>--proxy-config</code> command line option.
Run:<pre> oc get -nopenshift-sdn ds sdn -ojson | jq -r '.spec.template.spec.containers[] | select(.name == "sdn")'</pre>and ensure the <code>--proxy-config</code> parameter points to
<code>/config/kube-proxy-config.yaml</code> and that the <code>config</code> mount point is
mounted from the <code>sdn-config</code> ConfigMap.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The kubeconfig file for kube-proxy provides permissions to the kube-proxy service.
The proxy kubeconfig file contains information about the administrative configuration of the
OpenShift cluster that is configured on the system. Protection of this file is
critical for OpenShift security.
The file is provided via a ConfigMap mount, so the kubelet itself makes sure that the
file permissions are appropriate for the container taking it into use.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-fail rule-detail-id-xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig" id=rule-detail-idm45420686081520><div class="keywords sr-only">Verify Permissions on the Worker Proxy Kubeconfig Filexccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig mediumCCE-84047-0</div><div class=panel-heading><h3 class=panel-title>Verify Permissions on the Worker Proxy Kubeconfig File</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig</td></tr><tr><td>Result</td><td class="rule-result rule-result-fail"><div><abbr title="The target system or system component did not satisfy at least one condition of the rule.">fail</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-file_permissions_proxy_kubeconfig:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84047-0">CCE-84047-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.1.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the
correct permissions, make sure that the <code>sdn-config</code> ConfigMap is mounted using
restrictive permissions. Check that the <code>config</code> VolumeMount mounts the
<code>sdn-config</code> configMap with permissions set to 420:<pre>
{
"configMap": {
  "defaultMode": 420,
  "name": "sdn-config"
  },
"name": "config"
}
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The kube-proxy kubeconfig file controls various parameters of the kube-proxy
service in the worker node. If used, you should restrict its file permissions
to maintain the integrity of the file. The file should be writable by only
the administrators on the system.
The kube-proxy runs with the kubeconfig parameters configured as
a Kubernetes ConfigMap instead of a file. In this case, there is no proxy
kubeconfig file. But appropriate permissions still need to be set in the
ConfigMap mount.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn' find only one object at path 'spec.template.spec.volumes[:].configMap['defaultMode','name']'.</span>
<span class="label label-default">oval:ssg-test_file_permissions_proxy_kubeconfig:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_file_permissions_proxy_kubeconfig:obj:1</abbr></strong> of type
<strong>yamlfilecontent_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Yamlpath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn</td></tr></table></td><td>spec.template.spec.volumes[:].configMap['defaultMode','name']</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn').</span>
<span class="label label-default">oval:ssg-test_file_for_file_permissions_proxy_kubeconfig:tst:1</span>
<span class="label label-danger">false</span></h4><h5>No items have been found conforming to the following objects:</h5><h5>Object <strong><abbr>oval:ssg-object_file_for_file_permissions_proxy_kubeconfig:obj:1</abbr></strong> of type
<strong>file_object</strong></h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th></tr></thead><tbody><tr><td><table><tr><td>/kubernetes-api-resources</td></tr><tr><td>/kubernetes-api-resources/apis/apps/v1/namespaces/openshift-sdn/daemonsets/sdn</td></tr></table></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig" id=rule-detail-idm45420686073840><div class="keywords sr-only">Verify User Who Owns The Worker Proxy Kubeconfig Filexccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig medium</div><div class=panel-heading><h3 class=panel-title>Verify User Who Owns The Worker Proxy Kubeconfig File</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.1.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the
correct ownership, make sure that the <code>sdn-config</code> ConfigMap is mounted using
a ConfigMap at the <code>/config</code> mount point and that the <code>sdn</code> container
points to that configuration using the <code>--proxy-config</code> command line option.
Run:<pre> oc get -nopenshift-sdn ds sdn -ojson | jq -r '.spec.template.spec.containers[] | select(.name == "sdn")'</pre>and ensure the <code>--proxy-config</code> parameter points to
<code>/config/kube-proxy-config.yaml</code> and that the <code>config</code> mount point is
mounted from the <code>sdn-config</code> ConfigMap.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The kubeconfig file for kube-proxy provides permissions to the kube-proxy service.
The proxy kubeconfig file contains information about the administrative configuration of the
OpenShift cluster that is configured on the system. Protection of this file is
critical for OpenShift security.
The file is provided via a ConfigMap mount, so the kubelet itself makes sure that the
file permissions are appropriate for the container taking it into use.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_key_file" id=rule-detail-idm45420686063952><div class="keywords sr-only">Ensure That The etcd Key File Is Correctly Setxccdf_org.ssgproject.content_rule_etcd_key_file mediumCCE-83745-0</div><div class=panel-heading><h3 class=panel-title>Ensure That The etcd Key File Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_key_file</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_key_file:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83745-0">CCE-83745-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the etcd service is serving TLS to clients,
make sure the <code>etcd-pod*</code> ConfigMaps in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>oc get -nopenshift-etcd cm etcd-pod -oyaml | grep "\-\-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.key"</pre>.
Note that the<pre>[a-z]+</pre>is being used since the directory might
change between OpenShift versions.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_key_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_key_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_peer_cert_file" id=rule-detail-idm45420686058960><div class="keywords sr-only">Ensure That The etcd Peer Client Certificate Is Correctly Setxccdf_org.ssgproject.content_rule_etcd_peer_cert_file mediumCCE-83847-4</div><div class=panel-heading><h3 class=panel-title>Ensure That The etcd Peer Client Certificate Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_peer_cert_file</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_peer_cert_file:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83847-4">CCE-83847-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the etcd service is serving TLS to peers,
make sure the <code>etcd-pod*</code> ConfigMaps in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.crt</pre>Note that the<pre>[a-z]+</pre>is being used since the directory might
change between OpenShift versions.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_peer_cert_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_peer_cert_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth" id=rule-detail-idm45420686053968><div class="keywords sr-only">Enable The Peer Client Certificate Authenticationxccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth mediumCCE-83465-5</div><div class=panel-heading><h3 class=panel-title>Enable The Peer Client Certificate Authentication</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_peer_client_cert_auth:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83465-5">CCE-83465-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the <code>etcd</code> service is serving TLS to clients,
make sure the <code>etcd-pod*</code> <code>ConfigMaps</code> in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>oc get -nopenshift-etcd cm etcd-pod -oyaml | grep "\-\-peer-client-cert-auth="</pre>the parameter should be set to <code>true</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_peer_client_cert_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_peer_client_cert_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_peer_key_file" id=rule-detail-idm45420686048944><div class="keywords sr-only">Ensure That The etcd Peer Key File Is Correctly Setxccdf_org.ssgproject.content_rule_etcd_peer_key_file mediumCCE-83711-2</div><div class=panel-heading><h3 class=panel-title>Ensure That The etcd Peer Key File Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_peer_key_file</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_peer_key_file:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83711-2">CCE-83711-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the etcd service is serving TLS to peers,
make sure the <code>etcd-pod*</code> ConfigMaps in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>oc get -nopenshift-etcd cm etcd-pod -oyaml | grep "\-\-peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.key"</pre>Note that the<pre>[a-z]+</pre>is being used since the directory might
change between OpenShift versions.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_peer_key_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_peer_key_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_cert_file" id=rule-detail-idm45420686043952><div class="keywords sr-only">Ensure That The etcd Client Certificate Is Correctly Setxccdf_org.ssgproject.content_rule_etcd_cert_file mediumCCE-83553-8</div><div class=panel-heading><h3 class=panel-title>Ensure That The etcd Client Certificate Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_cert_file</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_cert_file:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83553-8">CCE-83553-8</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the etcd service is serving TLS to clients,
make sure the <code>etcd-pod*</code> ConfigMaps in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.crt</pre>.
Note that the<pre>[a-z]+</pre>is being used since the directory might
change between OpenShift versions.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_cert_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_cert_file:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_client_cert_auth" id=rule-detail-idm45420686037024><div class="keywords sr-only">Enable The Client Certificate Authenticationxccdf_org.ssgproject.content_rule_etcd_client_cert_auth mediumCCE-84077-7</div><div class=panel-heading><h3 class=panel-title>Enable The Client Certificate Authentication</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_client_cert_auth</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_client_cert_auth:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84077-7">CCE-84077-7</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the <code>etcd</code> service is serving TLS to clients,
make sure the <code>etcd-pod*</code> <code>ConfigMaps</code> in the
<code>openshift-etcd</code> namespace contain the following argument
for the <code>etcd</code> binary in the <code>etcd</code> pod:<pre>oc get -nopenshift-etcd cm etcd-pod -oyaml | grep "\-\-client-cert-auth="</pre>the parameter should be set to <code>true</code>.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data['pod.yaml']'.</span>
<span class="label label-default">oval:ssg-test_etcd_client_cert_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data['pod.yaml']</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_client_cert_auth:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_peer_auto_tls" id=rule-detail-idm45420686032032><div class="keywords sr-only">Disable etcd Peer Self-Signed Certificatesxccdf_org.ssgproject.content_rule_etcd_peer_auto_tls mediumCCE-84184-1</div><div class=panel-heading><h3 class=panel-title>Disable etcd Peer Self-Signed Certificates</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_peer_auto_tls</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_peer_auto_tls:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84184-1">CCE-84184-1</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the <code>etcd</code> service is not using self-signed
certificates, run the following command:<pre>$ oc get cm/etcd-pod -n openshift-etcd -o yaml</pre>The etcd pod configuration contained in the configmap should not
contain the <code>--peer-auto-tls=true</code> flag.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection. Using self-signed
certificates ensures that the certificates are never validated
against a certificate authority and could lead to compromised
and invalidated data.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data["pod.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_etcd_peer_auto_tls:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data["pod.yaml"]</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_peer_auto_tls:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_etcd_auto_tls" id=rule-detail-idm45420686027040><div class="keywords sr-only">Disable etcd Self-Signed Certificatesxccdf_org.ssgproject.content_rule_etcd_auto_tls mediumCCE-84199-9</div><div class=panel-heading><h3 class=panel-title>Disable etcd Self-Signed Certificates</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_etcd_auto_tls</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-etcd_auto_tls:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84199-9">CCE-84199-9</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>2.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the <code>etcd</code> service is not using self-signed
certificates, run the following command:<pre>$ oc get cm/etcd-pod -n openshift-etcd -o yaml</pre>The etcd pod configuration contained in the configmap should not
contain the <code>--auto-tls=true</code> flag.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection. Using self-signed
certificates ensures that the certificates are never validated
against a certificate authority and could lead to compromised
and invalidated data.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod' find only one object at path '.data["pod.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_etcd_auto_tls:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps</td><td>etcd-pod</td><td>.data["pod.yaml"]</td><td>apiVersion: v1
kind: Pod
metadata:
name: etcd
namespace: openshift-etcd
labels:
app: etcd
k8s-app: etcd
etcd: "true"
revision: "REVISION"
spec:
initContainers:
- name: etcd-ensure-env-vars
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
: "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST?not set}"
: "${NODE_NODE_ENVVAR_NAME_ETCD_NAME?not set}"
: "${NODE_NODE_ENVVAR_NAME_IP?not set}"
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_IP}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_IP}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected node IP to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_IP}" >&amp;2
exit 1
fi
# check for ipv4 addresses as well as ipv6 addresses with extra square brackets
if [[ "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "${NODE_IP}" && "${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" != "[${NODE_IP}]" ]]; then
# echo the error message to stderr
echo "Expected etcd url host to be ${NODE_IP} got ${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}" >&amp;2
exit 1
fi
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: NODE_IP
valueFrom:
fieldRef:
fieldPath: status.podIP
- name: etcd-resources-copy
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
rm -f $(grep -l '^### Created by cluster-etcd-operator' /usr/local/bin/*)
cp -p /etc/kubernetes/static-pod-certs/configmaps/etcd-scripts/*.sh /usr/local/bin
resources:
requests:
memory: 60Mi
cpu: 10m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /usr/local/bin
name: usr-local-bin
containers:
# The etcdctl container should always be first. It is intended to be used
# to open a remote shell via `oc rsh` that is ready to run `etcdctl`.
- name: etcdctl
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- "/bin/bash"
- "-c"
- "trap TERM INT; sleep infinity & wait"
resources:
requests:
memory: 60Mi
cpu: 10m
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
- name: etcd
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
etcdctl member list || true
# this has a non-zero return code if the command is non-zero. If you use an export first, it doesn't and you
# will succeed when you should fail.
ETCD_INITIAL_CLUSTER=$(discover-etcd-initial-cluster \
--cacert=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--cert=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--key=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--endpoints=${ALL_ETCD_ENDPOINTS} \
--data-dir=/var/lib/etcd \
--target-peer-url-host=${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST} \
--target-name=NODE_NAME)
export ETCD_INITIAL_CLUSTER
# we cannot use the "normal" port conflict initcontainer because when we upgrade, the existing static pod will never yield,
# so we do the detection in etcd container itsefl.
echo -n "Waiting for ports 2379, 2380 and 9978 to be released."
while [ -n "$(ss -Htan '( sport = 2379 or sport = 2380 or sport = 9978 )')" ]; do
echo -n "."
sleep 1
done
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
env | grep ETCD | grep -v NODE
set -x
# See https://etcd.io/docs/v3.4.0/tuning/ for why we use ionice
exec ionice -c2 -n0 etcd \
--log-level=info \
--initial-advertise-peer-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2380 \
--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.crt \
--key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-serving/etcd-serving-NODE_NAME.key \
--trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt \
--client-cert-auth=true \
--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--peer-trusted-ca-file=/etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--peer-client-cert-auth=true \
--advertise-client-urls=https://${NODE_NODE_ENVVAR_NAME_IP}:2379 \
--listen-client-urls=https://0.0.0.0:2379 \
--listen-peer-urls=https://0.0.0.0:2380 \
--listen-metrics-urls=https://0.0.0.0:9978 || mv /etc/kubernetes/etcd-backup-dir/etcd-member.yaml /etc/kubernetes/manifests
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 600Mi
cpu: 300m
readinessProbe:
tcpSocket:
port: 2380
failureThreshold: 3
initialDelaySeconds: 3
periodSeconds: 5
successThreshold: 1
timeoutSeconds: 5
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/manifests
name: static-pod-dir
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
- name: etcd-metrics
image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615
imagePullPolicy: IfNotPresent
terminationMessagePolicy: FallbackToLogsOnError
command:
- /bin/sh
- -c
- |
#!/bin/sh
set -euo pipefail
export ETCD_NAME=${NODE_NODE_ENVVAR_NAME_ETCD_NAME}
exec etcd grpc-proxy start \
--endpoints https://${NODE_NODE_ENVVAR_NAME_ETCD_URL_HOST}:9978 \
--metrics-addr https://0.0.0.0:9979 \
--listen-addr 127.0.0.1:9977 \
--key /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key \
--key-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.key \
--cert /etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt \
--cert-file /etc/kubernetes/static-pod-certs/secrets/etcd-all-serving-metrics/etcd-serving-metrics-NODE_NAME.crt \
--cacert /etc/kubernetes/static-pod-certs/configmaps/etcd-peer-client-ca/ca-bundle.crt \
--trusted-ca-file /etc/kubernetes/static-pod-certs/configmaps/etcd-metrics-proxy-serving-ca/ca-bundle.crt
env:
- name: "ALL_ETCD_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_API"
value: "3"
- name: "ETCDCTL_CACERT"
value: "/etc/kubernetes/static-pod-certs/configmaps/etcd-serving-ca/ca-bundle.crt"
- name: "ETCDCTL_CERT"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.crt"
- name: "ETCDCTL_ENDPOINTS"
value: "https://192.168.50.10:2379,https://192.168.50.11:2379,https://192.168.50.12:2379"
- name: "ETCDCTL_KEY"
value: "/etc/kubernetes/static-pod-certs/secrets/etcd-all-peer/etcd-peer-NODE_NAME.key"
- name: "ETCD_CIPHER_SUITES"
value: "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
- name: "ETCD_DATA_DIR"
value: "/var/lib/etcd"
- name: "ETCD_ELECTION_TIMEOUT"
value: "1000"
- name: "ETCD_ENABLE_PPROF"
value: "true"
- name: "ETCD_HEARTBEAT_INTERVAL"
value: "100"
- name: "ETCD_IMAGE"
value: "quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1d33e906d435b7a195f5876b722e4b17da684d140fe65c1e5e7ab8771a597615"
- name: "ETCD_INITIAL_CLUSTER_STATE"
value: "existing"
- name: "ETCD_QUOTA_BACKEND_BYTES"
value: "7516192768"
- name: "NODE_master_0_ETCD_NAME"
value: "master-0"
- name: "NODE_master_0_ETCD_URL_HOST"
value: "192.168.50.10"
- name: "NODE_master_0_IP"
value: "192.168.50.10"
- name: "NODE_master_1_ETCD_NAME"
value: "master-1"
- name: "NODE_master_1_ETCD_URL_HOST"
value: "192.168.50.11"
- name: "NODE_master_1_IP"
value: "192.168.50.11"
- name: "NODE_master_2_ETCD_NAME"
value: "master-2"
- name: "NODE_master_2_ETCD_URL_HOST"
value: "192.168.50.12"
- name: "NODE_master_2_IP"
value: "192.168.50.12"
resources:
requests:
memory: 200Mi
cpu: 40m
securityContext:
privileged: true
volumeMounts:
- mountPath: /etc/kubernetes/static-pod-resources
name: resource-dir
- mountPath: /etc/kubernetes/static-pod-certs
name: cert-dir
- mountPath: /var/lib/etcd/
name: data-dir
hostNetwork: true
priorityClassName: system-node-critical
tolerations:
- operator: "Exists"
volumes:
- hostPath:
path: /etc/kubernetes/manifests
name: static-pod-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-pod-REVISION
name: resource-dir
- hostPath:
path: /etc/kubernetes/static-pod-resources/etcd-certs
name: cert-dir
- hostPath:
path: /var/lib/etcd
type: ""
name: data-dir
- hostPath:
path: /usr/local/bin
name: usr-local-bin</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod').</span>
<span class="label label-default">oval:ssg-test_file_for_etcd_auto_tls:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-etcd/configmaps/etcd-pod</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>19673</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_general_namespaces_in_use" id=rule-detail-idm45420686022048><div class="keywords sr-only">Create administrative boundaries between resources using namespacesxccdf_org.ssgproject.content_rule_general_namespaces_in_use medium</div><div class=panel-heading><h3 class=panel-title>Create administrative boundaries between resources using namespaces</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_general_namespaces_in_use</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.6.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Use namespaces to isolate your Kubernetes objects.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Limiting the scope of user permissions can reduce the impact of mistakes or
malicious activities. A Kubernetes namespace allows you to partition created
resources into logically named groups. Resources created in one namespace can
be hidden from other namespaces. By default, each resource created by a user
in Kubernetes cluster runs in a default namespace, called default. You can
create additional namespaces and attach resources and users to them. You can
use Kubernetes Authorization plugins to create policies that segregate access
to namespace resources between different users.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook" id=rule-detail-idm45420686019392><div class="keywords sr-only">Manage Image Provenance Using ImagePolicyWebhookxccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook medium</div><div class=panel-heading><h3 class=panel-title>Manage Image Provenance Using ImagePolicyWebhook</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.5.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>OpenShift administrators can control which images can be imported, tagged, and run in a cluster.
There are two facilities for this purpose: (1) Allowed Registries, allowing administrators to
restrict image origins to known external registries; and (2) ImagePolicy Admission plug-in which lets
administrators specify specific images which are allowed to run on the OpenShift cluster.
Configure an Image policy per the Image Policy chapter in the OpenShift documentation:
<a href=https://docs.openshift.com/container-platform/4.4/openshift_images/image-configuration.html>https://docs.openshift.com/container-platform/4.4/openshift_images/image-configuration.html</a></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Image Policy ensures that only approved container images are allowed to be ran on the OpenShift platform.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_general_default_namespace_use" id=rule-detail-idm45420686016736><div class="keywords sr-only">The default namespace should not be usedxccdf_org.ssgproject.content_rule_general_default_namespace_use medium</div><div class=panel-heading><h3 class=panel-title>The default namespace should not be used</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_general_default_namespace_use</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.6.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Kubernetes provides a default namespace, where objects are placed if no
namespace is specified for them. Placing objects in this namespace makes
application of RBAC and other controls more difficult.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Resources in a Kubernetes cluster should be segregated by namespace, to allow
for security controls to be applied at that level and to make it easier to
manage resources.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_general_apply_scc" id=rule-detail-idm45420686014080><div class="keywords sr-only">Apply Security Context to Your Pods and Containersxccdf_org.ssgproject.content_rule_general_apply_scc medium</div><div class=panel-heading><h3 class=panel-title>Apply Security Context to Your Pods and Containers</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_general_apply_scc</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.6.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Apply Security Context to your Pods and Containers</div></td></tr><tr><td>Rationale</td><td><div class=rationale>A security context defines the operating system security settings (uid, gid,
capabilities, SELinux role, etc..) applied to a container. When designing your
containers and pods, make sure that you configure the security context for your
pods, containers, and volumes. A security context is a property defined in the
deployment yaml. It controls the security parameters that will be assigned to
the pod/container/volume. There are two levels of security context: pod level
security context, and container level security context.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_general_default_seccomp_profile" id=rule-detail-idm45420686011440><div class="keywords sr-only">Ensure Seccomp Profile Pod Definitionsxccdf_org.ssgproject.content_rule_general_default_seccomp_profile medium</div><div class=panel-heading><h3 class=panel-title>Ensure Seccomp Profile Pod Definitions</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_general_default_seccomp_profile</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.6.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Enable <code>default</code> seccomp profiles in your pod definitions.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Seccomp (secure computing mode) is used to restrict the set of system calls
applications can make, allowing cluster administrators greater control over
the security of workloads running in the cluster. Kubernetes disables
seccomp profiles by default for historical reasons. You should enable it to
ensure that the workloads have restricted actions available within the
container.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path" id=rule-detail-idm45420686008784><div class="keywords sr-only">Configure the Audit Log Pathxccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path highCCE-83547-0</div><div class=panel-heading><h3 class=panel-title>Configure the Audit Log Path</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-openshift_api_server_audit_log_path:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83547-0">CCE-83547-0</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.2.22</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To enable auditing on the OpenShift API Server, the audit log path must be set.
Edit the <code>openshift-apiserver</code> configmap
and set the <code>audit-log-path</code> to a suitable path and file
where audit logs should be written. For example:<pre>
"apiServerArguments":{
  ...
  "audit-log-path":"/var/log/openshift-apiserver/audit.log",
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Auditing of the API Server is not enabled by default. Auditing the API Server
provides a security-relevant chronological set of records documenting the sequence
of activities that have affected the system by users, administrators, or other
system components.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-apiserver/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_openshift_api_server_audit_log_path:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiServerArguments":{"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/openshift-apiserver/audit.log"],"audit-policy-file":["/var/run/configmaps/audit/secure-oauth-storage-default.yaml"],"shutdown-delay-duration":["3s"]},"apiVersion":"openshiftcontrolplane.config.openshift.io/v1","imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"OpenShiftAPIServerConfig","projectConfig":{"projectRequestMessage":""},"routingConfig":{"subdomain":"apps.ocp.ispworld.at"},"servingInfo":{"bindNetwork":"tcp","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12"},"storageConfig":{"urls":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379"]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_openshift_api_server_audit_log_path:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>1565</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_secure_port" id=rule-detail-idm45420686003760><div class="keywords sr-only">Ensure Controller secure-port argument is setxccdf_org.ssgproject.content_rule_controller_secure_port lowCCE-83861-5</div><div class=panel-heading><h3 class=panel-title>Ensure Controller secure-port argument is set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_secure_port</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_secure_port:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>low</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83861-5">CCE-83861-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the Controller Manager service is bound to secure loopback
address using a secure port,
set the <code>RotateKubeletServerCertificate</code> option to <code>true</code>
in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "secure-port": ["10257"],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The Controller Manager API service is used for health and metrics
information and is available without authentication or encryption. As such, it
should only be bound to a localhost interface to minimize the cluster's
attack surface.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_controller_secure_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_secure_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_use_service_account" id=rule-detail-idm45420685996848><div class="keywords sr-only">Ensure that use-service-account-credentials is enabledxccdf_org.ssgproject.content_rule_controller_use_service_account mediumCCE-84208-8</div><div class=panel-heading><h3 class=panel-title>Ensure that use-service-account-credentials is enabled</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_use_service_account</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_use_service_account:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84208-8">CCE-84208-8</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure individual service account credentials are used,
set the <code>use-service-account-credentials</code> option to <code>true</code>
in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "use-service-account-credentials": [
    "true"
  ],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The controller manager creates a service account per controller in
<code>kube-system</code> namespace, generates an API token and credentials for it,
then builds a dedicated API client with that service account credential
for each controller loop to use. Setting the
<code>use-service-account-credentials</code> to <code>true</code> runs each
control loop within the contoller manager using a separate service
account credential. When used in combination with RBAC, this ensures
that the control loops run with the minimum permissions required to
perform their intended tasks.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_controller_use_service_account:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_use_service_account:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_insecure_port_disabled" id=rule-detail-idm45420685991824><div class="keywords sr-only">Ensure Controller insecure port argument is unsetxccdf_org.ssgproject.content_rule_controller_insecure_port_disabled lowCCE-83578-5</div><div class=panel-heading><h3 class=panel-title>Ensure Controller insecure port argument is unset</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_insecure_port_disabled</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_insecure_port_disabled:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>low</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83578-5">CCE-83578-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the Controller Manager service is bound to secure loopback
address and a secure port,
set the <code>RotateKubeletServerCertificate</code> option to <code>true</code>
in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "port": ["0"],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>The Controller Manager API service is used for health and metrics
information and is available without authentication or encryption. As such, it
should only be bound to a localhost interface to minimize the cluster's
attack surface.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_controller_insecure_port_disabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_insecure_port_disabled:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_service_account_ca" id=rule-detail-idm45420685986832><div class="keywords sr-only">Configure the Service Account Certificate Authority Key for the Controller Managerxccdf_org.ssgproject.content_rule_controller_service_account_ca mediumCCE-84244-3</div><div class=panel-heading><h3 class=panel-title>Configure the Service Account Certificate Authority Key for the Controller Manager</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_service_account_ca</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_service_account_ca:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84244-3">CCE-84244-3</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.5</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the API Server utilizes its own key pair, set the <code>masterCA</code>
parameter to the public key file for service accounts in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "root-ca-file": [
    "/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"
  ],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Service accounts authenticate to the API using tokens signed by a private RSA
key. The authentication layer verifies the signature using a matching public RSA key.
Configuring the certificate authority file ensures that the API server's signing
certificates are validated.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_controller_service_account_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_service_account_ca:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_service_account_private_key" id=rule-detail-idm45420685981808><div class="keywords sr-only">Configure the Service Account Private Key for the Controller Managerxccdf_org.ssgproject.content_rule_controller_service_account_private_key mediumCCE-83526-4</div><div class=panel-heading><h3 class=panel-title>Configure the Service Account Private Key for the Controller Manager</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_service_account_private_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_service_account_private_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83526-4">CCE-83526-4</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the API Server utilizes its own key pair, set the <code>privateKeyFile</code>
parameter to the public key file for service accounts in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "service-account-private-key-file": [
    "/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"
  ],
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>By default if no private key file is specified to the
API Server, the API Server uses the private key from the TLS serving
certificate to verify service account tokens. To ensure that the keys
for service account tokens could be rotated as needed, a separate
public/private key pair should be used for signing service account
tokens.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data['config.yaml']'.</span>
<span class="label label-default">oval:ssg-test_controller_service_account_private_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data['config.yaml']</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_service_account_private_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs" id=rule-detail-idm45420685976768><div class="keywords sr-only">Ensure that the RotateKubeletServerCertificate argument is setxccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs mediumCCE-83730-2</div><div class=panel-heading><h3 class=panel-title>Ensure that the RotateKubeletServerCertificate argument is set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-controller_rotate_kubelet_server_certs:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83730-2">CCE-83730-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To enforce kublet server certificate rotation on the Controller Manager,
set the <code>RotateKubeletServerCertificate</code> option to <code>true</code>
in the <code>openshift-kube-controller-manager</code> configmap on the master
node(s):<pre>
"extendedArguments": {
...
  "feature-gates": [
  ...
    "RotateKubeletServerCertificate=true",
  ...
...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Enabling kubelet certificate rotation causes the kubelet to both request
a serving certificate after bootstrapping its client credentials and rotate the
certificate as its existing credentials expire. This automated periodic rotation
ensures that there are no downtimes due to expired certificates and thus
addressing the availability in the C/I/A security triad.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</code> file.</div></div><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This recommendation only applies if you let kubelets get their
certificates from the API Server. In case your certificates come from an
outside Certificate Authority/tool (e.g. Vault) then you need to take care
of rotation yourself</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config' find only one object at path '.data["config.yaml"]'.</span>
<span class="label label-default">oval:ssg-test_controller_rotate_kubelet_server_certs:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps</td><td>config</td><td>.data["config.yaml"]</td><td>{"apiVersion":"kubecontrolplane.config.openshift.io/v1","extendedArguments":{"allocate-node-cidrs":["false"],"cert-dir":["/var/run/kubernetes"],"cluster-cidr":["10.128.0.0/14"],"cluster-name":["ocp-d8r5b"],"cluster-signing-cert-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.crt"],"cluster-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/csr-signer/tls.key"],"configure-cloud-routes":["false"],"controllers":["*","-ttl","-bootstrapsigner","-tokencleaner"],"enable-dynamic-provisioning":["true"],"experimental-cluster-signing-duration":["720h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"flex-volume-plugin-dir":["/etc/kubernetes/kubelet-plugins/volume/exec"],"kube-api-burst":["300"],"kube-api-qps":["150"],"leader-elect":["true"],"leader-elect-resource-lock":["configmaps"],"leader-elect-retry-period":["3s"],"port":["0"],"pv-recycler-pod-template-filepath-hostpath":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"pv-recycler-pod-template-filepath-nfs":["/etc/kubernetes/static-pod-resources/configmaps/recycler-config/recycler-pod.yaml"],"root-ca-file":["/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt"],"secure-port":["10257"],"service-account-private-key-file":["/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key"],"service-cluster-ip-range":["172.30.0.0/16"],"use-service-account-credentials":["true"]},"kind":"KubeControllerManagerConfig","serviceServingCert":{"certFile":"/etc/kubernetes/static-pod-resources/configmaps/service-ca/ca-bundle.crt"}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_controller_rotate_kubelet_server_certs:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-controller-manager/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>2368</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert" id=rule-detail-idm45420685969056><div class="keywords sr-only">Ensure That The kubelet Client Certificate Is Correctly Setxccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert mediumCCE-83396-2</div><div class=panel-heading><h3 class=panel-title>Ensure That The kubelet Client Certificate Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-kubelet_configure_tls_cert:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83396-2">CCE-83396-2</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.2.10</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the kubelet TLS client certificate is configured, edit the
kubelet configuration file <code>/etc/kubernetes/kubelet.conf</code>
and configure the kubelet certificate file.<pre>tlsCertFile: /path/to/TLS/cert.key</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data['config.yaml']'.</span>
<span class="label label-default">oval:ssg-test_kubelet_configure_tls_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data['config.yaml']</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_kubelet_configure_tls_cert:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port" id=rule-detail-idm45420685906848><div class="keywords sr-only">kubelet - Disable the Read-Only Portxccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port mediumCCE-83427-5</div><div class=panel-heading><h3 class=panel-title>kubelet - Disable the Read-Only Port</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-kubelet_disable_readonly_port:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83427-5">CCE-83427-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.2.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>To disable the read-only port, edit the kubelet configuration
Edit the <code>openshift-kube-apiserver</code> configmap
and set the <code>kubelet-read-only-port</code> parameter to 0:<pre>
"apiServerArguments":{
  ...
  "kubelet-read-only-port":[
    "0"
  ],
  ...
</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>OpenShift disables the read-only port (<code>10255</code>) on all nodes by setting the
read-only port kubelet flag to <code>0</code>. This ensures only
authenticated connections are able to receive information about the OpenShift
system.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data['config.yaml']'.</span>
<span class="label label-default">oval:ssg-test_kubelet_disable_readonly_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data['config.yaml']</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_kubelet_disable_readonly_port:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key" id=rule-detail-idm45420685901824><div class="keywords sr-only">Ensure That The kubelet Server Key Is Correctly Setxccdf_org.ssgproject.content_rule_kubelet_configure_tls_key medium</div><div class=panel-heading><h3 class=panel-title>Ensure That The kubelet Server Key Is Correctly Set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-kubelet_configure_tls_key:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>4.2.10</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SC-8(2)</a></p></td></tr><tr><td>Description</td><td><div class=description>To ensure the kubelet TLS private server key certificate is configured, edit the
kubelet configuration file <code>/etc/kubernetes/kubelet.conf</code>
and configure the kubelet private key file.<pre>tlsPrivateKeyFile: /path/to/TLS/private.key</pre></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/api/v1/namespaces/openshift-kube-apiserver/configmaps/config' find only one object at path '.data['config.yaml']'.</span>
<span class="label label-default">oval:ssg-test_kubelet_configure_tls_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps</td><td>config</td><td>.data['config.yaml']</td><td>{"admission":{"pluginConfig":{"network.openshift.io/ExternalIPRanger":{"configuration":{"allowIngressIP":false,"apiVersion":"network.openshift.io/v1","externalIPNetworkCIDRs":null,"kind":"ExternalIPRangerAdmissionConfig"},"location":""},"network.openshift.io/RestrictedEndpointsAdmission":{"configuration":{"apiVersion":"network.openshift.io/v1","kind":"RestrictedEndpointsAdmissionConfig","restrictedCIDRs":["10.128.0.0/14","172.30.0.0/16"]}}}},"apiServerArguments":{"allow-privileged":["true"],"anonymous-auth":["true"],"api-audiences":["https://kubernetes.default.svc"],"audit-log-format":["json"],"audit-log-maxbackup":["10"],"audit-log-maxsize":["100"],"audit-log-path":["/var/log/kube-apiserver/audit.log"],"audit-policy-file":["/etc/kubernetes/static-pod-resources/configmaps/kube-apiserver-audit-policies/default.yaml"],"authorization-mode":["Scope","SystemMasters","RBAC","Node"],"client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt"],"enable-admission-plugins":["CertificateApproval","CertificateSigning","CertificateSubjectRestriction","DefaultIngressClass","DefaultStorageClass","DefaultTolerationSeconds","LimitRanger","MutatingAdmissionWebhook","NamespaceLifecycle","NodeRestriction","OwnerReferencesPermissionEnforcement","PersistentVolumeClaimResize","PersistentVolumeLabel","PodNodeSelector","PodTolerationRestriction","Priority","ResourceQuota","RuntimeClass","ServiceAccount","StorageObjectInUseProtection","TaintNodesByCondition","ValidatingAdmissionWebhook","authorization.openshift.io/RestrictSubjectBindings","authorization.openshift.io/ValidateRoleBindingRestriction","config.openshift.io/DenyDeleteClusterConfiguration","config.openshift.io/ValidateAPIServer","config.openshift.io/ValidateAuthentication","config.openshift.io/ValidateConsole","config.openshift.io/ValidateFeatureGate","config.openshift.io/ValidateImage","config.openshift.io/ValidateOAuth","config.openshift.io/ValidateProject","config.openshift.io/ValidateScheduler","image.openshift.io/ImagePolicy","network.openshift.io/ExternalIPRanger","network.openshift.io/RestrictedEndpointsAdmission","quota.openshift.io/ClusterResourceQuota","quota.openshift.io/ValidateClusterResourceQuota","route.openshift.io/IngressAdmission","scheduling.openshift.io/OriginPodNodeEnvironment","security.openshift.io/DefaultSecurityContextConstraints","security.openshift.io/SCCExecRestrictions","security.openshift.io/SecurityContextConstraint","security.openshift.io/ValidateSecurityContextConstraints"],"enable-aggregator-routing":["true"],"enable-logs-handler":["false"],"enable-swagger-ui":["true"],"endpoint-reconciler-type":["lease"],"etcd-cafile":["/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt"],"etcd-certfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt"],"etcd-keyfile":["/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key"],"etcd-prefix":["kubernetes.io"],"etcd-servers":["https://192.168.50.10:2379","https://192.168.50.11:2379","https://192.168.50.12:2379","https://localhost:2379"],"event-ttl":["3h"],"feature-gates":["APIPriorityAndFairness=true","RotateKubeletServerCertificate=true","SupportPodPidsLimit=true","NodeDisruptionExclusion=true","ServiceNodeExclusion=true","SCTPSupport=true","LegacyNodeRoleBehavior=false","RemoveSelfLink=false"],"goaway-chance":["0"],"http2-max-streams-per-connection":["2000"],"insecure-port":["0"],"kubelet-certificate-authority":["/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt"],"kubelet-client-certificate":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt"],"kubelet-client-key":["/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key"],"kubelet-https":["true"],"kubelet-preferred-address-types":["InternalIP"],"kubelet-read-only-port":["0"],"kubernetes-service-node-port":["0"],"max-mutating-requests-inflight":["1000"],"max-requests-inflight":["3000"],"min-request-timeout":["3600"],"proxy-client-cert-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.crt"],"proxy-client-key-file":["/etc/kubernetes/static-pod-certs/secrets/aggregator-client/tls.key"],"requestheader-allowed-names":["kube-apiserver-proxy","system:kube-apiserver-proxy","system:openshift-aggregator"],"requestheader-client-ca-file":["/etc/kubernetes/static-pod-certs/configmaps/aggregator-client-ca/ca-bundle.crt"],"requestheader-extra-headers-prefix":["X-Remote-Extra-"],"requestheader-group-headers":["X-Remote-Group"],"requestheader-username-headers":["X-Remote-User"],"runtime-config":["flowcontrol.apiserver.k8s.io/v1alpha1=true"],"service-account-issuer":["https://kubernetes.default.svc"],"service-account-jwks-uri":["https://api-int.ocp.ispworld.at:6443/openid/v1/jwks"],"service-account-lookup":["true"],"service-account-signing-key-file":["/etc/kubernetes/static-pod-certs/secrets/bound-service-account-signing-key/service-account.key"],"service-node-port-range":["30000-32767"],"shutdown-delay-duration":["70s"],"storage-backend":["etcd3"],"storage-media-type":["application/vnd.kubernetes.protobuf"],"tls-cert-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt"],"tls-private-key-file":["/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"]},"apiVersion":"kubecontrolplane.config.openshift.io/v1","authConfig":{"oauthMetadataFile":"/etc/kubernetes/static-pod-resources/configmaps/oauth-metadata/oauthMetadata"},"consolePublicURL":"","corsAllowedOrigins":["//127\\.0\\.0\\.1(:|$)","//localhost(:|$)"],"imagePolicyConfig":{"internalRegistryHostname":"image-registry.openshift-image-registry.svc:5000"},"kind":"KubeAPIServerConfig","projectConfig":{"defaultNodeSelector":""},"serviceAccountPublicKeyFiles":["/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs","/etc/kubernetes/static-pod-resources/configmaps/bound-sa-token-signing-certs"],"servicesSubnet":"172.30.0.0/16","servingInfo":{"bindAddress":"0.0.0.0:6443","bindNetwork":"tcp4","cipherSuites":["TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"],"minTLSVersion":"VersionTLS12","namedCertificates":[{"certFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/localhost-serving-cert-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/external-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-certs/secrets/internal-loadbalancer-serving-certkey/tls.key"},{"certFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.crt","keyFile":"/etc/kubernetes/static-pod-resources/secrets/localhost-recovery-serving-certkey/tls.key"}]}}</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/api/v1/namespaces/openshift-kube-apiserver/configmaps/config').</span>
<span class="label label-default">oval:ssg-test_file_for_kubelet_configure_tls_key:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/api/v1/namespaces/openshift-kube-apiserver/configmaps/config</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>7872</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_audit_profile_set" id=rule-detail-idm45420685894832><div class="keywords sr-only">Ensure that the cluster's audit profile is properly setxccdf_org.ssgproject.content_rule_audit_profile_set mediumCCE-83577-7</div><div class=panel-heading><h3 class=panel-title>Ensure that the cluster's audit profile is properly set</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_audit_profile_set</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-audit_profile_set:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-83577-7">CCE-83577-7</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>3.2.1</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>3.2.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-3(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-6(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-7</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-7(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-8</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-8(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-9</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>AU-12</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-5(1)</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SI-11</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>SI-12</a></p></td></tr><tr><td>Description</td><td><div class=description><p>OpenShift can audit the details of requests made to the API server through
the standard Kubernetes audit capabilities.</p><p>In OpenShift, auditing of the API Server is on by default. Audit provides a
security-relevant chronological set of records documenting the sequence of
activities that have affected system by individual users, administrators, or
other components of the system. Audit works at the API server level, logging
all requests coming to the server. Each audit log contains two entries:</p><p>The request line containing:</p><ul><li>A Unique ID allowing to match the response line (see #2)</li><li>The source IP of the request</li><li>The HTTP method being invoked</li><li>The original user invoking the operation</li><li>The impersonated user for the operation (self meaning himself)</li><li>The impersonated group for the operation (lookup meaning user's group)</li><li>The namespace of the request or none</li><li>The URI as requested</li></ul><p>The response line containing:</p><ul><li>The aforementioned unique ID</li><li>The response code</li></ul><p>For more information on how to configure the audit profile, please visit
<a href=https://docs.openshift.com/container-platform/4.6/security/audit-log-policy-config.html>the documentation</a></p></div></td></tr><tr><td>Rationale</td><td><div class=rationale>Logging is an important detective control for all systems, to detect potential
unauthorised access.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/config.openshift.io/v1/apiservers/cluster</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/config.openshift.io/v1/apiservers/cluster</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/config.openshift.io/v1/apiservers/cluster' find only one object at path 'spec.audit.profile'.</span>
<span class="label label-default">oval:ssg-test_audit_profile_set:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers</td><td>cluster</td><td>spec.audit.profile</td><td>Default</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/config.openshift.io/v1/apiservers/cluster').</span>
<span class="label label-default">oval:ssg-test_file_for_audit_profile_set:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/config.openshift.io/v1/apiservers/cluster</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>869</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_rbac_wildcard_use" id=rule-detail-idm45420685888960><div class="keywords sr-only">Minimize Wildcard Usage in Cluster and Local Rolesxccdf_org.ssgproject.content_rule_rbac_wildcard_use medium</div><div class=panel-heading><h3 class=panel-title>Minimize Wildcard Usage in Cluster and Local Roles</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_rbac_wildcard_use</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.3</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Kubernetes Cluster and Local Roles provide access to resources
based on sets of objects and actions that can be taken on
those objects. It is possible to set either of these using a
wildcard <code>*</code> which matches all items. This violates the
principle of least privilege and leaves a cluster in a more
vulnerable state to privilege abuse.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The principle of least privilege recommends that users are
provided only the access required for their role and nothing
more. The use of wildcard rights grants is likely to provide
excessive rights to the Kubernetes API.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_rbac_limit_secrets_access" id=rule-detail-idm45420685886320><div class="keywords sr-only">Limit Access to Kubernetes Secretsxccdf_org.ssgproject.content_rule_rbac_limit_secrets_access medium</div><div class=panel-heading><h3 class=panel-title>Limit Access to Kubernetes Secrets</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_rbac_limit_secrets_access</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The Kubernetes API stores secrets, which may be service
account tokens for the Kubernetes API or credentials used
by workloads in the cluster. Access to these secrets should
be restricted to the smallest possible group of users to
reduce the risk of privilege escalation. To restrict users from
secrets, remove <code>get</code>, <code>list</code>, and <code>watch</code>
access to unauthorized users to secret objects in the cluster.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Inappropriate access to secrets stored within the Kubernetes
cluster can allow for an attacker to gain additional access to
the Kubernetes cluster or external resources whose credentials
are stored as secrets.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_rbac_pod_creation_access" id=rule-detail-idm45420685883664><div class="keywords sr-only">Minimize Access to Pod Creationxccdf_org.ssgproject.content_rule_rbac_pod_creation_access medium</div><div class=panel-heading><h3 class=panel-title>Minimize Access to Pod Creation</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_rbac_pod_creation_access</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.4</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The ability to create pods in a namespace can provide a
number of opportunities for privilege escalation. Where
applicable, remove <code>create</code> access to <code>pod</code>
objects in the cluster.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>The ability to create pods in a cluster opens up the cluster
for privilege escalation.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-pass rule-detail-id-xccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof" id=rule-detail-idm45420685881008><div class="keywords sr-only">Profiling is protected by RBACxccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof mediumCCE-84182-5</div><div class=panel-heading><h3 class=panel-title>Profiling is protected by RBAC</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof</td></tr><tr><td>Result</td><td class="rule-result rule-result-pass"><div><abbr title="The target system or system component satisfied all the conditions of the rule.">pass</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>OVAL Definition ID</td><td>oval:ssg-rbac_debug_role_protects_pprof:def:1</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-info" title="A globally meaningful identifiers for this rule. MAY be the name or identifier of a security configuration issue or vulnerability that the rule remediates. By setting an identifier on a rule, the benchmark author effectively declares that the rule instantiates, implements, or remediates the issue for which the name was assigned.">Identifiers:</span>
<abbr title="https://nvd.nist.gov/cce/index.cfm: CCE-84182-5">CCE-84182-5</abbr></p><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>1.3.2</a>, <a href=https://www.cisecurity.org/benchmark/kubernetes/>1.4.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Ensure that the cluster-debugger cluster role includes the /debug/pprof
resource URL. This demonstrates that profiling is protected by RBAC, with a
specific cluster role to allow access.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Profiling allows for the identification of specific performance bottlenecks.
It generates a significant amount of program data that could potentially be
exploited to uncover system and program details. If you are not experiencing
any bottlenecks and do not need the profiler for troubleshooting purposes, it
is recommended to turn it off to reduce the potential attack surface. To
ensure the collected data is not exploited, profiling endpoints are secured
via RBAC (see cluster-debugger role). By default, the profiling endpoints are
accessible only by users bound to cluster-admin or cluster-debugger role.
Profiling can not be disabled.</div></td></tr><tr><td>Warnings</td><td><div class="panel panel-warning"><div class=panel-heading><span class="label label-warning">warning</span>
This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the <code class=ocp-api-endpoint>/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</code> API endpoint to the local <code class=ocp-dump-location><abbr title="from Benchmark/Value: xccdf_org.ssgproject.content_value_ocp_data_root">/kubernetes-api-resources</abbr>/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</code> file.</div></div></td></tr></tbody></table><div class=check-system-details><span class="label label-default"><abbr title="OVAL details taken from arf:report with id='oval0'">OVAL test results details</abbr></span><div class="panel panel-default"><div class=panel-body><h4><span class="label label-primary">In the file '/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger' find only one object at path '.rules[0].nonResourceURLs[:]'.</span>
<span class="label label-default">oval:ssg-test_rbac_debug_role_protects_pprof:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Filepath</th><th>Path</th><th>Filename</th><th>Yamlpath</th><th>Value</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</td><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles</td><td>cluster-debugger</td><td>.rules[0].nonResourceURLs[:]</td><td>/debug/pprof
/debug/pprof/*
/metrics</td></tr></tbody></table><h4><span class="label label-primary">Find the file to be checked ('/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger').</span>
<span class="label label-default">oval:ssg-test_file_for_rbac_debug_role_protects_pprof:tst:1</span>
<span class="label label-success">true</span></h4><h5>Following items have been found on the system:</h5><table class="table table-striped table-bordered"><thead><tr><th>Path</th><th>Type</th><th>UID</th><th>GID</th><th>Size (B)</th><th>Permissions</th></tr></thead><tbody><tr><td>/kubernetes-api-resources/apis/rbac.authorization.k8s.io/v1/clusterroles/cluster-debugger</td><td>regular</td><td>1000650000</td><td>1000650000</td><td>773</td><td><code>rw-------</code></td></tr></tbody></table></div></div></div></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin" id=rule-detail-idm45420685875984><div class="keywords sr-only">Ensure that the cluster-admin role is only used where requiredxccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin medium</div><div class=panel-heading><h3 class=panel-title>Ensure that the cluster-admin role is only used where required</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>medium</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.1.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>The RBAC role cluster-admin provides wide-ranging powers over the
environment and should be used only where and when needed.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Kubernetes provides a set of default roles where RBAC is used. Some of these
roles such as cluster-admin provide wide-ranging privileges which should
only be applied where absolutely necessary. Roles such as cluster-admin
allow super-user access to perform any action on any resource. When used in
a ClusterRoleBinding, it gives full control over every resource in the
cluster and in all namespaces. When used in a RoleBinding, it gives full
control over every resource in the rolebinding's namespace, including the
namespace itself.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces" id=rule-detail-idm45420685869424><div class="keywords sr-only">Ensure that application Namespaces have Network Policies defined.xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces high</div><div class=panel-heading><h3 class=panel-title>Ensure that application Namespaces have Network Policies defined.</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.3.2</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>Use network policies to isolate traffic in your cluster network.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Running different applications on the same Kubernetes cluster creates a risk of one
compromised application attacking a neighboring application. Network segmentation is
important to ensure that containers can communicate only with those they are supposed
to. When a network policy is introduced to a given namespace, all traffic not allowed
by the policy is denied. However, if there are no network policies in a namespace all
traffic will be allowed into and out of the pods in that namespace.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><div class="panel panel-default rule-detail rule-detail-notchecked rule-detail-id-xccdf_org.ssgproject.content_rule_configure_network_policies" id=rule-detail-idm45420685864112><div class="keywords sr-only">Ensure that the CNI in use supports Network Policiesxccdf_org.ssgproject.content_rule_configure_network_policies high</div><div class=panel-heading><h3 class=panel-title>Ensure that the CNI in use supports Network Policies</h3></div><div class=panel-body><table class="table table-striped table-bordered"><tbody><tr><td class=col-md-3>Rule ID</td><td class="rule-id col-md-9">xccdf_org.ssgproject.content_rule_configure_network_policies</td></tr><tr><td>Result</td><td class="rule-result rule-result-notchecked"><div><abbr title="The Rule was not evaluated by the checking engine. This status is designed for Rule elements that have no check elements or that correspond to an unsupported checking system. It may also correspond to a status returned by a checking engine if the checking engine does not support the indicated check code.">notchecked</abbr></div></td></tr><tr><td>Multi-check rule</td><td>no</td></tr><tr><td>Time</td><td>2021-07-20T05:21:00+00:00</td></tr><tr><td>Severity</td><td>high</td></tr><tr><td>Identifiers and References</td><td class=identifiers><p><span class="label label-default" title="Provide a reference to a document or resource where the user can learn more about the subject of the Rule or Group.">References:</span>
<a href=https://www.cisecurity.org/benchmark/kubernetes/>5.3.1</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6</a>, <a href=http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf>CM-6(1)</a></p></td></tr><tr><td>Description</td><td><div class=description>There are a variety of CNI plugins available for Kubernetes. If the CNI in
use does not support Network Policies it may not be possible to effectively
restrict traffic in the cluster. OpenShift supports Kubernetes NetworkPolicy
using a Kubernetes Container Network Interface (CNI) plug-in.</div></td></tr><tr><td>Rationale</td><td><div class=rationale>Kubernetes network policies are enforced by the CNI plugin in use. As such
it is important to ensure that the CNI plugin supports both Ingress and
Egress network policies.</div></td></tr><tr><td colspan=2><div class=evaluation-messages><span class="label label-default"><abbr title="Messages taken from rule-result">Evaluation messages</abbr></span><div class="panel panel-default"><div class=panel-body><span class="label label-primary">info</span><pre><message xmlns=http://checklists.nist.gov/xccdf/1.2 severity=info>No candidate or applicable check found.</message></pre></div></div></div></td></tr></tbody></table></div></div><a href=#result-details class="btn btn-info noprint">Scroll back to the first rule</a></div><div id=rear-matter><div class="row top-spacer-10"><div class="col-md-12 well well-lg"><div class=rear-matter>Red Hat and Red Hat Enterprise Linux are either registered
trademarks or trademarks of Red Hat, Inc. in the United States and other
countries. All other names are registered trademarks or trademarks of their
respective companies.</div></div></div></div></div></div><footer id=footer><div class=container><p class="muted credit">Generated using <a href=http://open-scap.org>OpenSCAP</a> 1.3.4</p></div></footer></body></html><footer class=footline></footer></div></div><div id=navigation-bottom><a class="nav-prev btn btn-default" href=/compliance/1/01/ title><i class="fa fa-chevron-left btn-bottom-prev"></i><span class=btn-bottom-text>Previous: </span></a><a class="nav-next btn btn-default" href=/service-mesh/ title="Service Mesh" style=margin-right:0><i class="fa fa-chevron-right btn-bottom-next"></i><span class=btn-bottom-text>Next:</span> Service Mesh</a></div><div class=copyright><p>Copyright &copy; 2020 - 2024 Toni Schmidbauer & Thomas Jungbauer</p></div></section><script>(function(){$("document").ready(function(){var s=$(".read-progress").waypoint({handler:function(e){e=="down"?($(".read-progress").addClass("position-fixed"),$(".read-progress").css("top",0)):($(".read-progress").removeClass("position-fixed"),$(".read-progress").css("top"))}}),t=$(window).height(),e=$(".post-content").height();$(window).on("scroll",n),$(window).on("resize",function(){t=$(window).height(),e=$(".post-content").height(),n()});function n(){var s=$(this).scrollTop(),o=$(".post-content").offset().top,i=e-(e-(t-(o-s))),n=i/e*100,n=n>100?100:n;$(".read-progress").width(n+"%")}})})()</script><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1715151701></script><script src=/js/perfect-scrollbar.min.js?1715151701></script><script src=/js/perfect-scrollbar.jquery.min.js?1715151701></script><script src=/js/jquery.sticky.js?1715151701></script><script src=/js/featherlight.min.js?1715151701></script><script src=/js/highlight.pack.js?1715151701></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1715151701></script><script src=/js/learn.js?1715151701></script><script src=/js/hugo-learn.js?1715151701></script><script src=/js/yaub.js?1715151701></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id");e.intersectionRatio>0&&(clearActiveStatesInTableOfContents(),document.querySelector(`aside nav li a[href="#${t}"]`).parentElement.classList.add("active"))})});document.querySelectorAll("h1[id],h2[id],h3[id]").forEach(t=>{e.observe(t)})});function clearActiveStatesInTableOfContents(){document.querySelectorAll("aside nav li").forEach(e=>{e.classList.remove("active")})}</script><script type=text/javascript>function scrollTopAnimated(){$("html, body").animate({scrollTop:"0"},500)}</script><script>function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll("a.category-link");e.forEach(function(e){var t=e.textContent.trim().toLowerCase();t==="openshift"&&e.classList.add("openshift"),t==="compliance"&&e.classList.add("compliance"),t==="service mesh"&&e.classList.add("mesh"),t==="security"&&e.classList.add("security"),t==="other"&&e.classList.add("other"),t==="ansible"&&e.classList.add("ansible"),t==="supply chain"&&e.classList.add("cicd"),t==="gitops"&&e.classList.add("gitops"),t==="advanced cluster security"&&e.classList.add("acs")})})</script></body></html>