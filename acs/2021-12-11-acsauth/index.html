<!doctype html><html lang=en class="js csstransforms3d"><head><meta name=google-site-verification content="yq2Ib3doJVHVlEW2wtHap5WY54JhS2CCvI40y30F0FI"><meta charset=utf-8><meta name=color-scheme content="dark light"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=description content="Red Hat Advanced Cluster Security - Authentication"><meta name=author content="Toni Schmidbauer & Thomas Jungbauer"><meta name=keywords content="ACS,Advanced Cluster Security,OpenShift,Security,Keycloak,Authentication,SSO,Stackrox"><link rel=canonical href=https://blog.stderr.at/acs/2021-12-11-acsauth/><link rel=icon href=/images/favicon.ico type=image/png><link rel=apple-touch-icon sizes=152x152 href=/images/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-180x180.png><link rel=apple-touch-icon sizes=128x128 href=/images/apple-touch-icon-128x128.png><link rel=apple-touch-icon sizes=144x144 href=/images/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=114x114 href=/images/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=72x72 href=/images/apple-touch-icon-72x72.png><link rel=apple-touch-icon href=/images/apple-touch-icon-57x57.png><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/images/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/images/apple-icon-60x60.png><link rel=apple-touch-icon sizes=76x76 href=/images/apple-icon-76x76.png><link rel=apple-touch-icon sizes=120x120 href=/images/apple-icon-120x120.png><link rel=icon type=image/png sizes=192x192 href=/images/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/images/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><title>Advanced Cluster Security - Authentication :: TechBlog about OpenShift/Ansible/Satellite and much more</title><link rel=manifest href=/manifest.json><meta name=theme-color content="#317EFB"><link href=/css/nucleus.min.css?1689663707 rel=stylesheet><link href=/css/fontawesome-all.min.css?1689663707 rel=stylesheet><link href=/css/font-awesome-animation.min.css?1689663707 rel=stylesheet><link href=/css/hybrid.css?1689663707 rel=stylesheet><link href=/css/featherlight.min.css?1689663707 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1689663707 rel=stylesheet><link href=/css/auto-complete.css?1689663707 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1689663707 rel=stylesheet><link href=/css/theme.min.css?1689663707 rel=stylesheet><link href=/css/hugo-theme.css?1689663707 rel=stylesheet><link href=/css/theme-yaub.css?1689663707 rel=stylesheet><script src=/js/jquery-3.6.0.min.js?1689663707></script>
<script src=/js/jquery.waypoints.min.js?1689663707></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/acs/2021-12-11-acsauth/><button onclick=scrollTopAnimated() id=myBtn class="top-btn button fa fa-arrow-up" title="Go to top"></button>
<span class=read-progress></span><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><p class="fa fa-cloud-upload-alt faa-float animated"></p><span class=text>YAUB</span><p class=logoarea><span class="text small">Yet another Useless Blog</span></p></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1689663707></script>
<script type=text/javascript src=/js/auto-complete.js?1689663707></script>
<script type=text/javascript>var baseurl="https://blog.stderr.at/"</script><script type=text/javascript src=/js/search.js?1689663707></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/openshift/ title=OpenShift class=dd-item><a href=/openshift/>OpenShift</a><ul><li data-nav-id=/openshift/2023-03-20-operator-installation-with-argocd/ title="Operator installation with Argo CD" class=dd-item><a href=/openshift/2023-03-20-operator-installation-with-argocd/>Operator installation with Argo CD</a></li><li data-nav-id=/openshift/2023-16-02-ssl-certificate-management/ title="SSL Certificate Management for OpenShift on AWS" class=dd-item><a href=/openshift/2023-16-02-ssl-certificate-management/>SSL Certificate Management for OpenShift on AWS</a></li><li data-nav-id=/openshift/2022-11-04-argocd-and-serversideapply/ title="Using ServerSideApply with ArgoCD" class=dd-item><a href=/openshift/2022-11-04-argocd-and-serversideapply/>Using ServerSideApply with ArgoCD</a></li><li data-nav-id=/openshift/2022-08-16-hashicorp-vault/ title="Secrets Management - Vault on OpenShift" class=dd-item><a href=/openshift/2022-08-16-hashicorp-vault/>Secrets Management - Vault on OpenShift</a></li><li data-nav-id=/openshift/2022-04-22-multi-cloud-gateway/ title="Overview of Red Hat's Multi Cloud Gateway (Noobaa)" class=dd-item><a href=/openshift/2022-04-22-multi-cloud-gateway/>Overview of Red Hat's Multi Cloud Gateway (Noobaa)</a></li><li data-nav-id=/openshift/2021-09-25-sealed_secrets/ title="Secure your secrets with Sealed Secrets" class=dd-item><a href=/openshift/2021-09-25-sealed_secrets/>Secure your secrets with Sealed Secrets</a></li><li data-nav-id=/openshift/2021-02-27-understanding-block-devices/ title="Understanding RWO block device handling in OpenShift" class=dd-item><a href=/openshift/2021-02-27-understanding-block-devices/>Understanding RWO block device handling in OpenShift</a></li><li data-nav-id=/openshift/2021-01-27-writingoperatoransible/ title="Writing Operator using Ansible" class=dd-item><a href=/openshift/2021-01-27-writingoperatoransible/>Writing Operator using Ansible</a></li><li data-nav-id=/openshift/2020-12-10-thanos-vs-thanos/ title="Thanos Querier vs Thanos Querier" class=dd-item><a href=/openshift/2020-12-10-thanos-vs-thanos/>Thanos Querier vs Thanos Querier</a></li><li data-nav-id=/openshift/2020-08-06-argocd/ title="GitOps - Argo CD" class=dd-item><a href=/openshift/2020-08-06-argocd/>GitOps - Argo CD</a></li><li data-nav-id=/openshift/2020-04-16-tekton/ title="OpenShift Pipelines - Tekton Introduction" class=dd-item><a href=/openshift/2020-04-16-tekton/>OpenShift Pipelines - Tekton Introduction</a></li><li data-nav-id=/openshift/2020-04-01-oc-commands/ title="Helpful oc / kubectl commands" class=dd-item><a href=/openshift/2020-04-01-oc-commands/>Helpful oc / kubectl commands</a></li></ul></li><li data-nav-id=/day-2/ title="OpenShift Day-2" class=dd-item><a href=/day-2/>OpenShift Day-2</a><ul><li data-nav-id=/day-2/etcd/ title=etcd class=dd-item><a href=/day-2/etcd/>etcd</a><ul><li data-nav-id=/day-2/etcd/2022-01-29-automatedetcdbackup/ title="Automated ETCD Backup" class=dd-item><a href=/day-2/etcd/2022-01-29-automatedetcdbackup/>Automated ETCD Backup</a></li></ul></li><li data-nav-id=/day-2/labels_environmets/ title="Labels & Environments" class=dd-item><a href=/day-2/labels_environmets/>Labels & Environments</a><ul><li data-nav-id=/day-2/labels_environmets/2022-01-12-creatingenvironment/ title="Working with Environments" class=dd-item><a href=/day-2/labels_environmets/2022-01-12-creatingenvironment/>Working with Environments</a></li></ul></li><li data-nav-id=/day-2/pod-placement/ title="Pod Placement" class=dd-item><a href=/day-2/pod-placement/>Pod Placement</a><ul><li data-nav-id=/day-2/pod-placement/2021-08-26-podplacement-intro/ title=Introduction class=dd-item><a href=/day-2/pod-placement/2021-08-26-podplacement-intro/>Introduction</a></li><li data-nav-id=/day-2/pod-placement/2021-08-29-node-affinity/ title="Node Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-29-node-affinity/>Node Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-27-podplacement/ title=NodeSelector class=dd-item><a href=/day-2/pod-placement/2021-08-27-podplacement/>NodeSelector</a></li><li data-nav-id=/day-2/pod-placement/2021-08-28-affinity/ title="Pod Affinity/Anti-Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-28-affinity/>Pod Affinity/Anti-Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-30-taints/ title="Taints and Tolerations" class=dd-item><a href=/day-2/pod-placement/2021-08-30-taints/>Taints and Tolerations</a></li><li data-nav-id=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/ title="Topology Spread Constraints" class=dd-item><a href=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/>Topology Spread Constraints</a></li><li data-nav-id=/day-2/pod-placement/2021-09-01-descheduler/ title="Using Descheduler" class=dd-item><a href=/day-2/pod-placement/2021-09-01-descheduler/>Using Descheduler</a></li></ul></li></ul></li><li data-nav-id=/securesupplychain/ title="Secure Supply Chain" class=dd-item><a href=/securesupplychain/>Secure Supply Chain</a><ul><li data-nav-id=/securesupplychain/2023-06-15-securesupplychain-intro/ title="Introduction to a Secure Supply Chain" class=dd-item><a href=/securesupplychain/2023-06-15-securesupplychain-intro/>Introduction to a Secure Supply Chain</a></li><li data-nav-id=/securesupplychain/2023-06-16-securesupplychain-step1/ title="Step 1 - Listen to Events" class=dd-item><a href=/securesupplychain/2023-06-16-securesupplychain-step1/>Step 1 - Listen to Events</a></li><li data-nav-id=/securesupplychain/2023-06-17-securesupplychain-step2/ title="Step 2 - Pipelines" class=dd-item><a href=/securesupplychain/2023-06-17-securesupplychain-step2/>Step 2 - Pipelines</a></li><li data-nav-id=/securesupplychain/2023-06-18-securesupplychain-step3/ title="Step 3 - SonarQube" class=dd-item><a href=/securesupplychain/2023-06-18-securesupplychain-step3/>Step 3 - SonarQube</a></li><li data-nav-id=/securesupplychain/2023-06-19-securesupplychain-step4/ title="Step 4 - Verify Git Commit" class=dd-item><a href=/securesupplychain/2023-06-19-securesupplychain-step4/>Step 4 - Verify Git Commit</a></li><li data-nav-id=/securesupplychain/2023-06-20-securesupplychain-step5/ title="Step 5 - Build and Sign Image" class=dd-item><a href=/securesupplychain/2023-06-20-securesupplychain-step5/>Step 5 - Build and Sign Image</a></li><li data-nav-id=/securesupplychain/2023-06-21-securesupplychain-step6/ title="Step 6 - Scanning with ACS" class=dd-item><a href=/securesupplychain/2023-06-21-securesupplychain-step6/>Step 6 - Scanning with ACS</a></li><li data-nav-id=/securesupplychain/2023-06-22-securesupplychain-step7/ title="Step 7 - Generating a SBOM" class=dd-item><a href=/securesupplychain/2023-06-22-securesupplychain-step7/>Step 7 - Generating a SBOM</a></li><li data-nav-id=/securesupplychain/2023-06-23-securesupplychain-step8/ title="Step 8 - Updating Kubernetes Manifests" class=dd-item><a href=/securesupplychain/2023-06-23-securesupplychain-step8/>Step 8 - Updating Kubernetes Manifests</a></li><li data-nav-id=/securesupplychain/2023-06-24-securesupplychain-step9/ title="Step 9 - Linting Kubernetes Manifests" class=dd-item><a href=/securesupplychain/2023-06-24-securesupplychain-step9/>Step 9 - Linting Kubernetes Manifests</a></li><li data-nav-id=/securesupplychain/2023-06-25-securesupplychain-step10/ title="Step 10 - The Example Application" class=dd-item><a href=/securesupplychain/2023-06-25-securesupplychain-step10/>Step 10 - The Example Application</a></li><li data-nav-id=/securesupplychain/2023-06-26-securesupplychain-step11/ title="Step 11 - ACS Deployment Check" class=dd-item><a href=/securesupplychain/2023-06-26-securesupplychain-step11/>Step 11 - ACS Deployment Check</a></li><li data-nav-id=/securesupplychain/2023-06-27-securesupplychain-step12/ title="Step 12 - Verify TLog Signature" class=dd-item><a href=/securesupplychain/2023-06-27-securesupplychain-step12/>Step 12 - Verify TLog Signature</a></li><li data-nav-id=/securesupplychain/2023-06-28-securesupplychain-step13/ title="Step 13 - Bring it to Production" class=dd-item><a href=/securesupplychain/2023-06-28-securesupplychain-step13/>Step 13 - Bring it to Production</a></li></ul></li><li data-nav-id=/compliance/ title=Compliance class=dd-item><a href=/compliance/>Compliance</a><ul><li data-nav-id=/compliance/2021/07/oc-compliance-command-line-plugin/ title="oc compliance command line plugin" class=dd-item><a href=/compliance/2021/07/oc-compliance-command-line-plugin/>oc compliance command line plugin</a></li><li data-nav-id=/compliance/2021/07/compliance-operator/ title="Compliance Operator" class=dd-item><a href=/compliance/2021/07/compliance-operator/>Compliance Operator</a></li></ul></li><li data-nav-id=/service-mesh/ title="Service Mesh" class=dd-item><a href=/service-mesh/>Service Mesh</a><ul><li data-nav-id=/service-mesh/2020/05/enable-automatic-route-creation/ title="Enable Automatic Route Creation" class=dd-item><a href=/service-mesh/2020/05/enable-automatic-route-creation/>Enable Automatic Route Creation</a></li><li data-nav-id=/service-mesh/2020/05/authorization-rbac/ title="Authorization (RBAC)" class=dd-item><a href=/service-mesh/2020/05/authorization-rbac/>Authorization (RBAC)</a></li><li data-nav-id=/service-mesh/2020/04/deploy-example-bookinfo-application/ title="Deploy Example Bookinfo Application" class=dd-item><a href=/service-mesh/2020/04/deploy-example-bookinfo-application/>Deploy Example Bookinfo Application</a></li><li data-nav-id=/service-mesh/2020/04/service-mesh-1.1-released/ title="Service Mesh 1.1 released" class=dd-item><a href=/service-mesh/2020/04/service-mesh-1.1-released/>Service Mesh 1.1 released</a></li><li data-nav-id=/service-mesh/2020/04/authentication-jwt/ title="Authentication JWT" class=dd-item><a href=/service-mesh/2020/04/authentication-jwt/>Authentication JWT</a></li><li data-nav-id=/service-mesh/2020/04/mutual-tls-authentication/ title="Mutual TLS Authentication" class=dd-item><a href=/service-mesh/2020/04/mutual-tls-authentication/>Mutual TLS Authentication</a></li><li data-nav-id=/service-mesh/2020/04/fault-injection/ title="Fault Injection" class=dd-item><a href=/service-mesh/2020/04/fault-injection/>Fault Injection</a></li><li data-nav-id=/service-mesh/2020/04/limit-egress/external-traffic/ title="Limit Egress/External Traffic" class=dd-item><a href=/service-mesh/2020/04/limit-egress/external-traffic/>Limit Egress/External Traffic</a></li><li data-nav-id=/service-mesh/2020/04/advanced-routing-example/ title="Advanced Routing Example" class=dd-item><a href=/service-mesh/2020/04/advanced-routing-example/>Advanced Routing Example</a></li><li data-nav-id=/service-mesh/2020/04/routing-example/ title="Routing Example" class=dd-item><a href=/service-mesh/2020/04/routing-example/>Routing Example</a></li><li data-nav-id=/service-mesh/2020/03/ingress-with-custom-domain/ title="Ingress with custom domain" class=dd-item><a href=/service-mesh/2020/03/ingress-with-custom-domain/>Ingress with custom domain</a></li><li data-nav-id=/service-mesh/2020/03/ingress-traffic/ title="Ingress Traffic" class=dd-item><a href=/service-mesh/2020/03/ingress-traffic/>Ingress Traffic</a></li><li data-nav-id=/service-mesh/2020/03/deploy-microservices/ title="Deploy Microservices" class=dd-item><a href=/service-mesh/2020/03/deploy-microservices/>Deploy Microservices</a></li><li data-nav-id=/service-mesh/2020/03/installation/ title=Installation class=dd-item><a href=/service-mesh/2020/03/installation/>Installation</a></li></ul></li><li data-nav-id=/general/ title=General class=dd-item><a href=/general/>General</a><ul><li data-nav-id=/general/2020/05/basic-usage-of-git/ title="Basic usage of git" class=dd-item><a href=/general/2020/05/basic-usage-of-git/>Basic usage of git</a></li><li data-nav-id=/general/2020/04/red-hat-satellite-cheat-sheet/ title="Red Hat Satellite Cheat Sheet" class=dd-item><a href=/general/2020/04/red-hat-satellite-cheat-sheet/>Red Hat Satellite Cheat Sheet</a></li></ul></li><li data-nav-id=/ansible/ title=Ansible class=dd-item><a href=/ansible/>Ansible</a><ul><li data-nav-id=/ansible/2021/11/ansible-style-guide/ title="Ansible Style Guide" class=dd-item><a href=/ansible/2021/11/ansible-style-guide/>Ansible Style Guide</a></li><li data-nav-id=/ansible/2021/10/automation-controller-and-ldap-authentication/ title="Automation Controller and LDAP Authentication" class=dd-item><a href=/ansible/2021/10/automation-controller-and-ldap-authentication/>Automation Controller and LDAP Authentication</a></li><li data-nav-id=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" class=dd-item><a href=/ansible/2021/07/ansible-tower-and-downloading-collections/>Ansible Tower and downloading collections</a></li><li data-nav-id=/ansible/2020/04/ansible-azure-resource-manager-example/ title="Ansible - Azure Resource Manager Example" class=dd-item><a href=/ansible/2020/04/ansible-azure-resource-manager-example/>Ansible - Azure Resource Manager Example</a></li><li data-nav-id=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" class=dd-item><a href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/>DO410 Ansible and Ansible Tower training notes</a></li></ul></li><li data-nav-id=/acs/ title="Advanced Cluster Security" class="dd-item
parent"><a href=/acs/>Advanced Cluster Security</a><ul><li data-nav-id=/acs/2021-12-11-acsauth/ title="Advanced Cluster Security - Authentication" class="dd-item active"><a href=/acs/2021-12-11-acsauth/>Advanced Cluster Security - Authentication</a></li></ul></li><li data-nav-id=/azure/ title=Azure class=dd-item><a href=/azure/>Azure</a><ul><li data-nav-id=/azure/2021-10-29-private-aro/ title="Stumbling into Azure Part II: Setting up a private ARO cluster" class=dd-item><a href=/azure/2021-10-29-private-aro/>Stumbling into Azure Part II: Setting up a private ARO cluster</a></li><li data-nav-id=/azure/2021-10-17-s2s-vpn/ title="Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing" class=dd-item><a href=/azure/2021-10-17-s2s-vpn/>Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing</a></li></ul></li><li data-nav-id=/java/ title=Java class=dd-item><a href=/java/>Java</a><ul><li data-nav-id=/java/2022-02-25-jpa-disconnected-entity/ title="Adventures in Java Land: JPA disconnected entities" class=dd-item><a href=/java/2022-02-25-jpa-disconnected-entity/>Adventures in Java Land: JPA disconnected entities</a></li></ul></li><li data-nav-id=/quay/ title=Quay class=dd-item><a href=/quay/>Quay</a><ul><li data-nav-id=/quay/2021-09-07-quay-upgrade-3.4/ title="Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator" class=dd-item><a href=/quay/2021-09-07-quay-upgrade-3.4/>Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator</a></li><li data-nav-id=/quay/2020-05-13-quay-tutorial1/ title="Red Hat Quay Registry - Overview and Installation" class=dd-item><a href=/quay/2020-05-13-quay-tutorial1/>Red Hat Quay Registry - Overview and Installation</a></li></ul></li><li data-nav-id=/legaldisclosure/ title="Legal Disclosure" class=dd-item><a href=/legaldisclosure/>Legal Disclosure</a></li><li data-nav-id=/rss/ title="RSS Feeds" class=dd-item><a href=/rss/>RSS Feeds</a></li></ul><section id=shortcuts><h3 class=shortcut-title>More</h3><ul><li><a class=padding href=https://blog.stderr.at/tags><i class='fas fa-tags'></i> Tags</a></li><li><a class=padding href=https://blog.stderr.at/categories><i class='far fa-bookmark'></i> Catagories</a></li><li><a class=padding href=https://blog.stderr.at/archive><i class='fas fa-box'></i> Archive</a></li><li><a class=padding href=https://charts.stderr.at/><i class='fas fa-book'></i> Helm Charts</a></li><li><a class=padding href=https://www.redhat.com><i class='fab fa-redhat'></i> Red Hat</a></li></ul></section><section id=footer></section></div></nav><section id=body class=post-content><div id=overlay></div><aside id=toc-field class="hidden lg:block tableOfContentContainer"><header id=TableOfContentsHeader>What's on this Page</header><nav id=TableOfContents><ul><li><a href=#_prerequisites>Prerequisites</a></li><li><a href=#_introduction>Introduction</a></li><li><a href=#_configure_rhacs_authentication_openshift_auth>Configure RHACS Authentication: OpenShift Auth</a></li><li><a href=#_verify_authentication_with_openshift_auth>Verify Authentication with OpenShift Auth</a></li><li><a href=#_configure_red_hat_single_sign_on>Configure Red Hat Single Sign On</a></li><li><a href=#_create_test_users>Create Test Users</a></li><li><a href=#_configure_rhacs_authentication_rhsso>Configure RHACS Authentication: RHSSO</a></li><li><a href=#_continue_rhsso_configuration>Continue RHSSO Configuration</a></li><li><a href=#_troubleshoot_test_login>Troubleshoot: Test Login</a></li><li><a href=#_verify_authentication_with_openshift_auth_2>Verify Authentication with OpenShift Auth</a></li></ul></nav><div id=navigation><a class=nav-prev href=/acs/ title="Advanced Cluster Security"><i class="fa fa-chevron-left"></i></a>
<a class=nav-next href=/azure/ title=Azure style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></aside><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/><span itemprop=name>YAUB Yet Another Useless Blog</span><meta itemprop=position content="1"></a></span>> <span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/acs/><span itemprop=name>Advanced Cluster Security</span><meta itemprop=position content="2"></a></span>> Advanced Cluster Security - Authentication</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#_prerequisites>Prerequisites</a></li><li><a href=#_introduction>Introduction</a></li><li><a href=#_configure_rhacs_authentication_openshift_auth>Configure RHACS Authentication: OpenShift Auth</a></li><li><a href=#_verify_authentication_with_openshift_auth>Verify Authentication with OpenShift Auth</a></li><li><a href=#_configure_red_hat_single_sign_on>Configure Red Hat Single Sign On</a></li><li><a href=#_create_test_users>Create Test Users</a></li><li><a href=#_configure_rhacs_authentication_rhsso>Configure RHACS Authentication: RHSSO</a></li><li><a href=#_continue_rhsso_configuration>Continue RHSSO Configuration</a></li><li><a href=#_troubleshoot_test_login>Troubleshoot: Test Login</a></li><li><a href=#_verify_authentication_with_openshift_auth_2>Verify Authentication with OpenShift Auth</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/acs>ACS</a>
<a class=tag-link href=/tags/advanced-cluster-security>Advanced Cluster Security</a>
<a class=tag-link href=/tags/openshift>OpenShift</a>
<a class=tag-link href=/tags/security>Security</a>
<a class=tag-link href=/tags/keycloak>Keycloak</a>
<a class=tag-link href=/tags/authentication>Authentication</a>
<a class=tag-link href=/tags/sso>SSO</a>
<a class=tag-link href=/tags/stackrox>Stackrox</a></div></div><div id=body-inner><h1>Advanced Cluster Security - Authentication</h1><p class=tracked><time class="f6 mv4 dib tracked" datetime=2021-12-11T00:00:00Z><strong>December 11, 2021</strong></time>
- By:
Thomas Jungbauer
( Lastmod: 2021-12-13 ) - <span class=readtime><strong>4 min read</strong></span></p><div class=paragraph><p>Red Hat Advanced Cluster Security (RHACS) Central is installed with one administrator user by default. Typically, customers request an integration with existing Identity Provider(s) (IDP). RHACS offers different options for such integration. In this article 2 IDPs will be configured as an example. First OpenShift Auth and second Red Hat Single Sign On (RHSSO) based on Keycloak</p></div><div class=sect1><h2 id=_prerequisites>Prerequisites</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>OpenShift 4 Cluster</p></li><li><p>Advanced Cluster Security v3.66+</p></li><li><p>Red Hat SSO Operator installed</p></li></ol></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content>While RHSSO will be installed during this article, only default and example values are used. These are by no means examples for a production system.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_introduction>Introduction</h2><div class=sectionbody><div class=paragraph><p>Advanced Cluster Security comes with several default roles, which can be assigned to users:</p></div><table class="tableblock frame-all grid-all stretch"><col style=width:33.3333%><col style=width:66.6667%><thead><tr><th class="tableblock halign-left valign-top">System role</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Admin</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>This role is targeted for administrators. Use it to provide read and write access to all resources.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Analyst</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>This role is targeted for a user who cannot make any changes, but can view everything. Use it to provide read-only access for all resources.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Continuous Integration</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>This role is targeted for CI (continuous integration) systems and includes the permission set required to enforce deployment policies.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>None</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>This role has no read and write access to any resource. You can set this role as the minimum access role for all users.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Sensor Creator</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Red Hat Advanced Cluster Security for Kubernetes uses this role to automate new cluster setups. It includes the permission set to create Sensors in secured clusters.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Scope Manager</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>This role includes the minimum permissions required to create and modify access scopes.</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>It is possible to create custom roles.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_configure_rhacs_authentication_openshift_auth>Configure RHACS Authentication: OpenShift Auth</h2><div class=sectionbody><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>It is assumed that RHACS is already installed and login to the Central UI is available.</td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Login to your RHACS and select “Platform Configuration” > “Access Control”</p></li><li><p>From the drop down menu <strong>Add auth provider</strong> select <strong>OpenShift Auth</strong></p><div class=imageblock><div class=content><img src="/ACS/images/ACS-AuthProvider.png?width=940px" alt="ACS AuthProvider"></div><div class=title>Figure 1. ACS Auth Provider</div></div></li><li><p>Enter a <strong>Name</strong> for your provider and select a default role which is assigned to any user who can authenticate.</p><div class=paragraph><p>It is recommended to select the role <strong>None</strong>, so new accounts will have no privileges in RHACS.</p></div><div class=paragraph><p>With Rules you can assign roles to specific users, based on their userid, name, mail address or groups.</p></div><div class=paragraph><p>For example the user with the name <strong>poweruser</strong> gets the role <strong>Admin</strong> assigned.</p></div></li></ol></div></div></div><div class=sect1><h2 id=_verify_authentication_with_openshift_auth>Verify Authentication with OpenShift Auth</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>Logout from the Central UI and reload the browser.</p></li><li><p>Select from the drop down <strong>OpenShift Auth</strong></p><div class=imageblock><div class=content><img src="/ACS/images/ACS-LoginOpenShiftAuth.png?width=420px" alt="ACS LoginOpenShiftAuth"></div><div class=title>Figure 2. ACS Login</div></div></li><li><p>Try to login with a valid OpenShift user.<br>Depending on the Rules which have been defined during previous steps the appropriate permissions should be assigned.<br>For example: If you login as user <strong>poweruser</strong> the role <strong>Admin</strong> is assigned.</p></li></ol></div><hr></div></div><div class=sect1><h2 id=_configure_red_hat_single_sign_on>Configure Red Hat Single Sign On</h2><div class=sectionbody><div class=paragraph><p>The following steps will create some basic example objects to an existing RHSSO or Keycloak to test the authentication at RHACS.
Skip to step #5 if you have Keycloak already up and running and would like to reuse an existing client.</p></div><div class=paragraph><p>The RHSSO operator (or Keycloak) is installed at the namespace <strong>single-sign-on</strong>.</p></div><div class="olist arabic"><ol class=arabic><li><p>Create an instance of Keycloak</p><div class=listingblock><div class=content><pre class=highlight><code class=language-yaml data-lang=yaml>apiVersion: keycloak.org/v1alpha1
kind: Keycloak
metadata:
  name: example-keycloak
  namespace: single-sign-on
spec:
  externalAccess:
    enabled: true
  instances: 1</code></pre></div></div></li><li><p>Create a Realm<br>This will create a Realm called <strong>Basic</strong></p><div class=listingblock><div class=content><pre class=highlight><code class=language-yaml data-lang=yaml>apiVersion: keycloak.org/v1alpha1
kind: KeycloakRealm
metadata:
 name: example-keycloakrealm
 namespace: single-sign-on
spec:
 instanceSelector:
   matchLabels:
     app: sso
 realm:
   displayName: Basic Realm
   enabled: true
   id: basic
   realm: basic</code></pre></div></div></li><li><p>Login into Red Hat SSO<br>Get the route to your RHSSO instance:</p><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>oc get route keycloak -n single-sign-on --template=&#39;{{ .spec.host }}&#39;

# keycloak-single-sign-on.apps.cluster-29t8z.29t8z.sandbox677.opentlc.com</code></pre></div></div><div class=paragraph><p>and log into the Administration Interface.</p></div></li><li><p>Extract the admin password for Keycloak</p><div class=paragraph><p>The secret name is build from "credential"&lt;keycloak-instance-name></p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>oc extract secret/credential-example-keycloak -n single-sign-on --to=-

# ADMIN_PASSWORD
&lt;you password&gt;
# ADMIN_USERNAME
admin</code></pre></div></div></li><li><p>Be sure to select your Realm (<strong>Basic</strong> in our case), goto <strong>Clients</strong> and select a ClientID.</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>In this example we select <strong>account</strong></p><div class=imageblock><div class=content><img src="/ACS/images/ACS-SSOClientConfig.png?width=640px" alt="ACS SSOClientConfig"></div><div class=title>Figure 3. ACS Login</div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>Of course you can create or use any other Client.</td></tr></tbody></table></div></li><li><p>Enable the option <strong>Implicit Flow</strong></p></li></ol></div></li><li><p>Get the <strong>Issuer URL</strong> from your realm. This is typically your:<br><a href="https://<KEYCLOAK_URL>/auth/realms/<REALM_NAME>" class=bare>https://&lt;KEYCLOAK_URL>/auth/realms/&lt;REALM_NAME></a>;</p><div class=paragraph><p>For Example:
<a href=https://keycloak-single-sign-on.apps.cluster-29t8z.29t8z.sandbox677.opentlc.com/auth/realms/basic class=bare>https://keycloak-single-sign-on.apps.cluster-29t8z.29t8z.sandbox677.opentlc.com/auth/realms/basic</a></p></div></li></ol></div></div></div><div class=sect1><h2 id=_create_test_users>Create Test Users</h2><div class=sectionbody><div class=paragraph><p>In RHSSO create 2 user accounts to test the authentication later.</p></div><div class="olist arabic"><ol class=arabic><li><p>Goto <strong>Users</strong> and create the users:</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>User: acsadmin</p><div class=paragraph><p>First Name: acsadmin</p></div></li><li><p>User: user1</p><div class=paragraph><p>First Name: user 1</p></div></li></ol></div></li></ol></div><div class=paragraph><p><strong>You can set any other values for these users. However, be sure to set a password for both, after they have been created.</strong></p></div></div></div><div class=sect1><h2 id=_configure_rhacs_authentication_rhsso>Configure RHACS Authentication: RHSSO</h2><div class=sectionbody><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>It is assumed that RSACS is already installed and login to the Central UI is available.</td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Login to your RHACS and select “Platform Configuration” > “Access Control”</p></li><li><p>From the drop down menu <strong>Add auth provider</strong> select <strong>OpenID Connect</strong></p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Enter a “Name” for your provider i.e. “Single Sign On”</p></li><li><p>Leave the “Callback Mode” to the “Auto-Select” setting</p></li><li><p>Enter your Issuer URL</p></li><li><p>As Client ID enter <strong>account</strong> (or the ClientID you would like to use)</p></li><li><p>Leave the Client Secret empty and select the checkbox <strong>Do not use Client Secret</strong> which is good enough for our tests.</p><div class=paragraph><p>Remember the two callback URL from the blue box. They must be configured in Keycloak.</p></div></li><li><p>Select a default role which is assigned to any user who can authenticate.</p><div class=paragraph><p>It is recommended to select the role <strong>None</strong>, so new accounts will have no privileges in RHACS.</p></div></li><li><p>With Rules you can assign roles to specific users, based on their userid, name, mail address or groups.</p></li><li><p>For example the user with the name <strong>acsadmin</strong> (which have been created previously in our RHSSO) gets the role <strong>Admin</strong> assigned.</p></li></ol></div></li></ol></div><div class=paragraph><p>The final settings are depict in the following image:</p></div><div class=imageblock><div class=content><img src="/ACS/images/ACS-OpenIDConfig.png?width=640px" alt="ACS OpenIDConfig"></div><div class=title>Figure 4. ACS Login</div></div></div></div><div class=sect1><h2 id=_continue_rhsso_configuration>Continue RHSSO Configuration</h2><div class=sectionbody><div class=paragraph><p>What is left to do is the configuration of redirect URLs. These URLs are shown in the ACS Authentication Provider configuration (see blue field in the image above)</p></div><div class="olist arabic"><ol class=arabic><li><p>Log back into RHSSO and select “Clients” > “account”</p></li><li><p>Into <strong>Valid Redirect URLs</strong> enter the two URLs which you saved from the blue box in the RHACS configuration.</p></li></ol></div></div></div><div class=sect1><h2 id=_troubleshoot_test_login>Troubleshoot: Test Login</h2><div class=sectionbody><div class=paragraph><p>In RHACS you can test the login to you SSO.</p></div><div class="olist arabic"><ol class=arabic><li><p>Goto "Platform Configuration" > "Access Control"</p></li><li><p>Click the button "Test login"</p><div class=paragraph><p>A popup will appear which asks you to enter SSO credentials. The connection to RHSSO will be validated:</p></div><div class=imageblock><div class=content><img src="/ACS/images/ACS-TestSSOAuth.png?width=420px" alt="ACS TestSSOAuth"></div><div class=title>Figure 5. ACS Test SSO</div></div></li></ol></div></div></div><div class=sect1><h2 id=_verify_authentication_with_openshift_auth_2>Verify Authentication with OpenShift Auth</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>Logout from the Central UI and reload the browser.</p></li><li><p>Select from the drop down <strong>Single Sign On</strong></p><div class=imageblock><div class=content><img src="/ACS/images/ACS-LoginSSOAuth.png?width=420px" alt="ACS LoginSSOAuth"></div><div class=title>Figure 6. ACS Login SSO</div></div></li><li><p>Try to login with a valid SSO user.<br>Depending on the Rules which have been defined during previous steps the appropriate permissions should be assigned.<br>For example: If you login as user <strong>acsadmin</strong> the role <strong>Admin</strong> is assigned.</p></li></ol></div></div></div><footer class=footline></footer></div></div><div id=navigation-bottom><a class="nav-prev btn btn-default" href=/acs/ title="Advanced Cluster Security"><i class="fa fa-chevron-left btn-bottom-prev"></i><span class=btn-bottom-text>Previous:</span> Advanced Cluster Security</a>
<a class="nav-next btn btn-default" href=/azure/ title=Azure style=margin-right:0><i class="fa fa-chevron-right btn-bottom-next"></i><span class=btn-bottom-text>Next:</span> Azure</a></div><div class=copyright><p>Copyright &copy; 2020 - 2023 Toni Schmidbauer & Thomas Jungbauer</p><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn target=_blank rel="noopener noreferrer">Hugo Learn Theme</i></a> and <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a></p></div></section><script>(function(){$("document").ready(function(){var s=$(".read-progress").waypoint({handler:function(e){e=="down"?($(".read-progress").addClass("position-fixed"),$(".read-progress").css("top",0)):($(".read-progress").removeClass("position-fixed"),$(".read-progress").css("top"))}}),t=$(window).height(),e=$(".post-content").height();$(window).on("scroll",n),$(window).on("resize",function(){t=$(window).height(),e=$(".post-content").height(),n()});function n(){var s=$(this).scrollTop(),o=$(".post-content").offset().top,i=e-(e-(t-(o-s))),n=i/e*100,n=n>100?100:n;$(".read-progress").width(n+"%")}})})()</script><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1689663711></script>
<script src=/js/perfect-scrollbar.min.js?1689663711></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1689663711></script>
<script src=/js/jquery.sticky.js?1689663711></script>
<script src=/js/featherlight.min.js?1689663711></script>
<script src=/js/highlight.pack.js?1689663711></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1689663711></script>
<script src=/js/learn.js?1689663711></script>
<script src=/js/hugo-learn.js?1689663711></script>
<script src=/js/yaub.js?1689663711></script>
<script>window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id");e.intersectionRatio>0&&(clearActiveStatesInTableOfContents(),document.querySelector(`aside nav li a[href="#${t}"]`).parentElement.classList.add("active"))})});document.querySelectorAll("h1[id],h2[id],h3[id]").forEach(t=>{e.observe(t)})});function clearActiveStatesInTableOfContents(){document.querySelectorAll("aside nav li").forEach(e=>{e.classList.remove("active")})}</script><script type=text/javascript>function scrollTopAnimated(){$("html, body").animate({scrollTop:"0"},500)}</script><script>function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}$(".summary-box").click(function(){return window.location=$(this).find("a").attr("href"),!1})</script></body></html>