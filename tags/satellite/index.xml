<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Satellite on TechBlog about OpenShift/Ansible/Satellite and much more</title><link>https://blog.stderr.at/tags/satellite/</link><description>TechBlog about OpenShift/Ansible/Satellite and much more</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Toni Schmidbauer &amp; Thomas Jungbauer</copyright><lastBuildDate>Wed, 15 Apr 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.stderr.at/tags/satellite/index.xml" rel="self" type="application/rss+xml"/><item><title>General</title><link>https://blog.stderr.at/general/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.stderr.at/general/</guid><description/></item><item><title>Red Hat Satellite Cheat Sheet</title><link>https://blog.stderr.at/general/2020/04/red-hat-satellite-cheat-sheet/</link><pubDate>Wed, 15 Apr 2020 00:00:00 +0000</pubDate><guid>https://blog.stderr.at/general/2020/04/red-hat-satellite-cheat-sheet/</guid><description>&lt;div class="paragraph">
&lt;p>Cheat sheet for various Red Hat Satellite tasks from a newbie to a newbie.&lt;/p>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_requirements">Requirements&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="ulist">
&lt;ul>
&lt;li>
&lt;p>up to Satellite 6.7 RHEL 7.X&lt;/p>
&lt;/li>
&lt;li>
&lt;p>4 CPU Cores&lt;/p>
&lt;/li>
&lt;li>
&lt;p>20 GB of RAM&lt;/p>
&lt;/li>
&lt;li>
&lt;p>300 GB disk space&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/div>
&lt;div class="paragraph">
&lt;p>for more info see the &lt;a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/installing_satellite_server_from_a_connected_network/preparing_your_environment_for_installation#storage_requirements">prerequistes guide&lt;/a>&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_installation">Installation&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>Satellite up to version 6.7 uses puppet for installation. You can use&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">puppet filebucket&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>to restore files modified by puppet.&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Satellite requires the &lt;em>Red Hat Satellite Infrastructure Subscription&lt;/em>, check if it’s available with&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">subscription-manager list --all --available --matches &amp;#39;Red Hat Satellite Infrastructure Subscription&amp;#39;&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>If not attach it with&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">subscription-manager attach --pool=pool_id&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Next disable all repos and enable only supported repostories via&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">subscription-manager repos --disable &amp;#34;*&amp;#34;&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>and enable required repositories&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">subscription-manager repos --enable=rhel-7-server-rpms \
--enable=rhel-7-server-satellite-6.6-rpms \
--enable=rhel-7-server-satellite-maintenance-6-rpms \
--enable=rhel-server-rhscl-7-rpms \
--enable=rhel-7-server-ansible-2.8-rpms&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>then clean cached all repo data via&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash"> yum clean all&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>and install satellite packages via&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">yum install satellite&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>Install satellite with&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-installer --scenario satellite \
--foreman-initial-organization &amp;#34;initial_organization_name&amp;#34; \
--foreman-initial-location &amp;#34;initial_location_name&amp;#34; \
--foreman-initial-admin-username admin_user_name \
--foreman-initial-admin-password admin_password&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_backup_restore_cloning">Backup / Restore / Cloning&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="paragraph">
&lt;p>Use &lt;code>satellite-maintain&lt;/code> for doing offline and online backups&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain backup offline /backup/&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>when using the &lt;em>online&lt;/em> option make sure that no new content view or
content view versions should be created while the backup is
running. basically satellite should be idle.&lt;/p>
&lt;/div>
&lt;div class="sect2">
&lt;h3 id="_cloning_satellite">Cloning Satellite&lt;/h3>
&lt;div class="paragraph">
&lt;p>The online/offline options also backup &lt;em>/var/lib/pulp&lt;/em>, which contains
all downloaded packages. This could be &lt;strong>huge&lt;/strong>. There’s an option to skip this so&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain backup offline --skip-pulp-tar /backup/&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="admonitionblock note">
&lt;table>
&lt;tbody>&lt;tr>
&lt;td class="icon">
&lt;i class="fa icon-note" title="Note">&lt;/i>
&lt;/td>
&lt;td class="content">
For a restore you always need the content of &lt;em>/var/lib/pulp&lt;/em>.
&lt;/td>
&lt;/tr>
&lt;/tbody>&lt;/table>
&lt;/div>
&lt;div class="paragraph">
&lt;p>This is mainly usefull for cloning satellite. You backup everything
except &lt;em>/var/lib/pulp&lt;/em>, copy the backup to a second system and rsync
&lt;em>/var/lib/pulp&lt;/em> to the new system. Then restore the backup and
satellite should work as normal on the clone.&lt;/p>
&lt;/div>
&lt;/div>
&lt;div class="sect2">
&lt;h3 id="_snaphot_backups">Snaphot backups&lt;/h3>
&lt;div class="paragraph">
&lt;p>Satellite also supports backups via LVM snapshots. For more information see &lt;a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-backup_and_disaster_recovery#snapshot-backup_assembly">Snapshot backup&lt;/a>&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_upgrades">Upgrades&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="olist arabic">
&lt;ol class="arabic">
&lt;li>
&lt;p>Read the Satellite release notes&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Do a offline backup see &lt;a href="#Backup / Restore">[Backup / Restore]&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You could clone satellite to a other system&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If there are local changes to dhcpd or dns configurations use&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-installer --foreman-proxy-dns-managed=false --foreman-proxy-dhcp-managed=false&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>to stop satellite-install from overwriting those files.&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>install the latest version of satellite-maintain via&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">yum install rubygem-foreman_maintain&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>check for available satellite versions with&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain upgrade list-versions&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>test the possible upgrade with&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain upgrade check --target-version 6.7&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>and finally run the upgrade and PRAY!&lt;/p>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain upgrade run --target-version 6.7&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect1">
&lt;h2 id="_various_tips_and_tricks">Various tips and tricks&lt;/h2>
&lt;div class="sectionbody">
&lt;div class="sect2">
&lt;h3 id="_installing_packages_via_yum">Installing packages via yum&lt;/h3>
&lt;div class="paragraph">
&lt;p>Satellite installs a yum plugin called &lt;code>foreman-protector&lt;/code>. If you try
to install a package via yum you get the following message&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code>WARNING: Excluding 12190 packages due to foreman-protector.
Use foreman-maintain packages install/update &amp;lt;package&amp;gt;
to safely install packages without restrictions.
Use foreman-maintain upgrade run for full upgrade.&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>so use&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">satellite-maintain install &amp;lt;package name&amp;gt;&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="sect2">
&lt;h3 id="_os_package_upgrade">OS package upgrade&lt;/h3>
&lt;div class="paragraph">
&lt;p>This should be done via satellite-maintain because all packages are locked by default (see &lt;a href="#_installing_packages_via_yum">Installing packages via yum&lt;/a>).&lt;/p>
&lt;/div>
&lt;div class="paragraph">
&lt;p>This basically comes down to running&lt;/p>
&lt;/div>
&lt;div class="listingblock">
&lt;div class="content">
&lt;pre class="highlight">&lt;code class="language-bash" data-lang="bash">oreman-maintain upgrade run --target-version 6.6.z&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div class="paragraph">
&lt;p>for upgrading OS packages if you have satellite 6.6 installed.&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div></description></item></channel></rss>