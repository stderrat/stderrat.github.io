<!doctype html><html lang=en class="js csstransforms3d"><head><meta name=google-site-verification content="yq2Ib3doJVHVlEW2wtHap5WY54JhS2CCvI40y30F0FI"><meta charset=utf-8><meta name=color-scheme content="dark light"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=description content="Enable LDAP authentication and create and example LDAP server"><meta name=author content="Toni Schmidbauer & Thomas Jungbauer"><link rel=icon href=/images/favicon.ico type=image/png><link rel=apple-touch-icon sizes=152x152 href=/images/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-180x180.png><link rel=apple-touch-icon sizes=128x128 href=/images/apple-touch-icon-128x128.png><link rel=apple-touch-icon sizes=144x144 href=/images/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=114x114 href=/images/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=72x72 href=/images/apple-touch-icon-72x72.png><link rel=apple-touch-icon href=/images/apple-touch-icon-57x57.png><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/images/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/images/apple-icon-60x60.png><link rel=apple-touch-icon sizes=76x76 href=/images/apple-icon-76x76.png><link rel=apple-touch-icon sizes=120x120 href=/images/apple-icon-120x120.png><link rel=icon type=image/png sizes=192x192 href=/images/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/images/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><title>Automation Controller and LDAP Authentication :: TechBlog about OpenShift/Ansible/Satellite and much more</title><link rel=manifest href=/manifest.json><meta name=theme-color content="#317EFB"><link href=/css/nucleus.min.css?1679661797 rel=stylesheet><link href=/css/fontawesome-all.min.css?1679661797 rel=stylesheet><link href=/css/font-awesome-animation.min.css?1679661797 rel=stylesheet><link href=/css/hybrid.css?1679661797 rel=stylesheet><link href=/css/featherlight.min.css?1679661797 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1679661797 rel=stylesheet><link href=/css/auto-complete.css?1679661797 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1679661797 rel=stylesheet><link href=/css/theme.min.css?1679661797 rel=stylesheet><link href=/css/hugo-theme.css?1679661797 rel=stylesheet><link href=/css/theme-yaub.css?1679661797 rel=stylesheet><script src=/js/jquery-3.6.0.min.js?1679661797></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/ansible/2021/10/automation-controller-and-ldap-authentication/><button onclick=scrollTopAnimated() id=myBtn class="top-btn button fa fa-arrow-up" title="Go to top"></button><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><p class="fa fa-cloud-upload-alt faa-float animated"></p><span class=text>YAUB</span><p class=logoarea><span class="text small">Yet another Useless Blog</span></p></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1679661797></script>
<script type=text/javascript src=/js/auto-complete.js?1679661797></script>
<script type=text/javascript>var baseurl="https://blog.stderr.at/"</script><script type=text/javascript src=/js/search.js?1679661797></script></div><div class=togglemode><button id=dark-mode-toggle class="btn-toggle btn-default btn">Toggle Dark-Mode</button></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/openshift/ title=OpenShift class=dd-item><a href=/openshift/>OpenShift</a><ul><li data-nav-id=/openshift/2023-03-20-operator-installation-with-argocd/ title="Operator installation with Argo CD" class=dd-item><a href=/openshift/2023-03-20-operator-installation-with-argocd/>Operator installation with Argo CD</a></li><li data-nav-id=/openshift/2023-16-02-ssl-certificate-management/ title="SSL Certificate Management for OpenShift on AWS" class=dd-item><a href=/openshift/2023-16-02-ssl-certificate-management/>SSL Certificate Management for OpenShift on AWS</a></li><li data-nav-id=/openshift/2022-11-04-argocd-and-serversideapply/ title="Using ServerSideApply with ArgoCD" class=dd-item><a href=/openshift/2022-11-04-argocd-and-serversideapply/>Using ServerSideApply with ArgoCD</a></li><li data-nav-id=/openshift/2022-08-16-hashicorp-vault/ title="Secrets Management - Vault on OpenShift" class=dd-item><a href=/openshift/2022-08-16-hashicorp-vault/>Secrets Management - Vault on OpenShift</a></li><li data-nav-id=/openshift/2022-04-22-multi-cloud-gateway/ title="Overview of Red Hat's Multi Cloud Gateway (Noobaa)" class=dd-item><a href=/openshift/2022-04-22-multi-cloud-gateway/>Overview of Red Hat's Multi Cloud Gateway (Noobaa)</a></li><li data-nav-id=/openshift/2021-09-25-sealed_secrets/ title="Secure your secrets with Sealed Secrets" class=dd-item><a href=/openshift/2021-09-25-sealed_secrets/>Secure your secrets with Sealed Secrets</a></li><li data-nav-id=/openshift/2021-02-27-understanding-block-devices/ title="Understanding RWO block device handling in OpenShift" class=dd-item><a href=/openshift/2021-02-27-understanding-block-devices/>Understanding RWO block device handling in OpenShift</a></li><li data-nav-id=/openshift/2021-01-27-writingoperatoransible/ title="Writing Operator using Ansible" class=dd-item><a href=/openshift/2021-01-27-writingoperatoransible/>Writing Operator using Ansible</a></li><li data-nav-id=/openshift/2020-12-10-thanos-vs-thanos/ title="Thanos Querier vs Thanos Querier" class=dd-item><a href=/openshift/2020-12-10-thanos-vs-thanos/>Thanos Querier vs Thanos Querier</a></li><li data-nav-id=/openshift/2020-08-06-argocd/ title="GitOps - Argo CD" class=dd-item><a href=/openshift/2020-08-06-argocd/>GitOps - Argo CD</a></li><li data-nav-id=/openshift/2020-04-16-tekton/ title="OpenShift Pipelines - Tekton Introduction" class=dd-item><a href=/openshift/2020-04-16-tekton/>OpenShift Pipelines - Tekton Introduction</a></li><li data-nav-id=/openshift/2020-04-01-oc-commands/ title="Helpful oc / kubectl commands" class=dd-item><a href=/openshift/2020-04-01-oc-commands/>Helpful oc / kubectl commands</a></li></ul></li><li data-nav-id=/day-2/ title="OpenShift Day-2" class=dd-item><a href=/day-2/>OpenShift Day-2</a><ul><li data-nav-id=/day-2/etcd/ title=etcd class=dd-item><a href=/day-2/etcd/>etcd</a><ul><li data-nav-id=/day-2/etcd/2022-01-29-automatedetcdbackup/ title="Automated ETCD Backup" class=dd-item><a href=/day-2/etcd/2022-01-29-automatedetcdbackup/>Automated ETCD Backup</a></li></ul></li><li data-nav-id=/day-2/labels_environmets/ title="Labels & Environments" class=dd-item><a href=/day-2/labels_environmets/>Labels & Environments</a><ul><li data-nav-id=/day-2/labels_environmets/2022-01-12-creatingenvironment/ title="Working with Environments" class=dd-item><a href=/day-2/labels_environmets/2022-01-12-creatingenvironment/>Working with Environments</a></li></ul></li><li data-nav-id=/day-2/pod-placement/ title="Pod Placement" class=dd-item><a href=/day-2/pod-placement/>Pod Placement</a><ul><li data-nav-id=/day-2/pod-placement/2021-08-26-podplacement-intro/ title=Introduction class=dd-item><a href=/day-2/pod-placement/2021-08-26-podplacement-intro/>Introduction</a></li><li data-nav-id=/day-2/pod-placement/2021-08-29-node-affinity/ title="Node Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-29-node-affinity/>Node Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-27-podplacement/ title=NodeSelector class=dd-item><a href=/day-2/pod-placement/2021-08-27-podplacement/>NodeSelector</a></li><li data-nav-id=/day-2/pod-placement/2021-08-28-affinity/ title="Pod Affinity/Anti-Affinity" class=dd-item><a href=/day-2/pod-placement/2021-08-28-affinity/>Pod Affinity/Anti-Affinity</a></li><li data-nav-id=/day-2/pod-placement/2021-08-30-taints/ title="Taints and Tolerations" class=dd-item><a href=/day-2/pod-placement/2021-08-30-taints/>Taints and Tolerations</a></li><li data-nav-id=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/ title="Topology Spread Constraints" class=dd-item><a href=/day-2/pod-placement/2021-08-31-topologyspreadcontraints/>Topology Spread Constraints</a></li><li data-nav-id=/day-2/pod-placement/2021-09-01-descheduler/ title="Using Descheduler" class=dd-item><a href=/day-2/pod-placement/2021-09-01-descheduler/>Using Descheduler</a></li></ul></li></ul></li><li data-nav-id=/compliance/ title=Compliance class=dd-item><a href=/compliance/>Compliance</a><ul><li data-nav-id=/compliance/2021/07/oc-compliance-command-line-plugin/ title="oc compliance command line plugin" class=dd-item><a href=/compliance/2021/07/oc-compliance-command-line-plugin/>oc compliance command line plugin</a></li><li data-nav-id=/compliance/2021/07/compliance-operator/ title="Compliance Operator" class=dd-item><a href=/compliance/2021/07/compliance-operator/>Compliance Operator</a></li></ul></li><li data-nav-id=/service-mesh/ title="Service Mesh" class=dd-item><a href=/service-mesh/>Service Mesh</a><ul><li data-nav-id=/service-mesh/2020/05/enable-automatic-route-creation/ title="Enable Automatic Route Creation" class=dd-item><a href=/service-mesh/2020/05/enable-automatic-route-creation/>Enable Automatic Route Creation</a></li><li data-nav-id=/service-mesh/2020/05/authorization-rbac/ title="Authorization (RBAC)" class=dd-item><a href=/service-mesh/2020/05/authorization-rbac/>Authorization (RBAC)</a></li><li data-nav-id=/service-mesh/2020/04/deploy-example-bookinfo-application/ title="Deploy Example Bookinfo Application" class=dd-item><a href=/service-mesh/2020/04/deploy-example-bookinfo-application/>Deploy Example Bookinfo Application</a></li><li data-nav-id=/service-mesh/2020/04/service-mesh-1.1-released/ title="Service Mesh 1.1 released" class=dd-item><a href=/service-mesh/2020/04/service-mesh-1.1-released/>Service Mesh 1.1 released</a></li><li data-nav-id=/service-mesh/2020/04/authentication-jwt/ title="Authentication JWT" class=dd-item><a href=/service-mesh/2020/04/authentication-jwt/>Authentication JWT</a></li><li data-nav-id=/service-mesh/2020/04/mutual-tls-authentication/ title="Mutual TLS Authentication" class=dd-item><a href=/service-mesh/2020/04/mutual-tls-authentication/>Mutual TLS Authentication</a></li><li data-nav-id=/service-mesh/2020/04/fault-injection/ title="Fault Injection" class=dd-item><a href=/service-mesh/2020/04/fault-injection/>Fault Injection</a></li><li data-nav-id=/service-mesh/2020/04/limit-egress/external-traffic/ title="Limit Egress/External Traffic" class=dd-item><a href=/service-mesh/2020/04/limit-egress/external-traffic/>Limit Egress/External Traffic</a></li><li data-nav-id=/service-mesh/2020/04/advanced-routing-example/ title="Advanced Routing Example" class=dd-item><a href=/service-mesh/2020/04/advanced-routing-example/>Advanced Routing Example</a></li><li data-nav-id=/service-mesh/2020/04/routing-example/ title="Routing Example" class=dd-item><a href=/service-mesh/2020/04/routing-example/>Routing Example</a></li><li data-nav-id=/service-mesh/2020/03/ingress-with-custom-domain/ title="Ingress with custom domain" class=dd-item><a href=/service-mesh/2020/03/ingress-with-custom-domain/>Ingress with custom domain</a></li><li data-nav-id=/service-mesh/2020/03/ingress-traffic/ title="Ingress Traffic" class=dd-item><a href=/service-mesh/2020/03/ingress-traffic/>Ingress Traffic</a></li><li data-nav-id=/service-mesh/2020/03/deploy-microservices/ title="Deploy Microservices" class=dd-item><a href=/service-mesh/2020/03/deploy-microservices/>Deploy Microservices</a></li><li data-nav-id=/service-mesh/2020/03/installation/ title=Installation class=dd-item><a href=/service-mesh/2020/03/installation/>Installation</a></li></ul></li><li data-nav-id=/general/ title=General class=dd-item><a href=/general/>General</a><ul><li data-nav-id=/general/2020/05/basic-usage-of-git/ title="Basic usage of git" class=dd-item><a href=/general/2020/05/basic-usage-of-git/>Basic usage of git</a></li><li data-nav-id=/general/2020/04/red-hat-satellite-cheat-sheet/ title="Red Hat Satellite Cheat Sheet" class=dd-item><a href=/general/2020/04/red-hat-satellite-cheat-sheet/>Red Hat Satellite Cheat Sheet</a></li></ul></li><li data-nav-id=/ansible/ title=Ansible class="dd-item
parent"><a href=/ansible/>Ansible</a><ul><li data-nav-id=/ansible/2021/11/ansible-style-guide/ title="Ansible Style Guide" class=dd-item><a href=/ansible/2021/11/ansible-style-guide/>Ansible Style Guide</a></li><li data-nav-id=/ansible/2021/10/automation-controller-and-ldap-authentication/ title="Automation Controller and LDAP Authentication" class="dd-item active"><a href=/ansible/2021/10/automation-controller-and-ldap-authentication/>Automation Controller and LDAP Authentication</a></li><li data-nav-id=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" class=dd-item><a href=/ansible/2021/07/ansible-tower-and-downloading-collections/>Ansible Tower and downloading collections</a></li><li data-nav-id=/ansible/2020/04/ansible-azure-resource-manager-example/ title="Ansible - Azure Resource Manager Example" class=dd-item><a href=/ansible/2020/04/ansible-azure-resource-manager-example/>Ansible - Azure Resource Manager Example</a></li><li data-nav-id=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" class=dd-item><a href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/>DO410 Ansible and Ansible Tower training notes</a></li></ul></li><li data-nav-id=/acs/ title="Advanced Cluster Security" class=dd-item><a href=/acs/>Advanced Cluster Security</a><ul><li data-nav-id=/acs/2021-12-11-acsauth/ title="Advanced Cluster Security - Authentication" class=dd-item><a href=/acs/2021-12-11-acsauth/>Advanced Cluster Security - Authentication</a></li></ul></li><li data-nav-id=/azure/ title=Azure class=dd-item><a href=/azure/>Azure</a><ul><li data-nav-id=/azure/2021-10-29-private-aro/ title="Stumbling into Azure Part II: Setting up a private ARO cluster" class=dd-item><a href=/azure/2021-10-29-private-aro/>Stumbling into Azure Part II: Setting up a private ARO cluster</a></li><li data-nav-id=/azure/2021-10-17-s2s-vpn/ title="Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing" class=dd-item><a href=/azure/2021-10-17-s2s-vpn/>Stumbling into Azure Part I: Building a site-to-site VPN tunnel for testing</a></li></ul></li><li data-nav-id=/java/ title=Java class=dd-item><a href=/java/>Java</a><ul><li data-nav-id=/java/2022-02-25-jpa-disconnected-entity/ title="Adventures in Java Land: JPA disconnected entities" class=dd-item><a href=/java/2022-02-25-jpa-disconnected-entity/>Adventures in Java Land: JPA disconnected entities</a></li></ul></li><li data-nav-id=/quay/ title=Quay class=dd-item><a href=/quay/>Quay</a><ul><li data-nav-id=/quay/2021-09-07-quay-upgrade-3.4/ title="Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator" class=dd-item><a href=/quay/2021-09-07-quay-upgrade-3.4/>Stumbling into Quay: Upgrading from 3.3 to 3.4 with the quay-operator</a></li><li data-nav-id=/quay/2020-05-13-quay-tutorial1/ title="Red Hat Quay Registry - Overview and Installation" class=dd-item><a href=/quay/2020-05-13-quay-tutorial1/>Red Hat Quay Registry - Overview and Installation</a></li></ul></li><li data-nav-id=/archive/ title=Archive class=dd-item><a href=/archive/>Archive</a></li><li data-nav-id=/legaldisclosure/ title="Legal Disclosure" class=dd-item><a href=/legaldisclosure/>Legal Disclosure</a></li><li data-nav-id=/rss/ title="RSS Feeds" class=dd-item><a href=/rss/>RSS Feeds</a></li></ul><section id=shortcuts><h3 class=shortcut-title>More</h3><ul><li><a class=padding href=https://blog.stderr.at/tags><i class='fas fa-tags'></i> Tags</a></li><li><a class=padding href=https://blog.stderr.at/categories><i class='far fa-bookmark'></i> Catagories</a></li><li><a class=padding href=https://charts.stderr.at/><i class='fas fa-book'></i> Helm Charts</a></li><li><a class=padding href=https://www.redhat.com><i class='fab fa-redhat'></i> Red Hat</a></li></ul></section><section id=footer></section></div></nav><section id=body><div id=overlay></div><aside id=toc-field class="hidden lg:block tableOfContentContainer"><header id=TableOfContentsHeader>What's on this Page</header><nav id=TableOfContents><ul><li><a href=#_install_freeipa>Install FreeIPA</a></li><li><a href=#_login_to_ipa_server_via_command_line>Login to IPA server via Command Line</a></li><li><a href=#_create_a_binduser_binddn>Create a Binduser (BindDN)</a></li><li><a href=#_enable_ldap_auth_in_automation_controller>Enable LDAP Auth in Automation Controller</a></li><li><a href=#_verify_login_with_user1>Verify Login with user1</a></li><li><a href=#_automatically_assign_permissions>Automatically assign permissions</a></li><li><a href=#_allow_users_from_specific_groups_only>Allow Users From Specific Groups Only</a></li><li><a href=#_additional_configuration>Additional Configuration</a></li></ul></nav><div id=navigation><a class=nav-prev href=/ansible/2021/11/ansible-style-guide/ title="Ansible Style Guide"><i class="fa fa-chevron-left"></i></a>
<a class=nav-next href=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></aside><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/><span itemprop=name>YAUB Yet Another Useless Blog</span><meta itemprop=position content="1"></a></span>> <span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/ansible/><span itemprop=name>Ansible</span><meta itemprop=position content="2"></a></span>> Automation Controller and LDAP Authentication</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#_install_freeipa>Install FreeIPA</a></li><li><a href=#_login_to_ipa_server_via_command_line>Login to IPA server via Command Line</a></li><li><a href=#_create_a_binduser_binddn>Create a Binduser (BindDN)</a></li><li><a href=#_enable_ldap_auth_in_automation_controller>Enable LDAP Auth in Automation Controller</a></li><li><a href=#_verify_login_with_user1>Verify Login with user1</a></li><li><a href=#_automatically_assign_permissions>Automatically assign permissions</a></li><li><a href=#_allow_users_from_specific_groups_only>Allow Users From Specific Groups Only</a></li><li><a href=#_additional_configuration>Additional Configuration</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/ansible>Ansible</a>
<a class=tag-link href=/tags/controller>Controller</a>
<a class=tag-link href=/tags/automation-controller>Automation Controller</a>
<a class=tag-link href=/tags/ldap>LDAP</a>
<a class=tag-link href=/tags/authentication>Authentication</a></div></div><div id=body-inner><h1>Automation Controller and LDAP Authentication</h1><p class=tracked><time class="f6 mv4 dib tracked" datetime=2021-10-25T00:00:00Z><strong>October 25, 2021</strong></time>
- By:
Thomas Jungbauer
( Lastmod: 2022-03-22 )</p><div class=paragraph><p>The following article shall quickly, without huge background information, deploy an Identity Management Server (based on FreeIPA) and connect this IDM to an existing Automation Controller so authentication can be tested and verified based on LDAP.</p></div><div class=sect1><h2 id=_install_freeipa>Install FreeIPA</h2><div class=sectionbody><div class=paragraph><p>Run the following command to deploy and configure the IPA Server:</p></div><div class="olist arabic"><ol class=arabic><li><p><code>yum module enable idm:DL1</code></p></li><li><p><code>yum distro-sync</code></p></li><li><p><code>yum -y module install idm:DL1/server</code></p></li><li><p>Install the server by calling the command <code>ipa-server-install</code>. This will start an interactive installation modus which requires the basic information about the IPA server. The following uses <strong>tower.local</strong> as base domain</p></li></ol></div><div class=listingblock><div class=content><pre>Do you want to configure integrated DNS (BIND)? [no]:
Server host name [node01.tower.local]:
Please confirm the domain name [tower.local]:
Please provide a realm name [TOWER.LOCAL]:

Directory Manager password: &lt;enter password&gt;
Password (confirm): &lt;enter password&gt;

IPA admin password: &lt;enter password&gt;
Password (confirm): &lt;enter password&gt;

Do you want to configure chrony with NTP server or pool address? [no]:

Continue to configure the system with these values? [no]: yes</pre></div></div><div class=paragraph><p>Once all information have been provided the installation/configuration process starts. This will take a while…​</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content>Be sure that the hostname, here <strong>node01.tower.local</strong>, is resolvable, at least from the Tower/Controller node and the node you are accessing the FreeIPA UI. You can use your local <em>hosts</em> file or a real domain name for that.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_login_to_ipa_server_via_command_line>Login to IPA server via Command Line</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>For user admin use: <code>kinit admin</code></p></li></ol></div></div></div><div class=sect1><h2 id=_create_a_binduser_binddn>Create a Binduser (BindDN)</h2><div class=sectionbody><div class=paragraph><p>The Binduser (or BindDN) will be used by the Controller to authenticate the Controller against the LDAP server.</p></div><div class="olist arabic"><ol class=arabic><li><p>Create the actual user</p><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>ipa user-add --first=”BindUser” --last=”None” --password binduser</code></pre></div></div><div class=paragraph><p>Output:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>Password:
Enter Password again to verify:
------------------
Added user &#34;binduser&#34;
------------------
  User login: binduser
  First name: ”BindUser”
  Last name: ”None”
  Full name: ”BindUser” ”None”
  Display name: ”BindUser” ”None”
  Initials: ””
  Home directory: /home/binduser
  GECOS: ”BindUser” ”None”
  Login shell: /bin/sh
  Principal name: binduser@TOWER.LOCAL
  Principal alias: binduser@TOWER.LOCAL
  User password expiration: 20211015133112Z
  Email address: binduser@tower.local
  UID: 1573400003
  GID: 1573400003
  Password: True
  Member of groups: ipausers
  Kerberos keys available: True</code></pre></div></div></li><li><p>Assign the new user to the admin group</p><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>ipa group-add-member admins --users=binduser</code></pre></div></div><div class=paragraph><p>Output:</p></div></li></ol></div><div class=listingblock><div class=content><pre>  Group Name: admins
  Description: Account administrators group
  GID: 1573400000
  Member users: admin, binduser
-----------------------------------
Number of members added 1
-----------------------------------</pre></div></div><div class="olist arabic"><ol class=arabic><li><p>Create a 2nd User to test the authentication later</p></li></ol></div><div class=listingblock><div class=content><pre>ipa user-add --first=”User” --last=”Name” --password user1</pre></div></div></div></div><div class=sect1><h2 id=_enable_ldap_auth_in_automation_controller>Enable LDAP Auth in Automation Controller</h2><div class=sectionbody><div class="olist arabic"><ol class=arabic><li><p>Login to Automation Controller ad go to "Settings > LDAP Settings > Default"</p></li><li><p>add a new connection:</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p><strong>LDAP Service URI</strong>: <code>ldap://node01.tower.local:389</code></p></li><li><p><strong>LDAP Bind Password</strong>: <code>&lt;password of user binduser>`</code></p></li><li><p><strong>LDAP Group Type</strong>: <code>MemberDNGroupType</code></p></li><li><p><strong>LDAP Bind DN</strong>: <code>uid=binduser,cn=users,cn=accounts,dc=tower,dc=local</code></p></li><li><p><strong>LDAP User Search</strong>:</p><div class=listingblock><div class=content><pre class=highlight><code class=language-json data-lang=json>[
    &#34;cn=users,cn=accounts,dc=tower,dc=local&#34;,
    &#34;SCOPE_SUBTREE&#34;,
    &#34;(uid=%(user)s)&#34;
]</code></pre></div></div></li><li><p><strong>LDAP Group Search</strong>:</p><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>[
    &#34;cn=groups,cn=accounts,dc=tower,dc=local&#34;,
    &#34;SCOPE_SUBTREE&#34;,
    &#34;(objectClass=posixgroup)&#34;
]</code></pre></div></div></li></ol></div></li></ol></div><div class=paragraph><p>The configuration should look like the following image:</p></div><div class=imageblock><div class=content><img src=/ansible/images/ControllerLDAPAuth.png alt="Automation Controller LDAP Authentication"></div><div class=title>Figure 1. Automation Controller LDAP Authentication</div></div></div></div><div class=sect1><h2 id=_verify_login_with_user1>Verify Login with user1</h2><div class=sectionbody><div class=paragraph><p>You can now test the login using <strong>user1</strong>. If it does not work, check the following files for errors:</p></div><div class=paragraph><p><strong>Tower Node</strong>: /var/log/tower/tower.log</p></div><div class=paragraph><p><strong>IPA Node</strong>: /var/log/dirsrv/slapd-TOWER-LOCAL/access</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content>The login should work, but since the user1 is not assigned to any Team/Organization inside the Automation Controller, no privileges are granted. The user can do nothing.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_automatically_assign_permissions>Automatically assign permissions</h2><div class=sectionbody><div class=paragraph><p>2 roles can be automatically assigned to authenticated users:</p></div><div class="olist arabic"><ol class=arabic><li><p>Super User</p></li><li><p>Auditor</p></li></ol></div><div class=paragraph><p>To test this, 2 groups will be created in the LDAP server and a new user will be assigned to one of the groups.</p></div><div class="olist arabic"><ol class=arabic><li><p>Create the group for super users: <code>ipa group-add tower_administrators</code></p></li><li><p>Create the group for auditors: <code>ipa group-add tower_auditors</code></p></li><li><p>Create a new user: <code>ipa user-add --first=”User” --last=”Name” --password user2</code></p></li><li><p>Assign the user to one the the groups: <code>ipa group-add-member tower_administrators --users=user2</code></p></li><li><p>Modify the Controller LDAP configuration and set <strong>LDAP User Flags by Group</strong>. This will assing any member of <em>tower_administrators</em> to <em>is_superuser</em> for example.</p><div class=listingblock><div class=content><pre class=highlight><code class=language-json data-lang=json>{
  &#34;is_superuser&#34;: [
    &#34;cn=tower_administrators,cn=groups,cn=accounts,dc=tower,dc=local&#34;
  ],
  &#34;is_system_auditor&#34;: [
    &#34;cn=tower_auditors,cn=groups,cn=accounts,dc=tower,dc=local&#34;
  ]
}</code></pre></div></div></li></ol></div><div class=paragraph><p>Test the authentication and authorization with the <strong>user2</strong>. This user should now gain super admin permissions.</p></div></div></div><div class=sect1><h2 id=_allow_users_from_specific_groups_only>Allow Users From Specific Groups Only</h2><div class=sectionbody><div class=paragraph><p>Not all LDAP users shall be able to authenticate. Only users, which are member of a specific group, shall be able to authenticate.</p></div><div class="olist arabic"><ol class=arabic><li><p>Create a 3rd user: <code>ipa user-add --first=”User” --last=”Name” --password user3</code></p></li><li><p>Modify the LDAP Configuration in Automation Controller and set <strong>LDAP Require Groups</strong>:</p><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>&#34;cn=towerusers,cn=groups,cn=accounts,dc=tower,dc=local&#34;</code></pre></div></div></li><li><p>Add the group <em>toweruser</em>: <code>ipa group-add towerusers</code></p></li><li><p>Assign the user <strong>user3</strong> to that group: <code>ipa group-add-member towerusers --users=user3</code></p></li></ol></div><div class=paragraph><p>At this state only <strong>user3</strong> will be able to login. In order to allow the other users as well, all must be assigned to the group <strong>towerusers</strong></p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-bash data-lang=bash>ipa group-add-member towerusers --users=user3
ipa group-add-member towerusers --users=user1</code></pre></div></div></div></div><div class=sect1><h2 id=_additional_configuration>Additional Configuration</h2><div class=sectionbody><div class=paragraph><p>It is possible to automatically map users to Controller Organization. I did not fully test this, but the following is an example:</p></div><div class="listingblock json"><div class=content><pre class=highlight><code>  {
      &#34;LDAP Organization&#34;: {
          &#34;admins&#34;: &#34;cn=engineering_admins,ou=groups,dc=example,dc=com&#34;,
          &#34;remove_admins&#34;: false,
          &#34;users&#34;: [
              &#34;cn=engineering,ou=groups,dc=example,dc=com&#34;,
              &#34;cn=sales,ou=groups,dc=example,dc=com&#34;,
              &#34;cn=it,ou=groups,dc=example,dc=com&#34;
          ],
          &#34;remove_users&#34;: false
      },
      &#34;LDAP Organization 2&#34;: {
          &#34;admins&#34;: [
              &#34;cn=Administrators,cn=Builtin,dc=example,dc=com&#34;
          ],
          &#34;remove_admins&#34;: false,
          &#34;users&#34;: true,
          &#34;remove_users&#34;: false
      }
  }</code></pre></div></div></div></div><footer class=footline></footer></div></div><div id=navigation-bottom><a class="nav-prev btn btn-default" href=/ansible/2021/11/ansible-style-guide/ title="Ansible Style Guide"><i class="fa fa-chevron-left btn-bottom-prev"></i><span class=btn-bottom-text>Previous:</span> Ansible Style Guide</a>
<a class="nav-next btn btn-default" href=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" style=margin-right:0><i class="fa fa-chevron-right btn-bottom-next"></i><span class=btn-bottom-text>Next:</span> Ansible Tower and downloading collections</a></div><div class=copyright><p>Copyright &copy; 2020 - 2023 Toni Schmidbauer & Thomas Jungbauer</p><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn target=_blank rel="noopener noreferrer">Hugo Learn Theme</i></a> and <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a></p></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1679661802></script>
<script src=/js/perfect-scrollbar.min.js?1679661802></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1679661802></script>
<script src=/js/jquery.sticky.js?1679661802></script>
<script src=/js/featherlight.min.js?1679661802></script>
<script src=/js/highlight.pack.js?1679661802></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1679661802></script>
<script src=/js/learn.js?1679661802></script>
<script src=/js/hugo-learn.js?1679661802></script>
<script src=/js/yaub.js?1679661802></script>
<script>window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id");e.intersectionRatio>0&&(clearActiveStatesInTableOfContents(),document.querySelector(`aside nav li a[href="#${t}"]`).parentElement.classList.add("active"))})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function clearActiveStatesInTableOfContents(){document.querySelectorAll("aside nav li").forEach(e=>{e.classList.remove("active")})}</script><script type=text/javascript>function scrollTopAnimated(){$("html, body").animate({scrollTop:"0"},500)}</script><script>function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}$(".summary-box").click(function(){return window.location=$(this).find("a").attr("href"),!1})</script><script>const btn=document.querySelector(".btn-toggle"),prefersDarkScheme=window.matchMedia("(prefers-color-scheme: dark)"),currentTheme=localStorage.getItem("theme");currentTheme=="dark"?document.body.classList.toggle("dark-theme"):currentTheme=="light"&&document.body.classList.toggle("light-theme"),btn.addEventListener("click",function(){if(prefersDarkScheme.matches){document.body.classList.toggle("light-theme");var e=document.body.classList.contains("light-theme")?"light":"dark"}else document.body.classList.toggle("dark-theme"),e=document.body.classList.contains("dark-theme")?"dark":"light";localStorage.setItem("theme",e)})</script></body></html>