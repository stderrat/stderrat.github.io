<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta name=google-site-verification content="yq2Ib3doJVHVlEW2wtHap5WY54JhS2CCvI40y30F0FI">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.87.0">
<meta name=description content="Using Ansible Azure Resource Manager to create a Virtual Machine">
<meta name=author content="Toni Schmidbauer & Thomas Jungbauer">
<link rel=icon href=/images/favicon.ico type=image/png>
<link rel=apple-touch-icon sizes=152x152 href=/images/apple-touch-icon-152x152.png>
<link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-180x180.png>
<link rel=apple-touch-icon sizes=128x128 href=/images/apple-touch-icon-128x128.png>
<link rel=apple-touch-icon sizes=144x144 href=/images/apple-touch-icon-144x144.png>
<link rel=apple-touch-icon sizes=114x114 href=/images/apple-touch-icon-114x114.png>
<link rel=apple-touch-icon sizes=72x72 href=/images/apple-touch-icon-72x72.png>
<link rel=apple-touch-icon href=/images/apple-touch-icon-57x57.png>
<link rel="shortcut icon" href=/images/favicon.ico>
<link rel=apple-touch-icon sizes=57x57 href=/images/apple-icon-57x57.png>
<link rel=apple-touch-icon sizes=60x60 href=/images/apple-icon-60x60.png>
<link rel=apple-touch-icon sizes=76x76 href=/images/apple-icon-76x76.png>
<link rel=apple-touch-icon sizes=120x120 href=/images/apple-icon-120x120.png>
<link rel=icon type=image/png sizes=192x192 href=/images/android-icon-192x192.png>
<link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=96x96 href=/images/favicon-96x96.png>
<link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png>
<title>Ansible - Azure Resource Manager Example :: TechBlog about OpenShift/Ansible/Satellite and much more</title>
<link rel=manifest href=/manifest.json>
<meta name=theme-color content="#317EFB">
<link href=/css/nucleus.min.css?1630387136 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1630387136 rel=stylesheet>
<link href=/css/font-awesome-animation.min.css?1630387136 rel=stylesheet>
<link href=/css/hybrid.css?1630387136 rel=stylesheet>
<link href=/css/featherlight.min.css?1630387136 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1630387136 rel=stylesheet>
<link href=/css/auto-complete.css?1630387136 rel=stylesheet>
<link href=/css/atom-one-dark-reasonable.css?1630387136 rel=stylesheet>
<link href=/css/theme.min.css?1630387136 rel=stylesheet>
<link href=/css/hugo-theme.css?1630387136 rel=stylesheet>
<link href=/css/theme-yaub.css?1630387136 rel=stylesheet>
<script src=/js/jquery-3.6.0.min.js?1630387136></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
</head>
<body data-url=/ansible/2020/04/ansible-azure-resource-manager-example/>
<button onclick=scrollTopAnimated() id=myBtn class="top-btn button fa fa-arrow-up" title="Go to top"></button>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a id=logo href=/>
<p class="fa fa-cloud-upload-alt faa-float animated"></p>
<span class=text>YAUB</span>
<p class=logoarea><span class="text small">Yet another Useless Blog</span></p>
</a>
</div>
<div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div>
<script type=text/javascript src=/js/lunr.min.js?1630387136></script>
<script type=text/javascript src=/js/auto-complete.js?1630387136></script>
<script type=text/javascript>var baseurl="https://blog.stderr.at/"</script>
<script type=text/javascript src=/js/search.js?1630387136></script>
</div>
<section id=homelinks>
<ul>
<li>
<a class=padding href=/><i class="fas fa-home"></i> Home</a>
</li>
</ul>
</section>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=/openshift/ title=OpenShift class=dd-item>
<a href=/openshift/>
OpenShift
</a>
<ul>
<li data-nav-id=/openshift/2021-02-27-understanding-block-devices/ title="Understanding RWO block device handling in OpenShift" class=dd-item>
<a href=/openshift/2021-02-27-understanding-block-devices/>
Understanding RWO block device handling in OpenShift
</a>
</li>
<li data-nav-id=/openshift/2021-01-27-writingoperatoransible/ title="Writing Operator using Ansible" class=dd-item>
<a href=/openshift/2021-01-27-writingoperatoransible/>
Writing Operator using Ansible
</a>
</li>
<li data-nav-id=/openshift/2020-12-10-thanos-vs-thanos/ title="Thanos Querier vs Thanos Querier" class=dd-item>
<a href=/openshift/2020-12-10-thanos-vs-thanos/>
Thanos Querier vs Thanos Querier
</a>
</li>
<li data-nav-id=/openshift/2020-08-06-argocd/ title="GitOps - Argo CD" class=dd-item>
<a href=/openshift/2020-08-06-argocd/>
GitOps - Argo CD
</a>
</li>
<li data-nav-id=/openshift/2020-05-13-quay-tutorial1/ title="Red Hat Quay Registry - Overview and Installation" class=dd-item>
<a href=/openshift/2020-05-13-quay-tutorial1/>
Red Hat Quay Registry - Overview and Installation
</a>
</li>
<li data-nav-id=/openshift/2020-04-16-tekton/ title="OpenShift Pipelines - Tekton Introduction" class=dd-item>
<a href=/openshift/2020-04-16-tekton/>
OpenShift Pipelines - Tekton Introduction
</a>
</li>
<li data-nav-id=/openshift/2020-04-01-oc-commands/ title="Helpful oc / kubectl commands" class=dd-item>
<a href=/openshift/2020-04-01-oc-commands/>
Helpful oc / kubectl commands
</a>
</li>
</ul>
</li>
<li data-nav-id=/compliance/ title=Compliance class=dd-item>
<a href=/compliance/>
Compliance
</a>
<ul>
<li data-nav-id=/compliance/2021/07/oc-compliance-command-line-plugin/ title="oc compliance command line plugin" class=dd-item>
<a href=/compliance/2021/07/oc-compliance-command-line-plugin/>
oc compliance command line plugin
</a>
</li>
<li data-nav-id=/compliance/2021/07/compliance-operator/ title="Compliance Operator" class=dd-item>
<a href=/compliance/2021/07/compliance-operator/>
Compliance Operator
</a>
</li>
</ul>
</li>
<li data-nav-id=/service-mesh/ title="Service Mesh" class=dd-item>
<a href=/service-mesh/>
Service Mesh
</a>
<ul>
<li data-nav-id=/service-mesh/2020/05/enable-automatic-route-creation/ title="Enable Automatic Route Creation" class=dd-item>
<a href=/service-mesh/2020/05/enable-automatic-route-creation/>
Enable Automatic Route Creation
</a>
</li>
<li data-nav-id=/service-mesh/2020/05/authorization-rbac/ title="Authorization (RBAC)" class=dd-item>
<a href=/service-mesh/2020/05/authorization-rbac/>
Authorization (RBAC)
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/deploy-example-bookinfo-application/ title="Deploy Example Bookinfo Application" class=dd-item>
<a href=/service-mesh/2020/04/deploy-example-bookinfo-application/>
Deploy Example Bookinfo Application
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/service-mesh-1.1-released/ title="Service Mesh 1.1 released" class=dd-item>
<a href=/service-mesh/2020/04/service-mesh-1.1-released/>
Service Mesh 1.1 released
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/authentication-jwt/ title="Authentication JWT" class=dd-item>
<a href=/service-mesh/2020/04/authentication-jwt/>
Authentication JWT
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/mutual-tls-authentication/ title="Mutual TLS Authentication" class=dd-item>
<a href=/service-mesh/2020/04/mutual-tls-authentication/>
Mutual TLS Authentication
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/fault-injection/ title="Fault Injection" class=dd-item>
<a href=/service-mesh/2020/04/fault-injection/>
Fault Injection
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/limit-egress/external-traffic/ title="Limit Egress/External Traffic" class=dd-item>
<a href=/service-mesh/2020/04/limit-egress/external-traffic/>
Limit Egress/External Traffic
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/advanced-routing-example/ title="Advanced Routing Example" class=dd-item>
<a href=/service-mesh/2020/04/advanced-routing-example/>
Advanced Routing Example
</a>
</li>
<li data-nav-id=/service-mesh/2020/04/routing-example/ title="Routing Example" class=dd-item>
<a href=/service-mesh/2020/04/routing-example/>
Routing Example
</a>
</li>
<li data-nav-id=/service-mesh/2020/03/ingress-with-custom-domain/ title="Ingress with custom domain" class=dd-item>
<a href=/service-mesh/2020/03/ingress-with-custom-domain/>
Ingress with custom domain
</a>
</li>
<li data-nav-id=/service-mesh/2020/03/ingress-traffic/ title="Ingress Traffic" class=dd-item>
<a href=/service-mesh/2020/03/ingress-traffic/>
Ingress Traffic
</a>
</li>
<li data-nav-id=/service-mesh/2020/03/deploy-microservices/ title="Deploy Microservices" class=dd-item>
<a href=/service-mesh/2020/03/deploy-microservices/>
Deploy Microservices
</a>
</li>
<li data-nav-id=/service-mesh/2020/03/installation/ title=Installation class=dd-item>
<a href=/service-mesh/2020/03/installation/>
Installation
</a>
</li>
</ul>
</li>
<li data-nav-id=/general/ title=General class=dd-item>
<a href=/general/>
General
</a>
<ul>
<li data-nav-id=/general/2020/05/basic-usage-of-git/ title="Basic usage of git" class=dd-item>
<a href=/general/2020/05/basic-usage-of-git/>
Basic usage of git
</a>
</li>
<li data-nav-id=/general/2020/04/red-hat-satellite-cheat-sheet/ title="Red Hat Satellite Cheat Sheet" class=dd-item>
<a href=/general/2020/04/red-hat-satellite-cheat-sheet/>
Red Hat Satellite Cheat Sheet
</a>
</li>
</ul>
</li>
<li data-nav-id=/ansible/ title=Ansible class="dd-item
parent">
<a href=/ansible/>
Ansible
</a>
<ul>
<li data-nav-id=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections" class=dd-item>
<a href=/ansible/2021/07/ansible-tower-and-downloading-collections/>
Ansible Tower and downloading collections
</a>
</li>
<li data-nav-id=/ansible/2020/04/ansible-azure-resource-manager-example/ title="Ansible - Azure Resource Manager Example" class="dd-item active">
<a href=/ansible/2020/04/ansible-azure-resource-manager-example/>
Ansible - Azure Resource Manager Example
</a>
</li>
<li data-nav-id=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" class=dd-item>
<a href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/>
DO410 Ansible and Ansible Tower training notes
</a>
</li>
</ul>
</li>
<li data-nav-id=/archive/ title=Archive class=dd-item>
<a href=/archive/>
Archive
</a>
</li>
<li data-nav-id=/legaldisclosure/ title="Legal Disclosure" class=dd-item>
<a href=/legaldisclosure/>
Legal Disclosure
</a>
</li>
<li data-nav-id=/rss/ title="RSS Feeds" class=dd-item>
<a href=/rss/>
RSS Feeds
</a>
</li>
</ul>
<section id=shortcuts>
<h3 class=shortcut-title>More</h3>
<ul>
<li>
<a class=padding href=https://blog.stderr.at/tags><i class="fas fa-tags"></i> Tags</a>
</li>
<li>
<a class=padding href=https://blog.stderr.at/categories><i class="far fa-bookmark"></i> Catagories</a>
</li>
<li>
<a class=padding href=https://www.redhat.com><i class="fab fa-redhat"></i> Red Hat</a>
</li>
</ul>
</section>
<section id=footer>
</section>
</div>
</nav>
<section id=body>
<div id=overlay></div>
<aside id=toc-field class="hidden lg:block tableOfContentContainer">
<header id=TableOfContentsHeader>What's on this Page</header>
<nav id=TableOfContents>
<ul>
<li><a href=#_introduction>Introduction</a></li>
<li><a href=#_additional_resources>Additional Resources</a>
<ul>
<li><a href=#_ansible_playbook_create_azure_deplyoment_yml>Ansible Playbook: Create-Azure-Deplyoment.yml</a></li>
<li><a href=#_resourcemanagertemplate_json>ResourceManagerTemplate.json</a></li>
</ul>
</li>
<li><a href=#_sources>Sources</a></li>
</ul>
</nav>
<div id=navigation>
<a class=nav-prev href=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections"> <i class="fa fa-chevron-left"></i></a>
<a class=nav-next href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" style=margin-right:0><i class="fa fa-chevron-right"></i></a>
</div>
</aside>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=breadcrumbs itemscope itemtype=http://schema.org/BreadcrumbList>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
<span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/> <span itemprop=name>YAUB Yet Another Useless Blog</span><meta itemprop=position content="1"></a></span> > <span itemscope itemprop=itemListElement itemtype=http://schema.org/ListItem><a itemprop=item href=/ansible/> <span itemprop=name>Ansible</span><meta itemprop=position content="2"></a></span> > Ansible - Azure Resource Manager Example
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#_introduction>Introduction</a></li>
<li><a href=#_additional_resources>Additional Resources</a>
<ul>
<li><a href=#_ansible_playbook_create_azure_deplyoment_yml>Ansible Playbook: Create-Azure-Deplyoment.yml</a></li>
<li><a href=#_resourcemanagertemplate_json>ResourceManagerTemplate.json</a></li>
</ul>
</li>
<li><a href=#_sources>Sources</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
<div class=tags>
<a class=tag-link href=/tags/ansible>Ansible</a>
<a class=tag-link href=/tags/azure>Azure</a>
</div>
</div>
<div id=body-inner>
<h1>
Ansible - Azure Resource Manager Example
</h1>
<p class=tracked>
<time class="f6 mv4 dib tracked" datetime=2020-04-27T00:00:00Z>
<strong>April 27, 2020</strong>
</time>
By:
Thomas Jungbauer
</p>
<div class=paragraph>
<p>Using Ansible Resource Manager with an ARM template and a simple Ansible playbook to deploy a Virtual Machine with Disk, virtual network, public IP and so on.</p>
</div>
<div class=sect1>
<h2 id=_introduction>Introduction</h2>
<div class=sectionbody>
<div class=paragraph>
<p><em>Source: [<a href=#source_1>1</a>]</em></p>
</div>
<div class=paragraph>
<p>In order to deploy a Virtual Machine and all depended resources using the Azure Resource Manager (ARM) template with Ansible, you will need three things:</p>
</div>
<div class=ulist>
<ul>
<li>
<p>The ARM Template</p>
</li>
<li>
<p>The parameters you want to use</p>
</li>
<li>
<p>The Ansible playbook</p>
</li>
</ul>
</div>
<div class=paragraph>
<p>All can be found below.
Store them and simply call:</p>
</div>
<div class=listingblock>
<div class=content>
<pre class=highlight><code class=language-bash data-lang=bash>ansible-playbook Azure/create_azure_deployment.yml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class=icon>
<i class="fa icon-note" title=Note></i>
</td>
<td class=content>
it will take several minutes, until everything has been deployment in Azure.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class=icon>
<i class="fa icon-note" title=Note></i>
</td>
<td class=content>
Instead of using a json file locally you can upload the template file (as well as a parameters file) to a version control system and use it from there.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_additional_resources>Additional Resources</h2>
<div class=sectionbody>
<div class=sect2>
<h3 id=_ansible_playbook_create_azure_deplyoment_yml>Ansible Playbook: Create-Azure-Deplyoment.yml</h3>
<div class=listingblock>
<div class=content>
<pre class=highlight><code class=language-yaml data-lang=yaml>---
- name: Get facts of a VM
  hosts: localhost
  connection: local
  become: false
  gather_facts: false

  tasks:

  #- name: Destroy Azure Deploy
  #  azure_rm_deployment:
  #    resource_group: tju-ResourceGroup
  #    name: tju-testDeployment
  #    state: absent

  - name: Create Azure Resource Group deployment
    azure_rm_deployment:
      state: present
      resource_group_name: tju-ResourceGroup
      name: tju-testDeployment
      #template_link: &#39;&lt;YOUR RAW Github template file&gt;&#39;
      #parameters_link: &#39;&lt;YOUR RAW Github parameters file&gt;&#39;
      template: &#34;{{ lookup(&#39;file&#39;, &#39;ResourceManagerTemplate.json&#39;) }}&#34;
      parameters:
        projectName:
          value: tjuProject
        location:
          value: &#34;East US&#34;
        adminUsername:
          value: tjungbauer
        adminPublicKey:
          value: &#34;{{ lookup(&#39;file&#39;, &#39;/Users/tjungbauer/.ssh/id_rsa.pub&#39;) }}&#34;
        operatingSystem:
          value: CentOS
        operatingSystemPublisher:
          value: OpenLogic
        operatingSystemSKU:
          value: &#39;7.1&#39;
        vmSize:
          value: Standard_D2s_v3
    register: azure

  - name: Add new instance to host group
    add_host:
      hostname: &#34;{{ item[&#39;ips&#39;][0].public_ip }}&#34;
      groupname: azure_vms
    loop: &#34;{{ azure.deployment.instances }}&#34;</code></pre>
</div>
</div>
</div>
<div class=sect2>
<h3 id=_resourcemanagertemplate_json>ResourceManagerTemplate.json</h3>
<div class=listingblock>
<div class=content>
<pre class=highlight><code class=language-json data-lang=json>{
  &#34;$schema&#34;: &#34;https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#&#34;,
  &#34;contentVersion&#34;: &#34;1.0.0.0&#34;,
  &#34;parameters&#34;: {
    &#34;projectName&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies a name for generating resource names.&#34;
      }
    },
    &#34;location&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;defaultValue&#34;: &#34;[resourceGroup().location]&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the location for all resources.&#34;
      }
    },
    &#34;adminUsername&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies a username for the Virtual Machine.&#34;
      }
    },
    &#34;adminPublicKey&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the SSH rsa public key file as a string. Use \&#34;ssh-keygen -t rsa -b 2048\&#34; to generate your SSH key pairs.&#34;
      }
    },
    &#34;operatingSystem&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the Operating System. i.e. CentOS&#34;
      }
    },
    &#34;operatingSystemPublisher&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the publisher. i.e. OpenLogic&#34;
      }
    },
    &#34;operatingSystemSKU&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the version of the OS. i.e. 7.1&#34;
      }
    },
    &#34;vmSize&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;metadata&#34;: {
        &#34;description&#34;: &#34;Specifies the the VM size. i.e. Standard_D2s_v3&#34;
      }
    }
  },
  &#34;variables&#34;: {
    &#34;vNetName&#34;: &#34;[concat(parameters(&#39;projectName&#39;), &#39;-vnet&#39;)]&#34;,
    &#34;vNetAddressPrefixes&#34;: &#34;10.0.0.0/16&#34;,
    &#34;vNetSubnetName&#34;: &#34;default&#34;,
    &#34;vNetSubnetAddressPrefix&#34;: &#34;10.0.0.0/24&#34;,
    &#34;vmName&#34;: &#34;[concat(parameters(&#39;projectName&#39;), &#39;-vm&#39;)]&#34;,
    &#34;publicIPAddressName&#34;: &#34;[concat(parameters(&#39;projectName&#39;), &#39;-ip&#39;)]&#34;,
    &#34;networkInterfaceName&#34;: &#34;[concat(parameters(&#39;projectName&#39;), &#39;-nic&#39;)]&#34;,
    &#34;networkSecurityGroupName&#34;: &#34;[concat(parameters(&#39;projectName&#39;), &#39;-nsg&#39;)]&#34;,
    &#34;networkSecurityGroupName2&#34;: &#34;[concat(variables(&#39;vNetSubnetName&#39;), &#39;-nsg&#39;)]&#34;
  },
  &#34;resources&#34;: [
    {
      &#34;type&#34;: &#34;Microsoft.Network/networkSecurityGroups&#34;,
      &#34;apiVersion&#34;: &#34;2018-11-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;networkSecurityGroupName&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;properties&#34;: {
        &#34;securityRules&#34;: [
          {
            &#34;name&#34;: &#34;ssh_rule&#34;,
            &#34;properties&#34;: {
              &#34;description&#34;: &#34;Locks inbound down to ssh default port 22.&#34;,
              &#34;protocol&#34;: &#34;Tcp&#34;,
              &#34;sourcePortRange&#34;: &#34;*&#34;,
              &#34;destinationPortRange&#34;: &#34;22&#34;,
              &#34;sourceAddressPrefix&#34;: &#34;*&#34;,
              &#34;destinationAddressPrefix&#34;: &#34;*&#34;,
              &#34;access&#34;: &#34;Allow&#34;,
              &#34;priority&#34;: 123,
              &#34;direction&#34;: &#34;Inbound&#34;
            }
          }
        ]
      }
    },
    {
      &#34;type&#34;: &#34;Microsoft.Network/publicIPAddresses&#34;,
      &#34;apiVersion&#34;: &#34;2018-11-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;publicIPAddressName&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;properties&#34;: {
        &#34;publicIPAllocationMethod&#34;: &#34;Dynamic&#34;
      },
      &#34;sku&#34;: {
        &#34;name&#34;: &#34;Basic&#34;
      }
    },
    {
      &#34;comments&#34;: &#34;Simple Network Security Group for subnet [variables(&#39;vNetSubnetName&#39;)]&#34;,
      &#34;type&#34;: &#34;Microsoft.Network/networkSecurityGroups&#34;,
      &#34;apiVersion&#34;: &#34;2019-08-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;networkSecurityGroupName2&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;properties&#34;: {
        &#34;securityRules&#34;: [
          {
            &#34;name&#34;: &#34;default-allow-22&#34;,
            &#34;properties&#34;: {
              &#34;priority&#34;: 1000,
              &#34;access&#34;: &#34;Allow&#34;,
              &#34;direction&#34;: &#34;Inbound&#34;,
              &#34;destinationPortRange&#34;: &#34;22&#34;,
              &#34;protocol&#34;: &#34;Tcp&#34;,
              &#34;sourceAddressPrefix&#34;: &#34;*&#34;,
              &#34;sourcePortRange&#34;: &#34;*&#34;,
              &#34;destinationAddressPrefix&#34;: &#34;*&#34;
            }
          }
        ]
      }
    },
    {
      &#34;type&#34;: &#34;Microsoft.Network/virtualNetworks&#34;,
      &#34;apiVersion&#34;: &#34;2018-11-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;vNetName&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;dependsOn&#34;: [
        &#34;[resourceId(&#39;Microsoft.Network/networkSecurityGroups&#39;, variables(&#39;networkSecurityGroupName2&#39;))]&#34;
      ],
      &#34;properties&#34;: {
        &#34;addressSpace&#34;: {
          &#34;addressPrefixes&#34;: [
            &#34;[variables(&#39;vNetAddressPrefixes&#39;)]&#34;
          ]
        },
        &#34;subnets&#34;: [
          {
            &#34;name&#34;: &#34;[variables(&#39;vNetSubnetName&#39;)]&#34;,
            &#34;properties&#34;: {
              &#34;addressPrefix&#34;: &#34;[variables(&#39;vNetSubnetAddressPrefix&#39;)]&#34;,
              &#34;networkSecurityGroup&#34;: {
                &#34;id&#34;: &#34;[resourceId(&#39;Microsoft.Network/networkSecurityGroups&#39;, variables(&#39;networkSecurityGroupName2&#39;))]&#34;
              }
            }
          }
        ]
      }
    },
    {
      &#34;type&#34;: &#34;Microsoft.Network/networkInterfaces&#34;,
      &#34;apiVersion&#34;: &#34;2018-11-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;networkInterfaceName&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;dependsOn&#34;: [
        &#34;[resourceId(&#39;Microsoft.Network/publicIPAddresses&#39;, variables(&#39;publicIPAddressName&#39;))]&#34;,
        &#34;[resourceId(&#39;Microsoft.Network/virtualNetworks&#39;, variables(&#39;vNetName&#39;))]&#34;,
        &#34;[resourceId(&#39;Microsoft.Network/networkSecurityGroups&#39;, variables(&#39;networkSecurityGroupName&#39;))]&#34;
      ],
      &#34;properties&#34;: {
        &#34;ipConfigurations&#34;: [
          {
            &#34;name&#34;: &#34;ipconfig1&#34;,
            &#34;properties&#34;: {
              &#34;privateIPAllocationMethod&#34;: &#34;Dynamic&#34;,
              &#34;publicIPAddress&#34;: {
                &#34;id&#34;: &#34;[resourceId(&#39;Microsoft.Network/publicIPAddresses&#39;, variables(&#39;publicIPAddressName&#39;))]&#34;
              },
              &#34;subnet&#34;: {
                &#34;id&#34;: &#34;[resourceId(&#39;Microsoft.Network/virtualNetworks/subnets&#39;, variables(&#39;vNetName&#39;), variables(&#39;vNetSubnetName&#39;))]&#34;
              }
            }
          }
        ]
      }
    },
    {
      &#34;type&#34;: &#34;Microsoft.Compute/virtualMachines&#34;,
      &#34;apiVersion&#34;: &#34;2018-10-01&#34;,
      &#34;name&#34;: &#34;[variables(&#39;vmName&#39;)]&#34;,
      &#34;location&#34;: &#34;[parameters(&#39;location&#39;)]&#34;,
      &#34;dependsOn&#34;: [
        &#34;[resourceId(&#39;Microsoft.Network/networkInterfaces&#39;, variables(&#39;networkInterfaceName&#39;))]&#34;
      ],
      &#34;properties&#34;: {
        &#34;hardwareProfile&#34;: {
          &#34;vmSize&#34;: &#34;[parameters(&#39;vmSize&#39;)]&#34;
        },
        &#34;osProfile&#34;: {
          &#34;computerName&#34;: &#34;[variables(&#39;vmName&#39;)]&#34;,
          &#34;adminUsername&#34;: &#34;[parameters(&#39;adminUsername&#39;)]&#34;,
          &#34;linuxConfiguration&#34;: {
            &#34;disablePasswordAuthentication&#34;: true,
            &#34;ssh&#34;: {
              &#34;publicKeys&#34;: [
                {
                  &#34;path&#34;: &#34;[concat(&#39;/home/&#39;, parameters(&#39;adminUsername&#39;), &#39;/.ssh/authorized_keys&#39;)]&#34;,
                  &#34;keyData&#34;: &#34;[parameters(&#39;adminPublicKey&#39;)]&#34;
                }
              ]
            }
          }
        },
        &#34;storageProfile&#34;: {
          &#34;imageReference&#34;: {
            &#34;publisher&#34;: &#34;[parameters(&#39;operatingSystemPublisher&#39;)]&#34;,
            &#34;offer&#34;: &#34;[parameters(&#39;operatingSystem&#39;)]&#34;,
            &#34;sku&#34;: &#34;[parameters(&#39;operatingSystemSKU&#39;)]&#34;,
            &#34;version&#34;: &#34;latest&#34;
          },
          &#34;osDisk&#34;: {
            &#34;createOption&#34;: &#34;fromImage&#34;
          }
        },
        &#34;networkProfile&#34;: {
          &#34;networkInterfaces&#34;: [
            {
              &#34;id&#34;: &#34;[resourceId(&#39;Microsoft.Network/networkInterfaces&#39;, variables(&#39;networkInterfaceName&#39;))]&#34;
            }
          ]
        }
      }
    }
  ],
  &#34;outputs&#34;: {
    &#34;adminUsername&#34;: {
      &#34;type&#34;: &#34;string&#34;,
      &#34;value&#34;: &#34;[parameters(&#39;adminUsername&#39;)]&#34;
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_sources>Sources</h2>
<div class=sectionbody>
<div class=ulist>
<ul>
<li>
<p><a id=source_1></a>[1]: <a href=https://docs.ansible.com/ansible/latest/modules/azure_rm_deployment_module.html target=_blank rel=noopener>azure_rm_deployment – Create or destroy Azure Resource Manager template deployments</a></p>
</li>
</ul>
</div>
</div>
</div>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation-bottom>
<a class="nav-prev btn btn-default" href=/ansible/2021/07/ansible-tower-and-downloading-collections/ title="Ansible Tower and downloading collections"> <i class="fa fa-chevron-left btn-bottom-prev"></i><span class=btn-bottom-text>Previous: </span> Ansible Tower and downloading collections</a>
<a class="nav-next btn btn-default" href=/ansible/2020/04/do410-ansible-and-ansible-tower-training-notes/ title="DO410 Ansible and Ansible Tower training notes" style=margin-right:0><i class="fa fa-chevron-right btn-bottom-next"></i><span class=btn-bottom-text>Next:</span> DO410 Ansible and Ansible Tower training notes</a>
</div>
<div class=copyright>
<p>Copyright &copy; 2020 - 2021 Toni Schmidbauer & Thomas Jungbauer</p>
<p>Built with <a href=https://github.com/matcornic/hugo-theme-learn target=_blank rel="noopener noreferrer">Hugo Learn Theme</i></a> and <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a></p>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1630387137></script>
<script src=/js/perfect-scrollbar.min.js?1630387137></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1630387137></script>
<script src=/js/jquery.sticky.js?1630387137></script>
<script src=/js/featherlight.min.js?1630387137></script>
<script src=/js/highlight.pack.js?1630387137></script>
<script>hljs.initHighlightingOnLoad()</script>
<script src=/js/modernizr.custom-3.6.0.js?1630387137></script>
<script src=/js/learn.js?1630387137></script>
<script src=/js/hugo-learn.js?1630387137></script>
<script src=/js/yaub.js?1630387137></script>
<script>window.addEventListener('DOMContentLoaded',()=>{const a=new IntersectionObserver(a=>{a.forEach(a=>{const b=a.target.getAttribute('id');a.intersectionRatio>0&&(clearActiveStatesInTableOfContents(),document.querySelector(`aside nav li a[href="#${b}"]`).parentElement.classList.add('active'))})});document.querySelectorAll('h1[id],h2[id],h3[id],h4[id]').forEach(b=>{a.observe(b)})});function clearActiveStatesInTableOfContents(){document.querySelectorAll('aside nav li').forEach(a=>{a.classList.remove('active')})}</script>
<script type=text/javascript>function scrollTopAnimated(){$("html, body").animate({scrollTop:"0"},500)}</script>
<script>function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}$(".summary-box").click(function(){return window.location=$(this).find("a").attr("href"),!1})</script>
</body>
</html>